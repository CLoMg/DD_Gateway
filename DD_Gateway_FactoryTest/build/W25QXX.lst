ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 4
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"W25QXX.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.BSP_W25Qx_GetStatus,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	BSP_W25Qx_GetStatus:
  26              	.LFB290:
  27              		.file 1 "FML/Src/W25QXX.c"
   1:FML/Src/W25QXX.c **** /**************************************************************************************************
   2:FML/Src/W25QXX.c **** *
   3:FML/Src/W25QXX.c **** * File                : ws_W25Qx.c
   4:FML/Src/W25QXX.c **** * Hardware Environment: 
   5:FML/Src/W25QXX.c **** * Build Environment   : RealView MDK-ARM  Version: 4.20
   6:FML/Src/W25QXX.c **** * Version             : V1.0
   7:FML/Src/W25QXX.c **** * By                  : 
   8:FML/Src/W25QXX.c **** *
   9:FML/Src/W25QXX.c **** *                                  (c) Copyright 2005-2011, WaveShare
  10:FML/Src/W25QXX.c **** *                                       http://www.waveshare.net
  11:FML/Src/W25QXX.c **** *                                          All Rights Reserved
  12:FML/Src/W25QXX.c **** *
  13:FML/Src/W25QXX.c **** ***************************************************************************************************
  14:FML/Src/W25QXX.c **** 
  15:FML/Src/W25QXX.c **** #include "W25QXX.h"
  16:FML/Src/W25QXX.c **** #include "shell_port.h"
  17:FML/Src/W25QXX.c **** #include <string.h>
  18:FML/Src/W25QXX.c **** /**
  19:FML/Src/W25QXX.c ****   * @brief  Initializes the W25Q128FV interface.
  20:FML/Src/W25QXX.c ****   * @retval None
  21:FML/Src/W25QXX.c ****   */
  22:FML/Src/W25QXX.c **** uint8_t BSP_W25Qx_Init(void)
  23:FML/Src/W25QXX.c **** { 
  24:FML/Src/W25QXX.c **** 	/* Reset W25Qxxx */
  25:FML/Src/W25QXX.c **** 	BSP_W25Qx_Reset();
  26:FML/Src/W25QXX.c **** 	
  27:FML/Src/W25QXX.c **** 	return BSP_W25Qx_GetStatus();
  28:FML/Src/W25QXX.c **** }
  29:FML/Src/W25QXX.c **** 
  30:FML/Src/W25QXX.c **** /**
  31:FML/Src/W25QXX.c ****   * @brief  This function reset the W25Qx.
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 2


  32:FML/Src/W25QXX.c ****   * @retval None
  33:FML/Src/W25QXX.c ****   */
  34:FML/Src/W25QXX.c **** static void	BSP_W25Qx_Reset(void)
  35:FML/Src/W25QXX.c **** {
  36:FML/Src/W25QXX.c **** 	uint8_t cmd[2] = {RESET_ENABLE_CMD,RESET_MEMORY_CMD};
  37:FML/Src/W25QXX.c **** 	
  38:FML/Src/W25QXX.c **** 	W25Qx_Enable();
  39:FML/Src/W25QXX.c **** 	/* Send the reset command */
  40:FML/Src/W25QXX.c **** 	HAL_SPI_Transmit(&hspi3, cmd, 2, W25Qx_TIMEOUT_VALUE);	
  41:FML/Src/W25QXX.c **** 	W25Qx_Disable();
  42:FML/Src/W25QXX.c **** 
  43:FML/Src/W25QXX.c **** }
  44:FML/Src/W25QXX.c **** 
  45:FML/Src/W25QXX.c **** /**
  46:FML/Src/W25QXX.c ****   * @brief  Reads current status of the W25Q128FV.
  47:FML/Src/W25QXX.c ****   * @retval W25Q128FV memory status
  48:FML/Src/W25QXX.c ****   */
  49:FML/Src/W25QXX.c **** static uint8_t BSP_W25Qx_GetStatus(void)
  50:FML/Src/W25QXX.c **** {
  28              		.loc 1 50 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 8
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  51:FML/Src/W25QXX.c **** 	uint8_t cmd[] = {READ_STATUS_REG1_CMD};
  32              		.loc 1 51 2 view .LVU1
  50:FML/Src/W25QXX.c **** 	uint8_t cmd[] = {READ_STATUS_REG1_CMD};
  33              		.loc 1 50 1 is_stmt 0 view .LVU2
  34 0000 07B5     		push	{r0, r1, r2, lr}
  35              	.LCFI0:
  36              		.cfi_def_cfa_offset 16
  37              		.cfi_offset 14, -4
  38              		.loc 1 51 10 view .LVU3
  39 0002 0523     		movs	r3, #5
  52:FML/Src/W25QXX.c **** 	uint8_t status;
  53:FML/Src/W25QXX.c **** 	
  54:FML/Src/W25QXX.c **** 	W25Qx_Enable();
  40              		.loc 1 54 2 view .LVU4
  41 0004 0022     		movs	r2, #0
  42 0006 1021     		movs	r1, #16
  43 0008 4FF09040 		mov	r0, #1207959552
  51:FML/Src/W25QXX.c **** 	uint8_t status;
  44              		.loc 1 51 10 view .LVU5
  45 000c 8DF80430 		strb	r3, [sp, #4]
  52:FML/Src/W25QXX.c **** 	uint8_t status;
  46              		.loc 1 52 2 is_stmt 1 view .LVU6
  47              		.loc 1 54 2 view .LVU7
  48 0010 FFF7FEFF 		bl	HAL_GPIO_WritePin
  49              	.LVL0:
  55:FML/Src/W25QXX.c **** 	/* Send the read status command */
  56:FML/Src/W25QXX.c **** 	HAL_SPI_Transmit(&hspi3, cmd, 1, W25Qx_TIMEOUT_VALUE);	
  50              		.loc 1 56 2 view .LVU8
  51 0014 01A9     		add	r1, sp, #4
  52 0016 4FF47A73 		mov	r3, #1000
  53 001a 0122     		movs	r2, #1
  54 001c 0C48     		ldr	r0, .L4
  55 001e FFF7FEFF 		bl	HAL_SPI_Transmit
  56              	.LVL1:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 3


  57:FML/Src/W25QXX.c **** 	/* Reception of the data */
  58:FML/Src/W25QXX.c **** 	HAL_SPI_Receive(&hspi3,&status, 1, W25Qx_TIMEOUT_VALUE);
  57              		.loc 1 58 2 view .LVU9
  58 0022 4FF47A73 		mov	r3, #1000
  59 0026 0DF10701 		add	r1, sp, #7
  60 002a 0122     		movs	r2, #1
  61 002c 0848     		ldr	r0, .L4
  62 002e FFF7FEFF 		bl	HAL_SPI_Receive
  63              	.LVL2:
  59:FML/Src/W25QXX.c **** 	W25Qx_Disable();
  64              		.loc 1 59 2 view .LVU10
  65 0032 0122     		movs	r2, #1
  66 0034 1021     		movs	r1, #16
  67 0036 4FF09040 		mov	r0, #1207959552
  68 003a FFF7FEFF 		bl	HAL_GPIO_WritePin
  69              	.LVL3:
  60:FML/Src/W25QXX.c **** 	
  61:FML/Src/W25QXX.c **** 	/* Check the value of the register */
  62:FML/Src/W25QXX.c ****   if((status & W25Q128FV_FSR_BUSY) != 0)
  70              		.loc 1 62 3 view .LVU11
  71 003e 9DF80700 		ldrb	r0, [sp, #7]	@ zero_extendqisi2
  63:FML/Src/W25QXX.c ****   {
  64:FML/Src/W25QXX.c ****     return W25Qx_BUSY;
  72              		.loc 1 64 12 is_stmt 0 view .LVU12
  73 0042 10F00100 		ands	r0, r0, #1
  65:FML/Src/W25QXX.c ****   }
  66:FML/Src/W25QXX.c **** 	else
  67:FML/Src/W25QXX.c **** 	{
  68:FML/Src/W25QXX.c **** 		return W25Qx_OK;
  69:FML/Src/W25QXX.c **** 	}		
  70:FML/Src/W25QXX.c **** }
  74              		.loc 1 70 1 view .LVU13
  75 0046 18BF     		it	ne
  76 0048 0220     		movne	r0, #2
  77 004a 03B0     		add	sp, sp, #12
  78              	.LCFI1:
  79              		.cfi_def_cfa_offset 4
  80              		@ sp needed
  81 004c 5DF804FB 		ldr	pc, [sp], #4
  82              	.L5:
  83              		.align	2
  84              	.L4:
  85 0050 00000000 		.word	hspi3
  86              		.cfi_endproc
  87              	.LFE290:
  89              		.section	.text.BSP_W25Qx_Init,"ax",%progbits
  90              		.align	1
  91              		.global	BSP_W25Qx_Init
  92              		.syntax unified
  93              		.thumb
  94              		.thumb_func
  96              	BSP_W25Qx_Init:
  97              	.LFB288:
  23:FML/Src/W25QXX.c **** 	/* Reset W25Qxxx */
  98              		.loc 1 23 1 is_stmt 1 view -0
  99              		.cfi_startproc
 100              		@ args = 0, pretend = 0, frame = 8
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 4


 101              		@ frame_needed = 0, uses_anonymous_args = 0
  25:FML/Src/W25QXX.c **** 	
 102              		.loc 1 25 2 view .LVU15
 103              	.LBB4:
 104              	.LBI4:
  34:FML/Src/W25QXX.c **** {
 105              		.loc 1 34 13 view .LVU16
 106              	.LBB5:
  36:FML/Src/W25QXX.c **** 	
 107              		.loc 1 36 2 view .LVU17
 108              	.LBE5:
 109              	.LBE4:
  23:FML/Src/W25QXX.c **** 	/* Reset W25Qxxx */
 110              		.loc 1 23 1 is_stmt 0 view .LVU18
 111 0000 07B5     		push	{r0, r1, r2, lr}
 112              	.LCFI2:
 113              		.cfi_def_cfa_offset 16
 114              		.cfi_offset 14, -4
 115              	.LBB7:
 116              	.LBB6:
  36:FML/Src/W25QXX.c **** 	
 117              		.loc 1 36 10 view .LVU19
 118 0002 49F66613 		movw	r3, #39270
  38:FML/Src/W25QXX.c **** 	/* Send the reset command */
 119              		.loc 1 38 2 view .LVU20
 120 0006 0022     		movs	r2, #0
 121 0008 1021     		movs	r1, #16
 122 000a 4FF09040 		mov	r0, #1207959552
  36:FML/Src/W25QXX.c **** 	
 123              		.loc 1 36 10 view .LVU21
 124 000e ADF80430 		strh	r3, [sp, #4]	@ movhi
  38:FML/Src/W25QXX.c **** 	/* Send the reset command */
 125              		.loc 1 38 2 is_stmt 1 view .LVU22
 126 0012 FFF7FEFF 		bl	HAL_GPIO_WritePin
 127              	.LVL4:
  40:FML/Src/W25QXX.c **** 	W25Qx_Disable();
 128              		.loc 1 40 2 view .LVU23
 129 0016 4FF47A73 		mov	r3, #1000
 130 001a 01A9     		add	r1, sp, #4
 131 001c 0222     		movs	r2, #2
 132 001e 0748     		ldr	r0, .L7
 133 0020 FFF7FEFF 		bl	HAL_SPI_Transmit
 134              	.LVL5:
  41:FML/Src/W25QXX.c **** 
 135              		.loc 1 41 2 view .LVU24
 136 0024 0122     		movs	r2, #1
 137 0026 1021     		movs	r1, #16
 138 0028 4FF09040 		mov	r0, #1207959552
 139 002c FFF7FEFF 		bl	HAL_GPIO_WritePin
 140              	.LVL6:
 141              	.LBE6:
 142              	.LBE7:
  27:FML/Src/W25QXX.c **** }
 143              		.loc 1 27 2 view .LVU25
  28:FML/Src/W25QXX.c **** 
 144              		.loc 1 28 1 is_stmt 0 view .LVU26
 145 0030 03B0     		add	sp, sp, #12
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 5


 146              	.LCFI3:
 147              		.cfi_def_cfa_offset 4
 148              		@ sp needed
 149 0032 5DF804EB 		ldr	lr, [sp], #4
 150              	.LCFI4:
 151              		.cfi_restore 14
 152              		.cfi_def_cfa_offset 0
  27:FML/Src/W25QXX.c **** }
 153              		.loc 1 27 9 view .LVU27
 154 0036 FFF7FEBF 		b	BSP_W25Qx_GetStatus
 155              	.LVL7:
 156              	.L8:
 157 003a 00BF     		.align	2
 158              	.L7:
 159 003c 00000000 		.word	hspi3
 160              		.cfi_endproc
 161              	.LFE288:
 163              		.section	.text.BSP_W25Qx_WriteEnable,"ax",%progbits
 164              		.align	1
 165              		.global	BSP_W25Qx_WriteEnable
 166              		.syntax unified
 167              		.thumb
 168              		.thumb_func
 170              	BSP_W25Qx_WriteEnable:
 171              	.LFB291:
  71:FML/Src/W25QXX.c **** 
  72:FML/Src/W25QXX.c **** /**
  73:FML/Src/W25QXX.c ****   * @brief  This function send a Write Enable and wait it is effective.
  74:FML/Src/W25QXX.c ****   * @retval None
  75:FML/Src/W25QXX.c ****   */
  76:FML/Src/W25QXX.c **** uint8_t BSP_W25Qx_WriteEnable(void)
  77:FML/Src/W25QXX.c **** {
 172              		.loc 1 77 1 is_stmt 1 view -0
 173              		.cfi_startproc
 174              		@ args = 0, pretend = 0, frame = 8
 175              		@ frame_needed = 0, uses_anonymous_args = 0
  78:FML/Src/W25QXX.c **** 	uint8_t cmd[] = {WRITE_ENABLE_CMD};
 176              		.loc 1 78 2 view .LVU29
  77:FML/Src/W25QXX.c **** 	uint8_t cmd[] = {WRITE_ENABLE_CMD};
 177              		.loc 1 77 1 is_stmt 0 view .LVU30
 178 0000 13B5     		push	{r0, r1, r4, lr}
 179              	.LCFI5:
 180              		.cfi_def_cfa_offset 16
 181              		.cfi_offset 4, -8
 182              		.cfi_offset 14, -4
 183              		.loc 1 78 10 view .LVU31
 184 0002 0623     		movs	r3, #6
 185 0004 8DF80430 		strb	r3, [sp, #4]
  79:FML/Src/W25QXX.c **** 	uint32_t tickstart = HAL_GetTick();
 186              		.loc 1 79 2 is_stmt 1 view .LVU32
 187              		.loc 1 79 23 is_stmt 0 view .LVU33
 188 0008 FFF7FEFF 		bl	HAL_GetTick
 189              	.LVL8:
  80:FML/Src/W25QXX.c **** 
  81:FML/Src/W25QXX.c **** 	/*Select the FLASH: Chip Select low */
  82:FML/Src/W25QXX.c **** 	W25Qx_Enable();
 190              		.loc 1 82 2 view .LVU34
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 6


 191 000c 0022     		movs	r2, #0
 192 000e 1021     		movs	r1, #16
  79:FML/Src/W25QXX.c **** 	uint32_t tickstart = HAL_GetTick();
 193              		.loc 1 79 23 view .LVU35
 194 0010 0446     		mov	r4, r0
 195              	.LVL9:
 196              		.loc 1 82 2 is_stmt 1 view .LVU36
 197 0012 4FF09040 		mov	r0, #1207959552
 198              	.LVL10:
 199              		.loc 1 82 2 is_stmt 0 view .LVU37
 200 0016 FFF7FEFF 		bl	HAL_GPIO_WritePin
 201              	.LVL11:
  83:FML/Src/W25QXX.c **** 	/* Send the read ID command */
  84:FML/Src/W25QXX.c **** 	HAL_SPI_Transmit(&hspi3, cmd, 1, W25Qx_TIMEOUT_VALUE);	
 202              		.loc 1 84 2 is_stmt 1 view .LVU38
 203 001a 0122     		movs	r2, #1
 204 001c 01A9     		add	r1, sp, #4
 205 001e 0C48     		ldr	r0, .L15
 206 0020 4FF47A73 		mov	r3, #1000
 207 0024 FFF7FEFF 		bl	HAL_SPI_Transmit
 208              	.LVL12:
  85:FML/Src/W25QXX.c **** 	/*Deselect the FLASH: Chip Select high */
  86:FML/Src/W25QXX.c **** 	W25Qx_Disable();
 209              		.loc 1 86 2 view .LVU39
 210 0028 0122     		movs	r2, #1
 211 002a 1021     		movs	r1, #16
 212 002c 4FF09040 		mov	r0, #1207959552
 213 0030 FFF7FEFF 		bl	HAL_GPIO_WritePin
 214              	.LVL13:
  87:FML/Src/W25QXX.c **** 	
  88:FML/Src/W25QXX.c **** 	/* Wait the end of Flash writing */
  89:FML/Src/W25QXX.c **** 	while(BSP_W25Qx_GetStatus() == W25Qx_BUSY);
 215              		.loc 1 89 2 view .LVU40
 216              	.L10:
 217              		.loc 1 89 44 discriminator 1 view .LVU41
 218              		.loc 1 89 7 discriminator 1 view .LVU42
 219              		.loc 1 89 8 is_stmt 0 discriminator 1 view .LVU43
 220 0034 FFF7FEFF 		bl	BSP_W25Qx_GetStatus
 221              	.LVL14:
 222              		.loc 1 89 7 discriminator 1 view .LVU44
 223 0038 0228     		cmp	r0, #2
 224 003a FBD0     		beq	.L10
  90:FML/Src/W25QXX.c **** 	{
  91:FML/Src/W25QXX.c **** 		/* Check for the Timeout */
  92:FML/Src/W25QXX.c ****     if((HAL_GetTick() - tickstart) > W25Qx_TIMEOUT_VALUE)
 225              		.loc 1 92 5 is_stmt 1 view .LVU45
 226              		.loc 1 92 9 is_stmt 0 view .LVU46
 227 003c FFF7FEFF 		bl	HAL_GetTick
 228              	.LVL15:
 229              		.loc 1 92 23 view .LVU47
 230 0040 001B     		subs	r0, r0, r4
  93:FML/Src/W25QXX.c ****     {        
  94:FML/Src/W25QXX.c **** 			return W25Qx_TIMEOUT;
 231              		.loc 1 94 11 view .LVU48
 232 0042 B0F57A7F 		cmp	r0, #1000
  95:FML/Src/W25QXX.c ****     }
  96:FML/Src/W25QXX.c **** 	}
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 7


  97:FML/Src/W25QXX.c **** 	
  98:FML/Src/W25QXX.c **** 	return W25Qx_OK;
  99:FML/Src/W25QXX.c **** }
 233              		.loc 1 99 1 view .LVU49
 234 0046 8CBF     		ite	hi
 235 0048 0320     		movhi	r0, #3
 236 004a 0020     		movls	r0, #0
 237 004c 02B0     		add	sp, sp, #8
 238              	.LCFI6:
 239              		.cfi_def_cfa_offset 8
 240              		@ sp needed
 241 004e 10BD     		pop	{r4, pc}
 242              	.LVL16:
 243              	.L16:
 244              		.loc 1 99 1 view .LVU50
 245              		.align	2
 246              	.L15:
 247 0050 00000000 		.word	hspi3
 248              		.cfi_endproc
 249              	.LFE291:
 251              		.section	.text.BSP_W25Qx_Read_ID,"ax",%progbits
 252              		.align	1
 253              		.global	BSP_W25Qx_Read_ID
 254              		.syntax unified
 255              		.thumb
 256              		.thumb_func
 258              	BSP_W25Qx_Read_ID:
 259              	.LVL17:
 260              	.LFB292:
 100:FML/Src/W25QXX.c **** 
 101:FML/Src/W25QXX.c **** /**
 102:FML/Src/W25QXX.c ****   * @brief  Read Manufacture/Device ID.
 103:FML/Src/W25QXX.c **** 	* @param  return value address
 104:FML/Src/W25QXX.c ****   * @retval None
 105:FML/Src/W25QXX.c ****   */
 106:FML/Src/W25QXX.c **** void BSP_W25Qx_Read_ID(uint8_t *ID)
 107:FML/Src/W25QXX.c **** {
 261              		.loc 1 107 1 is_stmt 1 view -0
 262              		.cfi_startproc
 263              		@ args = 0, pretend = 0, frame = 8
 264              		@ frame_needed = 0, uses_anonymous_args = 0
 108:FML/Src/W25QXX.c **** 	uint8_t cmd[4] = {READ_ID_CMD,0x00,0x00,0x00};
 265              		.loc 1 108 2 view .LVU52
 107:FML/Src/W25QXX.c **** 	uint8_t cmd[4] = {READ_ID_CMD,0x00,0x00,0x00};
 266              		.loc 1 107 1 is_stmt 0 view .LVU53
 267 0000 37B5     		push	{r0, r1, r2, r4, r5, lr}
 268              	.LCFI7:
 269              		.cfi_def_cfa_offset 24
 270              		.cfi_offset 4, -12
 271              		.cfi_offset 5, -8
 272              		.cfi_offset 14, -4
 273              		.loc 1 108 10 view .LVU54
 274 0002 9023     		movs	r3, #144
 109:FML/Src/W25QXX.c **** 	
 110:FML/Src/W25QXX.c **** 	W25Qx_Enable();
 111:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 112:FML/Src/W25QXX.c **** 	HAL_SPI_Transmit(&hspi3, cmd, 4, W25Qx_TIMEOUT_VALUE);	
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 8


 275              		.loc 1 112 2 view .LVU55
 276 0004 0F4D     		ldr	r5, .L18
 108:FML/Src/W25QXX.c **** 	
 277              		.loc 1 108 10 view .LVU56
 278 0006 0193     		str	r3, [sp, #4]
 110:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 279              		.loc 1 110 2 is_stmt 1 view .LVU57
 107:FML/Src/W25QXX.c **** 	uint8_t cmd[4] = {READ_ID_CMD,0x00,0x00,0x00};
 280              		.loc 1 107 1 is_stmt 0 view .LVU58
 281 0008 0446     		mov	r4, r0
 110:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 282              		.loc 1 110 2 view .LVU59
 283 000a 0022     		movs	r2, #0
 284 000c 1021     		movs	r1, #16
 285 000e 4FF09040 		mov	r0, #1207959552
 286              	.LVL18:
 110:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 287              		.loc 1 110 2 view .LVU60
 288 0012 FFF7FEFF 		bl	HAL_GPIO_WritePin
 289              	.LVL19:
 290              		.loc 1 112 2 is_stmt 1 view .LVU61
 291 0016 0422     		movs	r2, #4
 292 0018 0DEB0201 		add	r1, sp, r2
 293 001c 4FF47A73 		mov	r3, #1000
 294 0020 2846     		mov	r0, r5
 295 0022 FFF7FEFF 		bl	HAL_SPI_Transmit
 296              	.LVL20:
 113:FML/Src/W25QXX.c **** 	/* Reception of the data */
 114:FML/Src/W25QXX.c **** 	HAL_SPI_Receive(&hspi3,ID, 2, W25Qx_TIMEOUT_VALUE);
 297              		.loc 1 114 2 view .LVU62
 298 0026 4FF47A73 		mov	r3, #1000
 299 002a 2146     		mov	r1, r4
 300 002c 0222     		movs	r2, #2
 301 002e 2846     		mov	r0, r5
 302 0030 FFF7FEFF 		bl	HAL_SPI_Receive
 303              	.LVL21:
 115:FML/Src/W25QXX.c **** 	W25Qx_Disable();
 304              		.loc 1 115 2 view .LVU63
 305 0034 0122     		movs	r2, #1
 306 0036 1021     		movs	r1, #16
 307 0038 4FF09040 		mov	r0, #1207959552
 308 003c FFF7FEFF 		bl	HAL_GPIO_WritePin
 309              	.LVL22:
 116:FML/Src/W25QXX.c **** 		
 117:FML/Src/W25QXX.c **** }
 310              		.loc 1 117 1 is_stmt 0 view .LVU64
 311 0040 03B0     		add	sp, sp, #12
 312              	.LCFI8:
 313              		.cfi_def_cfa_offset 12
 314              		@ sp needed
 315 0042 30BD     		pop	{r4, r5, pc}
 316              	.LVL23:
 317              	.L19:
 318              		.loc 1 117 1 view .LVU65
 319              		.align	2
 320              	.L18:
 321 0044 00000000 		.word	hspi3
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 9


 322              		.cfi_endproc
 323              	.LFE292:
 325              		.section	.text.BSP_W25Qx_Read_JEDEC_ID,"ax",%progbits
 326              		.align	1
 327              		.global	BSP_W25Qx_Read_JEDEC_ID
 328              		.syntax unified
 329              		.thumb
 330              		.thumb_func
 332              	BSP_W25Qx_Read_JEDEC_ID:
 333              	.LVL24:
 334              	.LFB293:
 118:FML/Src/W25QXX.c **** 
 119:FML/Src/W25QXX.c **** /**
 120:FML/Src/W25QXX.c ****   * @brief  Read JEDEC ID.
 121:FML/Src/W25QXX.c **** 	* @param  return value address
 122:FML/Src/W25QXX.c ****   * @retval None
 123:FML/Src/W25QXX.c ****   */
 124:FML/Src/W25QXX.c **** void BSP_W25Qx_Read_JEDEC_ID(uint8_t *JDEDC_ID)
 125:FML/Src/W25QXX.c **** {
 335              		.loc 1 125 1 is_stmt 1 view -0
 336              		.cfi_startproc
 337              		@ args = 0, pretend = 0, frame = 8
 338              		@ frame_needed = 0, uses_anonymous_args = 0
 126:FML/Src/W25QXX.c **** 	uint8_t cmd[4] = {READ_JEDEC_ID_CMD,0x00,0x00,0x00};
 339              		.loc 1 126 2 view .LVU67
 125:FML/Src/W25QXX.c **** 	uint8_t cmd[4] = {READ_JEDEC_ID_CMD,0x00,0x00,0x00};
 340              		.loc 1 125 1 is_stmt 0 view .LVU68
 341 0000 37B5     		push	{r0, r1, r2, r4, r5, lr}
 342              	.LCFI9:
 343              		.cfi_def_cfa_offset 24
 344              		.cfi_offset 4, -12
 345              		.cfi_offset 5, -8
 346              		.cfi_offset 14, -4
 127:FML/Src/W25QXX.c **** 	
 128:FML/Src/W25QXX.c **** 	W25Qx_Enable();
 129:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 130:FML/Src/W25QXX.c **** 	HAL_SPI_Transmit(&hspi3, cmd, 1, W25Qx_TIMEOUT_VALUE);	
 347              		.loc 1 130 2 view .LVU69
 348 0002 104D     		ldr	r5, .L21
 125:FML/Src/W25QXX.c **** 	uint8_t cmd[4] = {READ_JEDEC_ID_CMD,0x00,0x00,0x00};
 349              		.loc 1 125 1 view .LVU70
 350 0004 0446     		mov	r4, r0
 126:FML/Src/W25QXX.c **** 	
 351              		.loc 1 126 10 view .LVU71
 352 0006 9F23     		movs	r3, #159
 128:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 353              		.loc 1 128 2 view .LVU72
 354 0008 0022     		movs	r2, #0
 355 000a 1021     		movs	r1, #16
 356 000c 4FF09040 		mov	r0, #1207959552
 357              	.LVL25:
 126:FML/Src/W25QXX.c **** 	
 358              		.loc 1 126 10 view .LVU73
 359 0010 0193     		str	r3, [sp, #4]
 128:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 360              		.loc 1 128 2 is_stmt 1 view .LVU74
 361 0012 FFF7FEFF 		bl	HAL_GPIO_WritePin
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 10


 362              	.LVL26:
 363              		.loc 1 130 2 view .LVU75
 364 0016 01A9     		add	r1, sp, #4
 365 0018 4FF47A73 		mov	r3, #1000
 366 001c 0122     		movs	r2, #1
 367 001e 2846     		mov	r0, r5
 368 0020 FFF7FEFF 		bl	HAL_SPI_Transmit
 369              	.LVL27:
 131:FML/Src/W25QXX.c **** 	/* Reception of the data */
 132:FML/Src/W25QXX.c **** 	HAL_SPI_Receive(&hspi3,JDEDC_ID, 3, W25Qx_TIMEOUT_VALUE);
 370              		.loc 1 132 2 view .LVU76
 371 0024 4FF47A73 		mov	r3, #1000
 372 0028 2146     		mov	r1, r4
 373 002a 0322     		movs	r2, #3
 374 002c 2846     		mov	r0, r5
 375 002e FFF7FEFF 		bl	HAL_SPI_Receive
 376              	.LVL28:
 133:FML/Src/W25QXX.c **** 	W25Qx_Disable();
 377              		.loc 1 133 2 view .LVU77
 378 0032 0122     		movs	r2, #1
 379 0034 1021     		movs	r1, #16
 380 0036 4FF09040 		mov	r0, #1207959552
 381 003a FFF7FEFF 		bl	HAL_GPIO_WritePin
 382              	.LVL29:
 134:FML/Src/W25QXX.c **** 		
 135:FML/Src/W25QXX.c **** }
 383              		.loc 1 135 1 is_stmt 0 view .LVU78
 384 003e 03B0     		add	sp, sp, #12
 385              	.LCFI10:
 386              		.cfi_def_cfa_offset 12
 387              		@ sp needed
 388 0040 30BD     		pop	{r4, r5, pc}
 389              	.LVL30:
 390              	.L22:
 391              		.loc 1 135 1 view .LVU79
 392 0042 00BF     		.align	2
 393              	.L21:
 394 0044 00000000 		.word	hspi3
 395              		.cfi_endproc
 396              	.LFE293:
 398              		.section	.text.BSP_W25Qx_Read,"ax",%progbits
 399              		.align	1
 400              		.global	BSP_W25Qx_Read
 401              		.syntax unified
 402              		.thumb
 403              		.thumb_func
 405              	BSP_W25Qx_Read:
 406              	.LVL31:
 407              	.LFB294:
 136:FML/Src/W25QXX.c **** 
 137:FML/Src/W25QXX.c **** /**
 138:FML/Src/W25QXX.c ****   * @brief  Reads an amount of data from the QSPI memory.
 139:FML/Src/W25QXX.c ****   * @param  pData: Pointer to data to be read
 140:FML/Src/W25QXX.c ****   * @param  ReadAddr: Read start address
 141:FML/Src/W25QXX.c ****   * @param  Size: Size of data to read    
 142:FML/Src/W25QXX.c ****   * @retval QSPI memory status
 143:FML/Src/W25QXX.c ****   */
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 11


 144:FML/Src/W25QXX.c **** uint8_t BSP_W25Qx_Read(uint8_t* pData, uint32_t ReadAddr, uint32_t Size)
 145:FML/Src/W25QXX.c **** {
 408              		.loc 1 145 1 is_stmt 1 view -0
 409              		.cfi_startproc
 410              		@ args = 0, pretend = 0, frame = 8
 411              		@ frame_needed = 0, uses_anonymous_args = 0
 146:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 412              		.loc 1 146 2 view .LVU81
 147:FML/Src/W25QXX.c **** 
 148:FML/Src/W25QXX.c **** 	/* Configure the command */
 149:FML/Src/W25QXX.c **** 	cmd[0] = READ_CMD;
 413              		.loc 1 149 2 view .LVU82
 145:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 414              		.loc 1 145 1 is_stmt 0 view .LVU83
 415 0000 37B5     		push	{r0, r1, r2, r4, r5, lr}
 416              	.LCFI11:
 417              		.cfi_def_cfa_offset 24
 418              		.cfi_offset 4, -12
 419              		.cfi_offset 5, -8
 420              		.cfi_offset 14, -4
 421              		.loc 1 149 9 view .LVU84
 422 0002 0323     		movs	r3, #3
 423 0004 8DF80430 		strb	r3, [sp, #4]
 150:FML/Src/W25QXX.c **** 	cmd[1] = (uint8_t)(ReadAddr >> 16);
 424              		.loc 1 150 2 is_stmt 1 view .LVU85
 425              		.loc 1 150 30 is_stmt 0 view .LVU86
 426 0008 0B0C     		lsrs	r3, r1, #16
 145:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 427              		.loc 1 145 1 view .LVU87
 428 000a 0446     		mov	r4, r0
 429 000c 1546     		mov	r5, r2
 430              		.loc 1 150 11 view .LVU88
 431 000e 8DF80530 		strb	r3, [sp, #5]
 151:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(ReadAddr >> 8);
 432              		.loc 1 151 2 is_stmt 1 view .LVU89
 152:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(ReadAddr);
 433              		.loc 1 152 11 is_stmt 0 view .LVU90
 434 0012 8DF80710 		strb	r1, [sp, #7]
 151:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(ReadAddr >> 8);
 435              		.loc 1 151 30 view .LVU91
 436 0016 0B0A     		lsrs	r3, r1, #8
 153:FML/Src/W25QXX.c **** 	
 154:FML/Src/W25QXX.c **** 	W25Qx_Enable();
 437              		.loc 1 154 2 view .LVU92
 438 0018 0022     		movs	r2, #0
 439              	.LVL32:
 440              		.loc 1 154 2 view .LVU93
 441 001a 1021     		movs	r1, #16
 442              	.LVL33:
 443              		.loc 1 154 2 view .LVU94
 444 001c 4FF09040 		mov	r0, #1207959552
 445              	.LVL34:
 151:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(ReadAddr);
 446              		.loc 1 151 11 view .LVU95
 447 0020 8DF80630 		strb	r3, [sp, #6]
 152:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(ReadAddr);
 448              		.loc 1 152 2 is_stmt 1 view .LVU96
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 12


 449              		.loc 1 154 2 view .LVU97
 450 0024 FFF7FEFF 		bl	HAL_GPIO_WritePin
 451              	.LVL35:
 155:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 156:FML/Src/W25QXX.c **** 	HAL_SPI_Transmit(&hspi3, cmd, 4, W25Qx_TIMEOUT_VALUE);	
 452              		.loc 1 156 2 view .LVU98
 453 0028 0422     		movs	r2, #4
 454 002a 0DEB0201 		add	r1, sp, r2
 455 002e 4FF47A73 		mov	r3, #1000
 456 0032 0B48     		ldr	r0, .L26
 457 0034 FFF7FEFF 		bl	HAL_SPI_Transmit
 458              	.LVL36:
 157:FML/Src/W25QXX.c **** 	/* Reception of the data */
 158:FML/Src/W25QXX.c **** 	if (HAL_SPI_Receive(&hspi3, pData,Size,W25Qx_TIMEOUT_VALUE) != HAL_OK)
 459              		.loc 1 158 2 view .LVU99
 460              		.loc 1 158 6 is_stmt 0 view .LVU100
 461 0038 2146     		mov	r1, r4
 462 003a 0948     		ldr	r0, .L26
 463 003c 4FF47A73 		mov	r3, #1000
 464 0040 AAB2     		uxth	r2, r5
 465 0042 FFF7FEFF 		bl	HAL_SPI_Receive
 466              	.LVL37:
 467              		.loc 1 158 5 view .LVU101
 468 0046 0446     		mov	r4, r0
 469              	.LVL38:
 470              		.loc 1 158 5 view .LVU102
 471 0048 40B9     		cbnz	r0, .L25
 159:FML/Src/W25QXX.c ****   {
 160:FML/Src/W25QXX.c ****     return W25Qx_ERROR;
 161:FML/Src/W25QXX.c ****   }
 162:FML/Src/W25QXX.c **** 	W25Qx_Disable();
 472              		.loc 1 162 2 is_stmt 1 view .LVU103
 473 004a 0122     		movs	r2, #1
 474 004c 1021     		movs	r1, #16
 475 004e 4FF09040 		mov	r0, #1207959552
 476 0052 FFF7FEFF 		bl	HAL_GPIO_WritePin
 477              	.LVL39:
 163:FML/Src/W25QXX.c **** 	return W25Qx_OK;
 478              		.loc 1 163 2 view .LVU104
 479              	.L24:
 164:FML/Src/W25QXX.c **** }
 480              		.loc 1 164 1 is_stmt 0 view .LVU105
 481 0056 2046     		mov	r0, r4
 482 0058 03B0     		add	sp, sp, #12
 483              	.LCFI12:
 484              		.cfi_remember_state
 485              		.cfi_def_cfa_offset 12
 486              		@ sp needed
 487 005a 30BD     		pop	{r4, r5, pc}
 488              	.LVL40:
 489              	.L25:
 490              	.LCFI13:
 491              		.cfi_restore_state
 160:FML/Src/W25QXX.c ****   }
 492              		.loc 1 160 12 view .LVU106
 493 005c 0124     		movs	r4, #1
 494 005e FAE7     		b	.L24
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 13


 495              	.L27:
 496              		.align	2
 497              	.L26:
 498 0060 00000000 		.word	hspi3
 499              		.cfi_endproc
 500              	.LFE294:
 502              		.section	.text.BSP_W25Qx_Write,"ax",%progbits
 503              		.align	1
 504              		.global	BSP_W25Qx_Write
 505              		.syntax unified
 506              		.thumb
 507              		.thumb_func
 509              	BSP_W25Qx_Write:
 510              	.LVL41:
 511              	.LFB295:
 165:FML/Src/W25QXX.c **** 
 166:FML/Src/W25QXX.c **** /**
 167:FML/Src/W25QXX.c ****   * @brief  Writes an amount of data to the QSPI memory.
 168:FML/Src/W25QXX.c ****   * @param  pData: Pointer to data to be written
 169:FML/Src/W25QXX.c ****   * @param  WriteAddr: Write start address
 170:FML/Src/W25QXX.c ****   * @param  Size: Size of data to write,No more than 256byte.    
 171:FML/Src/W25QXX.c ****   * @retval QSPI memory status
 172:FML/Src/W25QXX.c ****   */
 173:FML/Src/W25QXX.c **** uint8_t BSP_W25Qx_Write(uint8_t* pData, uint32_t WriteAddr, uint32_t Size)
 174:FML/Src/W25QXX.c **** {
 512              		.loc 1 174 1 is_stmt 1 view -0
 513              		.cfi_startproc
 514              		@ args = 0, pretend = 0, frame = 8
 515              		@ frame_needed = 0, uses_anonymous_args = 0
 175:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 516              		.loc 1 175 2 view .LVU108
 176:FML/Src/W25QXX.c **** 	uint32_t end_addr, current_size, current_addr;
 517              		.loc 1 176 2 view .LVU109
 177:FML/Src/W25QXX.c **** 	uint32_t tickstart = HAL_GetTick();
 518              		.loc 1 177 2 view .LVU110
 174:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 519              		.loc 1 174 1 is_stmt 0 view .LVU111
 520 0000 2DE9F74F 		push	{r0, r1, r2, r4, r5, r6, r7, r8, r9, r10, fp, lr}
 521              	.LCFI14:
 522              		.cfi_def_cfa_offset 48
 523              		.cfi_offset 4, -36
 524              		.cfi_offset 5, -32
 525              		.cfi_offset 6, -28
 526              		.cfi_offset 7, -24
 527              		.cfi_offset 8, -20
 528              		.cfi_offset 9, -16
 529              		.cfi_offset 10, -12
 530              		.cfi_offset 11, -8
 531              		.cfi_offset 14, -4
 174:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 532              		.loc 1 174 1 view .LVU112
 533 0004 8046     		mov	r8, r0
 534 0006 0C46     		mov	r4, r1
 535 0008 1646     		mov	r6, r2
 536              		.loc 1 177 23 view .LVU113
 537 000a FFF7FEFF 		bl	HAL_GetTick
 538              	.LVL42:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 14


 178:FML/Src/W25QXX.c **** 	
 179:FML/Src/W25QXX.c **** 	/* Calculation of the size between the write address and the end of the page */
 180:FML/Src/W25QXX.c ****   current_addr = 0;
 539              		.loc 1 180 16 view .LVU114
 540 000e 0025     		movs	r5, #0
 177:FML/Src/W25QXX.c **** 	
 541              		.loc 1 177 23 view .LVU115
 542 0010 8146     		mov	r9, r0
 543              	.LVL43:
 544              		.loc 1 180 3 is_stmt 1 view .LVU116
 181:FML/Src/W25QXX.c **** 
 182:FML/Src/W25QXX.c ****   while (current_addr <= WriteAddr)
 545              		.loc 1 182 3 view .LVU117
 546              		.loc 1 182 9 view .LVU118
 547              	.L29:
 183:FML/Src/W25QXX.c ****   {
 184:FML/Src/W25QXX.c ****     current_addr += W25Q128FV_PAGE_SIZE;
 548              		.loc 1 184 5 view .LVU119
 549              		.loc 1 184 18 is_stmt 0 view .LVU120
 550 0012 05F58075 		add	r5, r5, #256
 551              	.LVL44:
 182:FML/Src/W25QXX.c ****   {
 552              		.loc 1 182 9 is_stmt 1 view .LVU121
 553 0016 AC42     		cmp	r4, r5
 554 0018 FBD2     		bcs	.L29
 185:FML/Src/W25QXX.c ****   }
 186:FML/Src/W25QXX.c ****   current_size = current_addr - WriteAddr;
 555              		.loc 1 186 3 view .LVU122
 556              		.loc 1 186 16 is_stmt 0 view .LVU123
 557 001a 2D1B     		subs	r5, r5, r4
 558              	.LVL45:
 187:FML/Src/W25QXX.c **** 
 188:FML/Src/W25QXX.c ****   /* Check if the size of the data is less than the remaining place in the page */
 189:FML/Src/W25QXX.c ****   if (current_size > Size)
 559              		.loc 1 189 3 is_stmt 1 view .LVU124
 560 001c B542     		cmp	r5, r6
 190:FML/Src/W25QXX.c ****   {
 191:FML/Src/W25QXX.c ****     current_size = Size;
 192:FML/Src/W25QXX.c ****   }
 193:FML/Src/W25QXX.c **** 
 194:FML/Src/W25QXX.c ****   /* Initialize the adress variables */
 195:FML/Src/W25QXX.c ****   current_addr = WriteAddr;
 196:FML/Src/W25QXX.c ****   end_addr = WriteAddr + Size;
 197:FML/Src/W25QXX.c **** 	
 198:FML/Src/W25QXX.c ****   /* Perform the write page by page */
 199:FML/Src/W25QXX.c ****   do
 200:FML/Src/W25QXX.c ****   {
 201:FML/Src/W25QXX.c **** 		/* Configure the command */
 202:FML/Src/W25QXX.c **** 		cmd[0] = PAGE_PROG_CMD;
 203:FML/Src/W25QXX.c **** 		cmd[1] = (uint8_t)(current_addr >> 16);
 204:FML/Src/W25QXX.c **** 		cmd[2] = (uint8_t)(current_addr >> 8);
 205:FML/Src/W25QXX.c **** 		cmd[3] = (uint8_t)(current_addr);
 206:FML/Src/W25QXX.c **** 
 207:FML/Src/W25QXX.c **** 		/* Enable write operations */
 208:FML/Src/W25QXX.c **** 		BSP_W25Qx_WriteEnable();
 209:FML/Src/W25QXX.c **** 	
 210:FML/Src/W25QXX.c **** 		W25Qx_Enable();
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 15


 211:FML/Src/W25QXX.c ****     /* Send the command */
 212:FML/Src/W25QXX.c ****     if (HAL_SPI_Transmit(&hspi3,cmd, 4, W25Qx_TIMEOUT_VALUE) != HAL_OK)
 561              		.loc 1 212 9 is_stmt 0 view .LVU125
 562 001e DFF89CB0 		ldr	fp, .L41
 563 0022 28BF     		it	cs
 564 0024 3546     		movcs	r5, r6
 565              	.LVL46:
 195:FML/Src/W25QXX.c ****   end_addr = WriteAddr + Size;
 566              		.loc 1 195 3 is_stmt 1 view .LVU126
 196:FML/Src/W25QXX.c **** 	
 567              		.loc 1 196 3 view .LVU127
 202:FML/Src/W25QXX.c **** 		cmd[1] = (uint8_t)(current_addr >> 16);
 568              		.loc 1 202 10 is_stmt 0 view .LVU128
 569 0026 4FF0020A 		mov	r10, #2
 196:FML/Src/W25QXX.c **** 	
 570              		.loc 1 196 12 view .LVU129
 571 002a 2644     		add	r6, r6, r4
 572              	.LVL47:
 573              	.L34:
 199:FML/Src/W25QXX.c ****   {
 574              		.loc 1 199 3 is_stmt 1 view .LVU130
 202:FML/Src/W25QXX.c **** 		cmd[1] = (uint8_t)(current_addr >> 16);
 575              		.loc 1 202 3 view .LVU131
 203:FML/Src/W25QXX.c **** 		cmd[2] = (uint8_t)(current_addr >> 8);
 576              		.loc 1 203 35 is_stmt 0 view .LVU132
 577 002c 230C     		lsrs	r3, r4, #16
 203:FML/Src/W25QXX.c **** 		cmd[2] = (uint8_t)(current_addr >> 8);
 578              		.loc 1 203 12 view .LVU133
 579 002e 8DF80530 		strb	r3, [sp, #5]
 204:FML/Src/W25QXX.c **** 		cmd[3] = (uint8_t)(current_addr);
 580              		.loc 1 204 35 view .LVU134
 581 0032 230A     		lsrs	r3, r4, #8
 204:FML/Src/W25QXX.c **** 		cmd[3] = (uint8_t)(current_addr);
 582              		.loc 1 204 12 view .LVU135
 583 0034 8DF80630 		strb	r3, [sp, #6]
 202:FML/Src/W25QXX.c **** 		cmd[1] = (uint8_t)(current_addr >> 16);
 584              		.loc 1 202 10 view .LVU136
 585 0038 8DF804A0 		strb	r10, [sp, #4]
 203:FML/Src/W25QXX.c **** 		cmd[2] = (uint8_t)(current_addr >> 8);
 586              		.loc 1 203 3 is_stmt 1 view .LVU137
 204:FML/Src/W25QXX.c **** 		cmd[3] = (uint8_t)(current_addr);
 587              		.loc 1 204 3 view .LVU138
 205:FML/Src/W25QXX.c **** 
 588              		.loc 1 205 3 view .LVU139
 205:FML/Src/W25QXX.c **** 
 589              		.loc 1 205 12 is_stmt 0 view .LVU140
 590 003c 8DF80740 		strb	r4, [sp, #7]
 208:FML/Src/W25QXX.c **** 	
 591              		.loc 1 208 3 is_stmt 1 view .LVU141
 592 0040 FFF7FEFF 		bl	BSP_W25Qx_WriteEnable
 593              	.LVL48:
 210:FML/Src/W25QXX.c ****     /* Send the command */
 594              		.loc 1 210 3 view .LVU142
 595 0044 0022     		movs	r2, #0
 596 0046 1021     		movs	r1, #16
 597 0048 4FF09040 		mov	r0, #1207959552
 598 004c FFF7FEFF 		bl	HAL_GPIO_WritePin
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 16


 599              	.LVL49:
 600              		.loc 1 212 5 view .LVU143
 601              		.loc 1 212 9 is_stmt 0 view .LVU144
 602 0050 0422     		movs	r2, #4
 603 0052 1A48     		ldr	r0, .L41
 604 0054 4FF47A73 		mov	r3, #1000
 605 0058 0DEB0201 		add	r1, sp, r2
 606 005c FFF7FEFF 		bl	HAL_SPI_Transmit
 607              	.LVL50:
 608              		.loc 1 212 8 view .LVU145
 609 0060 40BB     		cbnz	r0, .L30
 213:FML/Src/W25QXX.c ****     {
 214:FML/Src/W25QXX.c ****       return W25Qx_ERROR;
 215:FML/Src/W25QXX.c ****     }
 216:FML/Src/W25QXX.c ****     
 217:FML/Src/W25QXX.c ****     /* Transmission of the data */
 218:FML/Src/W25QXX.c ****     if (HAL_SPI_Transmit(&hspi3, pData,current_size, W25Qx_TIMEOUT_VALUE) != HAL_OK)
 610              		.loc 1 218 5 is_stmt 1 view .LVU146
 611              		.loc 1 218 9 is_stmt 0 view .LVU147
 612 0062 4FF47A73 		mov	r3, #1000
 613 0066 AAB2     		uxth	r2, r5
 614 0068 4146     		mov	r1, r8
 615 006a 5846     		mov	r0, fp
 616 006c FFF7FEFF 		bl	HAL_SPI_Transmit
 617              	.LVL51:
 618              		.loc 1 218 8 view .LVU148
 619 0070 0746     		mov	r7, r0
 620 0072 F8B9     		cbnz	r0, .L30
 219:FML/Src/W25QXX.c ****     {
 220:FML/Src/W25QXX.c ****       return W25Qx_ERROR;
 221:FML/Src/W25QXX.c ****     }
 222:FML/Src/W25QXX.c **** 			W25Qx_Disable();
 621              		.loc 1 222 4 is_stmt 1 view .LVU149
 622 0074 0122     		movs	r2, #1
 623 0076 1021     		movs	r1, #16
 624 0078 4FF09040 		mov	r0, #1207959552
 625 007c FFF7FEFF 		bl	HAL_GPIO_WritePin
 626              	.LVL52:
 223:FML/Src/W25QXX.c ****     	/* Wait the end of Flash writing */
 224:FML/Src/W25QXX.c **** 		while(BSP_W25Qx_GetStatus() == W25Qx_BUSY);
 627              		.loc 1 224 3 view .LVU150
 628              	.L31:
 629              		.loc 1 224 45 discriminator 1 view .LVU151
 630              		.loc 1 224 8 discriminator 1 view .LVU152
 631              		.loc 1 224 9 is_stmt 0 discriminator 1 view .LVU153
 632 0080 FFF7FEFF 		bl	BSP_W25Qx_GetStatus
 633              	.LVL53:
 634              		.loc 1 224 8 discriminator 1 view .LVU154
 635 0084 0228     		cmp	r0, #2
 636 0086 FBD0     		beq	.L31
 225:FML/Src/W25QXX.c **** 		{
 226:FML/Src/W25QXX.c **** 			/* Check for the Timeout */
 227:FML/Src/W25QXX.c **** 			if((HAL_GetTick() - tickstart) > W25Qx_TIMEOUT_VALUE)
 637              		.loc 1 227 4 is_stmt 1 view .LVU155
 638              		.loc 1 227 8 is_stmt 0 view .LVU156
 639 0088 FFF7FEFF 		bl	HAL_GetTick
 640              	.LVL54:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 17


 641              		.loc 1 227 22 view .LVU157
 642 008c A0EB0900 		sub	r0, r0, r9
 643              		.loc 1 227 6 view .LVU158
 644 0090 B0F57A7F 		cmp	r0, #1000
 645 0094 10D8     		bhi	.L35
 228:FML/Src/W25QXX.c **** 			{        
 229:FML/Src/W25QXX.c **** 				return W25Qx_TIMEOUT;
 230:FML/Src/W25QXX.c **** 			}
 231:FML/Src/W25QXX.c **** 		}
 232:FML/Src/W25QXX.c ****     
 233:FML/Src/W25QXX.c ****     /* Update the address and size variables for next page programming */
 234:FML/Src/W25QXX.c ****     current_addr += current_size;
 646              		.loc 1 234 5 is_stmt 1 view .LVU159
 647              		.loc 1 234 18 is_stmt 0 view .LVU160
 648 0096 2C44     		add	r4, r4, r5
 649              	.LVL55:
 235:FML/Src/W25QXX.c ****     pData += current_size;
 650              		.loc 1 235 5 is_stmt 1 view .LVU161
 236:FML/Src/W25QXX.c ****     current_size = ((current_addr + W25Q128FV_PAGE_SIZE) > end_addr) ? (end_addr - current_addr) : 
 651              		.loc 1 236 35 is_stmt 0 view .LVU162
 652 0098 04F58073 		add	r3, r4, #256
 653              		.loc 1 236 98 view .LVU163
 654 009c B342     		cmp	r3, r6
 235:FML/Src/W25QXX.c ****     pData += current_size;
 655              		.loc 1 235 11 view .LVU164
 656 009e A844     		add	r8, r8, r5
 657              	.LVL56:
 658              		.loc 1 236 5 is_stmt 1 view .LVU165
 659              		.loc 1 236 98 is_stmt 0 view .LVU166
 660 00a0 8CBF     		ite	hi
 661 00a2 351B     		subhi	r5, r6, r4
 662              	.LVL57:
 663              		.loc 1 236 98 view .LVU167
 664 00a4 4FF48075 		movls	r5, #256
 665              	.LVL58:
 237:FML/Src/W25QXX.c ****   } while (current_addr < end_addr);
 666              		.loc 1 237 11 is_stmt 1 view .LVU168
 667              		.loc 1 237 3 is_stmt 0 view .LVU169
 668 00a8 A642     		cmp	r6, r4
 669 00aa BFD8     		bhi	.L34
 670              	.L32:
 238:FML/Src/W25QXX.c **** 
 239:FML/Src/W25QXX.c **** 	
 240:FML/Src/W25QXX.c **** 	return W25Qx_OK;
 241:FML/Src/W25QXX.c **** }
 671              		.loc 1 241 1 view .LVU170
 672 00ac 3846     		mov	r0, r7
 673 00ae 03B0     		add	sp, sp, #12
 674              	.LCFI15:
 675              		.cfi_remember_state
 676              		.cfi_def_cfa_offset 36
 677              		@ sp needed
 678 00b0 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 679              	.LVL59:
 680              	.L30:
 681              	.LCFI16:
 682              		.cfi_restore_state
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 18


 214:FML/Src/W25QXX.c ****     }
 683              		.loc 1 214 14 view .LVU171
 684 00b4 0127     		movs	r7, #1
 685 00b6 F9E7     		b	.L32
 686              	.L35:
 229:FML/Src/W25QXX.c **** 			}
 687              		.loc 1 229 12 view .LVU172
 688 00b8 0327     		movs	r7, #3
 689 00ba F7E7     		b	.L32
 690              	.L42:
 691              		.align	2
 692              	.L41:
 693 00bc 00000000 		.word	hspi3
 694              		.cfi_endproc
 695              	.LFE295:
 697              		.global	__aeabi_i2d
 698              		.global	__aeabi_dmul
 699              		.global	__aeabi_d2uiz
 700              		.section	.rodata.Flash_Test.str1.1,"aMS",%progbits,1
 701              	.LC2:
 702 0000 4D616E75 		.ascii	"Manu_ID:0x%02x,Dev_ID:0x%02x\015\012Manu_Identi:0x%"
 702      5F49443A 
 702      30782530 
 702      32782C44 
 702      65765F49 
 703 002d 3032782C 		.ascii	"02x,Memory_Type:0x%02x\015\012Capacity:0x%02x = %dK"
 703      4D656D6F 
 703      72795F54 
 703      7970653A 
 703      30782530 
 704 005a 2D426974 		.ascii	"-Bit = %d.%02dM-Bit\015\012\000"
 704      203D2025 
 704      642E2530 
 704      32644D2D 
 704      4269740D 
 705              	.LC3:
 706 0070 466C6173 		.ascii	"Flash Test OK\015\012\000"
 706      68205465 
 706      7374204F 
 706      4B0D0A00 
 707              	.LC4:
 708 0080 466C6173 		.ascii	"Flash Test Failed\015\012\000"
 708      68205465 
 708      73742046 
 708      61696C65 
 708      640D0A00 
 709              	.LC1:
 710 0094 68656C6C 		.ascii	"helloflash\000"
 710      6F666C61 
 710      736800
 711              		.section	.text.Flash_Test,"ax",%progbits
 712              		.align	1
 713              		.global	Flash_Test
 714              		.syntax unified
 715              		.thumb
 716              		.thumb_func
 718              	Flash_Test:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 19


 719              	.LFB299:
 242:FML/Src/W25QXX.c **** /**
 243:FML/Src/W25QXX.c ****   * @brief  Erases the specified Page of the QSPI memory. 
 244:FML/Src/W25QXX.c ****   * @param  BlockAddress: Page address to erase  
 245:FML/Src/W25QXX.c ****   * @retval QSPI memory status
 246:FML/Src/W25QXX.c ****   */
 247:FML/Src/W25QXX.c **** uint8_t BSP_W25Qx_Erase_Page(uint32_t Address)
 248:FML/Src/W25QXX.c **** {
 249:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 250:FML/Src/W25QXX.c **** 	uint32_t tickstart = HAL_GetTick();
 251:FML/Src/W25QXX.c **** 	cmd[0] = PAGE_ERASE_CMD;
 252:FML/Src/W25QXX.c **** 	cmd[1] = (uint8_t)(Address >> 16);
 253:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(Address >> 8);
 254:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(Address);
 255:FML/Src/W25QXX.c **** 	
 256:FML/Src/W25QXX.c **** 	/* Enable write operations */
 257:FML/Src/W25QXX.c **** 	BSP_W25Qx_WriteEnable();
 258:FML/Src/W25QXX.c **** 	
 259:FML/Src/W25QXX.c **** 	/*Select the FLASH: Chip Select low */
 260:FML/Src/W25QXX.c **** 	W25Qx_Enable();
 261:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 262:FML/Src/W25QXX.c **** 	HAL_SPI_Transmit(&hspi3, cmd, 4, W25Qx_TIMEOUT_VALUE);	
 263:FML/Src/W25QXX.c **** 	/*Deselect the FLASH: Chip Select high */
 264:FML/Src/W25QXX.c **** 	W25Qx_Disable();
 265:FML/Src/W25QXX.c **** 	
 266:FML/Src/W25QXX.c **** 	/* Wait the end of Flash writing */
 267:FML/Src/W25QXX.c **** 	while(BSP_W25Qx_GetStatus() == W25Qx_BUSY);
 268:FML/Src/W25QXX.c **** 	{
 269:FML/Src/W25QXX.c **** 		/* Check for the Timeout */
 270:FML/Src/W25QXX.c ****     if((HAL_GetTick() - tickstart) > W25Q128FV_SECTOR_ERASE_MAX_TIME)
 271:FML/Src/W25QXX.c ****     {        
 272:FML/Src/W25QXX.c **** 			return W25Qx_TIMEOUT;
 273:FML/Src/W25QXX.c ****     }
 274:FML/Src/W25QXX.c **** 	}
 275:FML/Src/W25QXX.c **** 	return W25Qx_OK;
 276:FML/Src/W25QXX.c **** }
 277:FML/Src/W25QXX.c **** /**
 278:FML/Src/W25QXX.c ****   * @brief  Erases the specified block of the QSPI memory. 
 279:FML/Src/W25QXX.c ****   * @param  BlockAddress: Block address to erase  
 280:FML/Src/W25QXX.c ****   * @retval QSPI memory status
 281:FML/Src/W25QXX.c ****   */
 282:FML/Src/W25QXX.c **** uint8_t BSP_W25Qx_Erase_Block(uint32_t Address)
 283:FML/Src/W25QXX.c **** {
 284:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 285:FML/Src/W25QXX.c **** 	uint32_t tickstart = HAL_GetTick();
 286:FML/Src/W25QXX.c **** 	cmd[0] = SECTOR_ERASE_CMD;
 287:FML/Src/W25QXX.c **** 	cmd[1] = (uint8_t)(Address >> 16);
 288:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(Address >> 8);
 289:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(Address);
 290:FML/Src/W25QXX.c **** 	
 291:FML/Src/W25QXX.c **** 	/* Enable write operations */
 292:FML/Src/W25QXX.c **** 	BSP_W25Qx_WriteEnable();
 293:FML/Src/W25QXX.c **** 	
 294:FML/Src/W25QXX.c **** 	/*Select the FLASH: Chip Select low */
 295:FML/Src/W25QXX.c **** 	W25Qx_Enable();
 296:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 297:FML/Src/W25QXX.c **** 	HAL_SPI_Transmit(&hspi3, cmd, 4, W25Qx_TIMEOUT_VALUE);	
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 20


 298:FML/Src/W25QXX.c **** 	/*Deselect the FLASH: Chip Select high */
 299:FML/Src/W25QXX.c **** 	W25Qx_Disable();
 300:FML/Src/W25QXX.c **** 	
 301:FML/Src/W25QXX.c **** 	/* Wait the end of Flash writing */
 302:FML/Src/W25QXX.c **** 	while(BSP_W25Qx_GetStatus() == W25Qx_BUSY);
 303:FML/Src/W25QXX.c **** 	{
 304:FML/Src/W25QXX.c **** 		/* Check for the Timeout */
 305:FML/Src/W25QXX.c ****     if((HAL_GetTick() - tickstart) > W25Q128FV_SECTOR_ERASE_MAX_TIME)
 306:FML/Src/W25QXX.c ****     {        
 307:FML/Src/W25QXX.c **** 			return W25Qx_TIMEOUT;
 308:FML/Src/W25QXX.c ****     }
 309:FML/Src/W25QXX.c **** 	}
 310:FML/Src/W25QXX.c **** 	return W25Qx_OK;
 311:FML/Src/W25QXX.c **** }
 312:FML/Src/W25QXX.c **** 
 313:FML/Src/W25QXX.c **** /**
 314:FML/Src/W25QXX.c ****   * @brief  Erases the entire QSPI memory.This function will take a very long time.
 315:FML/Src/W25QXX.c ****   * @retval QSPI memory status
 316:FML/Src/W25QXX.c ****   */
 317:FML/Src/W25QXX.c **** uint8_t BSP_W25Qx_Erase_Chip(void)
 318:FML/Src/W25QXX.c **** {
 319:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 320:FML/Src/W25QXX.c **** 	uint32_t tickstart = HAL_GetTick();
 321:FML/Src/W25QXX.c **** 	cmd[0] = SECTOR_ERASE_CMD;
 322:FML/Src/W25QXX.c **** 	
 323:FML/Src/W25QXX.c **** 	/* Enable write operations */
 324:FML/Src/W25QXX.c **** 	BSP_W25Qx_WriteEnable();
 325:FML/Src/W25QXX.c **** 	
 326:FML/Src/W25QXX.c **** 	/*Select the FLASH: Chip Select low */
 327:FML/Src/W25QXX.c **** 	W25Qx_Enable();
 328:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 329:FML/Src/W25QXX.c **** 	HAL_SPI_Transmit(&hspi3, cmd, 1, W25Qx_TIMEOUT_VALUE);	
 330:FML/Src/W25QXX.c **** 	/*Deselect the FLASH: Chip Select high */
 331:FML/Src/W25QXX.c **** 	W25Qx_Disable();
 332:FML/Src/W25QXX.c **** 	
 333:FML/Src/W25QXX.c **** 	/* Wait the end of Flash writing */
 334:FML/Src/W25QXX.c **** 	while(BSP_W25Qx_GetStatus() != W25Qx_BUSY);
 335:FML/Src/W25QXX.c **** 	{
 336:FML/Src/W25QXX.c **** 		/* Check for the Timeout */
 337:FML/Src/W25QXX.c ****     if((HAL_GetTick() - tickstart) > W25Q128FV_BULK_ERASE_MAX_TIME)
 338:FML/Src/W25QXX.c ****     {        
 339:FML/Src/W25QXX.c **** 			return W25Qx_TIMEOUT;
 340:FML/Src/W25QXX.c ****     }
 341:FML/Src/W25QXX.c **** 	}
 342:FML/Src/W25QXX.c **** 	return W25Qx_OK;
 343:FML/Src/W25QXX.c **** }
 344:FML/Src/W25QXX.c **** 
 345:FML/Src/W25QXX.c **** /**
 346:FML/Src/W25QXX.c ****  * @brief Flash测试函数
 347:FML/Src/W25QXX.c ****  * 		  1）读取并打印Flash芯片ID 参数 容量等信息
 348:FML/Src/W25QXX.c ****  *        2）朝flash指定位置写入0x55
 349:FML/Src/W25QXX.c ****  * 		  3）读取指定位置，判断是否是0x55,以此判断是否能正常读写
 350:FML/Src/W25QXX.c ****  * 
 351:FML/Src/W25QXX.c ****  * @param str 
 352:FML/Src/W25QXX.c ****  */
 353:FML/Src/W25QXX.c **** void Flash_Test(void)
 354:FML/Src/W25QXX.c **** {
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 21


 720              		.loc 1 354 1 is_stmt 1 view -0
 721              		.cfi_startproc
 722              		@ args = 0, pretend = 0, frame = 40
 723              		@ frame_needed = 0, uses_anonymous_args = 0
 355:FML/Src/W25QXX.c ****   uint8_t flash_id[2] = {0x00,};
 724              		.loc 1 355 3 view .LVU174
 354:FML/Src/W25QXX.c ****   uint8_t flash_id[2] = {0x00,};
 725              		.loc 1 354 1 is_stmt 0 view .LVU175
 726 0000 10B5     		push	{r4, lr}
 727              	.LCFI17:
 728              		.cfi_def_cfa_offset 8
 729              		.cfi_offset 4, -8
 730              		.cfi_offset 14, -4
 356:FML/Src/W25QXX.c ****   uint8_t JEDEC_id[3] = {0x00,};
 731              		.loc 1 356 11 view .LVU176
 732 0002 434B     		ldr	r3, .L47+8
 357:FML/Src/W25QXX.c ****   char test_buff[] = "helloflash";
 733              		.loc 1 357 8 view .LVU177
 734 0004 434C     		ldr	r4, .L47+12
 356:FML/Src/W25QXX.c ****   uint8_t JEDEC_id[3] = {0x00,};
 735              		.loc 1 356 11 view .LVU178
 736 0006 1B88     		ldrh	r3, [r3]	@ unaligned
 737              		.loc 1 357 8 view .LVU179
 738 0008 2068     		ldr	r0, [r4]	@ unaligned
 739 000a 6168     		ldr	r1, [r4, #4]	@ unaligned
 354:FML/Src/W25QXX.c ****   uint8_t flash_id[2] = {0x00,};
 740              		.loc 1 354 1 view .LVU180
 741 000c 90B0     		sub	sp, sp, #64
 742              	.LCFI18:
 743              		.cfi_def_cfa_offset 72
 355:FML/Src/W25QXX.c ****   uint8_t JEDEC_id[3] = {0x00,};
 744              		.loc 1 355 11 view .LVU181
 745 000e 0022     		movs	r2, #0
 356:FML/Src/W25QXX.c ****   uint8_t JEDEC_id[3] = {0x00,};
 746              		.loc 1 356 11 view .LVU182
 747 0010 ADF82430 		strh	r3, [sp, #36]	@ unaligned
 748              		.loc 1 357 8 view .LVU183
 749 0014 0DAB     		add	r3, sp, #52
 750 0016 03C3     		stmia	r3!, {r0, r1}
 751 0018 2089     		ldrh	r0, [r4, #8]	@ unaligned
 752 001a 1880     		strh	r0, [r3]	@ unaligned
 753 001c A17A     		ldrb	r1, [r4, #10]	@ zero_extendqisi2
 355:FML/Src/W25QXX.c ****   uint8_t JEDEC_id[3] = {0x00,};
 754              		.loc 1 355 11 view .LVU184
 755 001e ADF82020 		strh	r2, [sp, #32]	@ movhi
 356:FML/Src/W25QXX.c ****   uint8_t JEDEC_id[3] = {0x00,};
 756              		.loc 1 356 3 is_stmt 1 view .LVU185
 358:FML/Src/W25QXX.c ****   char read_buff[10] = {0x00,};
 359:FML/Src/W25QXX.c ****   uint32_t cap_kb = 0;
 360:FML/Src/W25QXX.c ****   float cap_mb = 0.0f;
 361:FML/Src/W25QXX.c ****   /*读取Flash 芯片信息 并打印*/
 362:FML/Src/W25QXX.c ****   BSP_W25Qx_Read_ID(flash_id);
 757              		.loc 1 362 3 is_stmt 0 view .LVU186
 758 0022 08A8     		add	r0, sp, #32
 358:FML/Src/W25QXX.c ****   char read_buff[10] = {0x00,};
 759              		.loc 1 358 8 view .LVU187
 760 0024 CDE90A22 		strd	r2, r2, [sp, #40]
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 22


 356:FML/Src/W25QXX.c ****   char test_buff[] = "helloflash";
 761              		.loc 1 356 11 view .LVU188
 762 0028 8DF82620 		strb	r2, [sp, #38]
 357:FML/Src/W25QXX.c ****   char read_buff[10] = {0x00,};
 763              		.loc 1 357 3 is_stmt 1 view .LVU189
 357:FML/Src/W25QXX.c ****   char read_buff[10] = {0x00,};
 764              		.loc 1 357 8 is_stmt 0 view .LVU190
 765 002c 9970     		strb	r1, [r3, #2]
 358:FML/Src/W25QXX.c ****   char read_buff[10] = {0x00,};
 766              		.loc 1 358 3 is_stmt 1 view .LVU191
 358:FML/Src/W25QXX.c ****   char read_buff[10] = {0x00,};
 767              		.loc 1 358 8 is_stmt 0 view .LVU192
 768 002e ADF83020 		strh	r2, [sp, #48]	@ movhi
 359:FML/Src/W25QXX.c ****   float cap_mb = 0.0f;
 769              		.loc 1 359 3 is_stmt 1 view .LVU193
 770              	.LVL60:
 360:FML/Src/W25QXX.c ****   /*读取Flash 芯片信息 并打印*/
 771              		.loc 1 360 3 view .LVU194
 772              		.loc 1 362 3 view .LVU195
 773 0032 FFF7FEFF 		bl	BSP_W25Qx_Read_ID
 774              	.LVL61:
 363:FML/Src/W25QXX.c ****   BSP_W25Qx_Read_JEDEC_ID(JEDEC_id);
 775              		.loc 1 363 3 view .LVU196
 776 0036 09A8     		add	r0, sp, #36
 777 0038 FFF7FEFF 		bl	BSP_W25Qx_Read_JEDEC_ID
 778              	.LVL62:
 364:FML/Src/W25QXX.c ****   cap_kb = pow(2 , (JEDEC_id[2] - 10)) *8 ;
 779              		.loc 1 364 3 view .LVU197
 780              		.loc 1 364 29 is_stmt 0 view .LVU198
 781 003c 9DF82600 		ldrb	r0, [sp, #38]	@ zero_extendqisi2
 782              		.loc 1 364 12 view .LVU199
 783 0040 0A38     		subs	r0, r0, #10
 784 0042 FFF7FEFF 		bl	__aeabi_i2d
 785              	.LVL63:
 786 0046 9FED300B 		vldr.64	d0, .L47
 787 004a 41EC110B 		vmov	d1, r0, r1
 788 004e FFF7FEFF 		bl	pow
 789              	.LVL64:
 790              		.loc 1 364 40 view .LVU200
 791 0052 314B     		ldr	r3, .L47+16
 792              		.loc 1 364 12 view .LVU201
 793 0054 51EC100B 		vmov	r0, r1, d0
 794              		.loc 1 364 40 view .LVU202
 795 0058 0022     		movs	r2, #0
 796 005a FFF7FEFF 		bl	__aeabi_dmul
 797              	.LVL65:
 798              		.loc 1 364 10 view .LVU203
 799 005e FFF7FEFF 		bl	__aeabi_d2uiz
 800              	.LVL66:
 365:FML/Src/W25QXX.c ****   cap_mb = (float)cap_kb / 1024.0;
 801              		.loc 1 365 10 view .LVU204
 802 0062 07EE100A 		vmov	s14, r0	@ int
 366:FML/Src/W25QXX.c **** 
 367:FML/Src/W25QXX.c ****   shellPrint(&shell,"Manu_ID:0x%02x,Dev_ID:0x%02x\r\nManu_Identi:0x%02x,Memory_Type:0x%02x\r\n\
 368:FML/Src/W25QXX.c **** Capacity:0x%02x = %dK-Bit = %d.%02dM-Bit\r\n",flash_id[0],flash_id[1],JEDEC_id[0],JEDEC_id[1],JEDEC
 803              		.loc 1 368 149 view .LVU205
 804 0066 DFED2D7A 		vldr.32	s15, .L47+20
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 23


 367:FML/Src/W25QXX.c **** Capacity:0x%02x = %dK-Bit = %d.%02dM-Bit\r\n",flash_id[0],flash_id[1],JEDEC_id[0],JEDEC_id[1],JEDEC
 805              		.loc 1 367 3 view .LVU206
 806 006a 0390     		str	r0, [sp, #12]
 365:FML/Src/W25QXX.c ****   cap_mb = (float)cap_kb / 1024.0;
 807              		.loc 1 365 10 view .LVU207
 808 006c BBEECB7A 		vcvt.f32.u32	s14, s14, #10
 367:FML/Src/W25QXX.c **** Capacity:0x%02x = %dK-Bit = %d.%02dM-Bit\r\n",flash_id[0],flash_id[1],JEDEC_id[0],JEDEC_id[1],JEDEC
 809              		.loc 1 367 3 view .LVU208
 810 0070 6422     		movs	r2, #100
 811              		.loc 1 368 149 view .LVU209
 812 0072 67EE277A 		vmul.f32	s15, s14, s15
 367:FML/Src/W25QXX.c **** Capacity:0x%02x = %dK-Bit = %d.%02dM-Bit\r\n",flash_id[0],flash_id[1],JEDEC_id[0],JEDEC_id[1],JEDEC
 813              		.loc 1 367 3 view .LVU210
 814 0076 BCEEC77A 		vcvt.u32.f32	s14, s14
 815              		.loc 1 368 132 view .LVU211
 816 007a FCEEE77A 		vcvt.u32.f32	s15, s15
 367:FML/Src/W25QXX.c **** Capacity:0x%02x = %dK-Bit = %d.%02dM-Bit\r\n",flash_id[0],flash_id[1],JEDEC_id[0],JEDEC_id[1],JEDEC
 817              		.loc 1 367 3 view .LVU212
 818 007e 8DED047A 		vstr.32	s14, [sp, #16]	@ int
 819              		.loc 1 368 132 view .LVU213
 820 0082 17EE903A 		vmov	r3, s15	@ int
 367:FML/Src/W25QXX.c **** Capacity:0x%02x = %dK-Bit = %d.%02dM-Bit\r\n",flash_id[0],flash_id[1],JEDEC_id[0],JEDEC_id[1],JEDEC
 821              		.loc 1 367 3 view .LVU214
 822 0086 B3FBF2F1 		udiv	r1, r3, r2
 823 008a 02FB1133 		mls	r3, r2, r1, r3
 824 008e 0593     		str	r3, [sp, #20]
 825 0090 9DF82630 		ldrb	r3, [sp, #38]	@ zero_extendqisi2
 826 0094 0293     		str	r3, [sp, #8]
 827 0096 9DF82530 		ldrb	r3, [sp, #37]	@ zero_extendqisi2
 828 009a 0193     		str	r3, [sp, #4]
 829 009c 9DF82430 		ldrb	r3, [sp, #36]	@ zero_extendqisi2
 830 00a0 9DF82020 		ldrb	r2, [sp, #32]	@ zero_extendqisi2
 831 00a4 1E49     		ldr	r1, .L47+24
 832 00a6 0093     		str	r3, [sp]
 364:FML/Src/W25QXX.c ****   cap_mb = (float)cap_kb / 1024.0;
 833              		.loc 1 364 10 view .LVU215
 834 00a8 0446     		mov	r4, r0
 835              	.LVL67:
 365:FML/Src/W25QXX.c **** 
 836              		.loc 1 365 3 is_stmt 1 view .LVU216
 367:FML/Src/W25QXX.c **** Capacity:0x%02x = %dK-Bit = %d.%02dM-Bit\r\n",flash_id[0],flash_id[1],JEDEC_id[0],JEDEC_id[1],JEDEC
 837              		.loc 1 367 3 view .LVU217
 838 00aa 9DF82130 		ldrb	r3, [sp, #33]	@ zero_extendqisi2
 839 00ae 1D48     		ldr	r0, .L47+28
 840              	.LVL68:
 367:FML/Src/W25QXX.c **** Capacity:0x%02x = %dK-Bit = %d.%02dM-Bit\r\n",flash_id[0],flash_id[1],JEDEC_id[0],JEDEC_id[1],JEDEC
 841              		.loc 1 367 3 is_stmt 0 view .LVU218
 842 00b0 FFF7FEFF 		bl	shellPrint
 843              	.LVL69:
 369:FML/Src/W25QXX.c ****   
 370:FML/Src/W25QXX.c ****   /**/
 371:FML/Src/W25QXX.c ****   BSP_W25Qx_Write(test_buff,cap_kb*1024-10,10);
 844              		.loc 1 371 3 is_stmt 1 view .LVU219
 845              		.loc 1 371 35 is_stmt 0 view .LVU220
 846 00b4 A102     		lsls	r1, r4, #10
 847              		.loc 1 371 3 view .LVU221
 848 00b6 0A39     		subs	r1, r1, #10
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 24


 849 00b8 0A22     		movs	r2, #10
 850 00ba 0DA8     		add	r0, sp, #52
 851 00bc 0791     		str	r1, [sp, #28]
 852 00be FFF7FEFF 		bl	BSP_W25Qx_Write
 853              	.LVL70:
 372:FML/Src/W25QXX.c ****   Delay_ms(50);
 854              		.loc 1 372 3 is_stmt 1 view .LVU222
 855 00c2 3220     		movs	r0, #50
 856 00c4 FFF7FEFF 		bl	Delay_ms
 857              	.LVL71:
 373:FML/Src/W25QXX.c ****   BSP_W25Qx_Read(read_buff,cap_kb*1024-10,10);
 858              		.loc 1 373 3 view .LVU223
 859 00c8 0799     		ldr	r1, [sp, #28]
 860 00ca 0A22     		movs	r2, #10
 861 00cc 0AA8     		add	r0, sp, #40
 862 00ce FFF7FEFF 		bl	BSP_W25Qx_Read
 863              	.LVL72:
 374:FML/Src/W25QXX.c ****   if(strcmp(read_buff,test_buff) == 0){
 864              		.loc 1 374 3 view .LVU224
 865              		.loc 1 374 6 is_stmt 0 view .LVU225
 866 00d2 0DA9     		add	r1, sp, #52
 867 00d4 0AA8     		add	r0, sp, #40
 868 00d6 FFF7FEFF 		bl	strcmp
 869              	.LVL73:
 870              		.loc 1 374 5 view .LVU226
 871 00da 60B9     		cbnz	r0, .L44
 375:FML/Src/W25QXX.c **** 	shellPrint(&shell,"Flash Test OK\r\n");
 872              		.loc 1 375 2 is_stmt 1 view .LVU227
 873 00dc 1249     		ldr	r1, .L47+32
 874 00de 1148     		ldr	r0, .L47+28
 875 00e0 FFF7FEFF 		bl	shellPrint
 876              	.LVL74:
 376:FML/Src/W25QXX.c **** 	test_ok_cnt++;
 877              		.loc 1 376 2 view .LVU228
 878              		.loc 1 376 13 is_stmt 0 view .LVU229
 879 00e4 114A     		ldr	r2, .L47+36
 880              	.L46:
 377:FML/Src/W25QXX.c ****   }
 378:FML/Src/W25QXX.c ****   else{
 379:FML/Src/W25QXX.c **** 	shellPrint(&shell,"Flash Test Failed\r\n");
 380:FML/Src/W25QXX.c **** 	test_error_cnt++;
 881              		.loc 1 380 16 view .LVU230
 882 00e6 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 883 00e8 0133     		adds	r3, r3, #1
 884 00ea 1370     		strb	r3, [r2]
 381:FML/Src/W25QXX.c ****   }
 382:FML/Src/W25QXX.c ****   Delay_ms(10);
 885              		.loc 1 382 3 is_stmt 1 view .LVU231
 886 00ec 0A20     		movs	r0, #10
 887 00ee FFF7FEFF 		bl	Delay_ms
 888              	.LVL75:
 383:FML/Src/W25QXX.c **** 
 384:FML/Src/W25QXX.c **** }
 889              		.loc 1 384 1 is_stmt 0 view .LVU232
 890 00f2 10B0     		add	sp, sp, #64
 891              	.LCFI19:
 892              		.cfi_remember_state
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 25


 893              		.cfi_def_cfa_offset 8
 894              		@ sp needed
 895 00f4 10BD     		pop	{r4, pc}
 896              	.LVL76:
 897              	.L44:
 898              	.LCFI20:
 899              		.cfi_restore_state
 379:FML/Src/W25QXX.c **** 	test_error_cnt++;
 900              		.loc 1 379 2 is_stmt 1 view .LVU233
 901 00f6 0E49     		ldr	r1, .L47+40
 902 00f8 0A48     		ldr	r0, .L47+28
 903 00fa FFF7FEFF 		bl	shellPrint
 904              	.LVL77:
 380:FML/Src/W25QXX.c ****   }
 905              		.loc 1 380 2 view .LVU234
 380:FML/Src/W25QXX.c ****   }
 906              		.loc 1 380 16 is_stmt 0 view .LVU235
 907 00fe 0D4A     		ldr	r2, .L47+44
 908 0100 F1E7     		b	.L46
 909              	.L48:
 910 0102 00BFAFF3 		.align	3
 910      0080
 911              	.L47:
 912 0108 00000000 		.word	0
 913 010c 00000040 		.word	1073741824
 914 0110 00000000 		.word	.LANCHOR0
 915 0114 94000000 		.word	.LC1
 916 0118 00002040 		.word	1075838976
 917 011c 0000C842 		.word	1120403456
 918 0120 00000000 		.word	.LC2
 919 0124 00000000 		.word	shell
 920 0128 70000000 		.word	.LC3
 921 012c 00000000 		.word	test_ok_cnt
 922 0130 80000000 		.word	.LC4
 923 0134 00000000 		.word	test_error_cnt
 924              		.cfi_endproc
 925              	.LFE299:
 927              		.section	.text.BSP_W25Qx_Erase_Page,"ax",%progbits
 928              		.align	1
 929              		.global	BSP_W25Qx_Erase_Page
 930              		.syntax unified
 931              		.thumb
 932              		.thumb_func
 934              	BSP_W25Qx_Erase_Page:
 935              	.LVL78:
 936              	.LFB296:
 248:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 937              		.loc 1 248 1 is_stmt 1 view -0
 938              		.cfi_startproc
 939              		@ args = 0, pretend = 0, frame = 8
 940              		@ frame_needed = 0, uses_anonymous_args = 0
 249:FML/Src/W25QXX.c **** 	uint32_t tickstart = HAL_GetTick();
 941              		.loc 1 249 2 view .LVU237
 250:FML/Src/W25QXX.c **** 	cmd[0] = PAGE_ERASE_CMD;
 942              		.loc 1 250 2 view .LVU238
 248:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 943              		.loc 1 248 1 is_stmt 0 view .LVU239
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 26


 944 0000 37B5     		push	{r0, r1, r2, r4, r5, lr}
 945              	.LCFI21:
 946              		.cfi_def_cfa_offset 24
 947              		.cfi_offset 4, -12
 948              		.cfi_offset 5, -8
 949              		.cfi_offset 14, -4
 248:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 950              		.loc 1 248 1 view .LVU240
 951 0002 0446     		mov	r4, r0
 250:FML/Src/W25QXX.c **** 	cmd[0] = PAGE_ERASE_CMD;
 952              		.loc 1 250 23 view .LVU241
 953 0004 FFF7FEFF 		bl	HAL_GetTick
 954              	.LVL79:
 251:FML/Src/W25QXX.c **** 	cmd[1] = (uint8_t)(Address >> 16);
 955              		.loc 1 251 9 view .LVU242
 956 0008 8123     		movs	r3, #129
 957 000a 8DF80430 		strb	r3, [sp, #4]
 252:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(Address >> 8);
 958              		.loc 1 252 29 view .LVU243
 959 000e 230C     		lsrs	r3, r4, #16
 252:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(Address >> 8);
 960              		.loc 1 252 11 view .LVU244
 961 0010 8DF80530 		strb	r3, [sp, #5]
 253:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(Address);
 962              		.loc 1 253 29 view .LVU245
 963 0014 230A     		lsrs	r3, r4, #8
 253:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(Address);
 964              		.loc 1 253 11 view .LVU246
 965 0016 8DF80630 		strb	r3, [sp, #6]
 250:FML/Src/W25QXX.c **** 	cmd[0] = PAGE_ERASE_CMD;
 966              		.loc 1 250 23 view .LVU247
 967 001a 0546     		mov	r5, r0
 968              	.LVL80:
 251:FML/Src/W25QXX.c **** 	cmd[1] = (uint8_t)(Address >> 16);
 969              		.loc 1 251 2 is_stmt 1 view .LVU248
 252:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(Address >> 8);
 970              		.loc 1 252 2 view .LVU249
 253:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(Address);
 971              		.loc 1 253 2 view .LVU250
 254:FML/Src/W25QXX.c **** 	
 972              		.loc 1 254 2 view .LVU251
 254:FML/Src/W25QXX.c **** 	
 973              		.loc 1 254 11 is_stmt 0 view .LVU252
 974 001c 8DF80740 		strb	r4, [sp, #7]
 257:FML/Src/W25QXX.c **** 	
 975              		.loc 1 257 2 is_stmt 1 view .LVU253
 976 0020 FFF7FEFF 		bl	BSP_W25Qx_WriteEnable
 977              	.LVL81:
 260:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 978              		.loc 1 260 2 view .LVU254
 979 0024 0022     		movs	r2, #0
 980 0026 1021     		movs	r1, #16
 981 0028 4FF09040 		mov	r0, #1207959552
 982 002c FFF7FEFF 		bl	HAL_GPIO_WritePin
 983              	.LVL82:
 262:FML/Src/W25QXX.c **** 	/*Deselect the FLASH: Chip Select high */
 984              		.loc 1 262 2 view .LVU255
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 27


 985 0030 0422     		movs	r2, #4
 986 0032 0DEB0201 		add	r1, sp, r2
 987 0036 0D48     		ldr	r0, .L55
 988 0038 4FF47A73 		mov	r3, #1000
 989 003c FFF7FEFF 		bl	HAL_SPI_Transmit
 990              	.LVL83:
 264:FML/Src/W25QXX.c **** 	
 991              		.loc 1 264 2 view .LVU256
 992 0040 0122     		movs	r2, #1
 993 0042 1021     		movs	r1, #16
 994 0044 4FF09040 		mov	r0, #1207959552
 995 0048 FFF7FEFF 		bl	HAL_GPIO_WritePin
 996              	.LVL84:
 267:FML/Src/W25QXX.c **** 	{
 997              		.loc 1 267 2 view .LVU257
 998              	.L50:
 267:FML/Src/W25QXX.c **** 	{
 999              		.loc 1 267 44 discriminator 1 view .LVU258
 267:FML/Src/W25QXX.c **** 	{
 1000              		.loc 1 267 7 discriminator 1 view .LVU259
 267:FML/Src/W25QXX.c **** 	{
 1001              		.loc 1 267 8 is_stmt 0 discriminator 1 view .LVU260
 1002 004c FFF7FEFF 		bl	BSP_W25Qx_GetStatus
 1003              	.LVL85:
 267:FML/Src/W25QXX.c **** 	{
 1004              		.loc 1 267 7 discriminator 1 view .LVU261
 1005 0050 0228     		cmp	r0, #2
 1006 0052 FBD0     		beq	.L50
 270:FML/Src/W25QXX.c ****     {        
 1007              		.loc 1 270 5 is_stmt 1 view .LVU262
 270:FML/Src/W25QXX.c ****     {        
 1008              		.loc 1 270 9 is_stmt 0 view .LVU263
 1009 0054 FFF7FEFF 		bl	HAL_GetTick
 1010              	.LVL86:
 276:FML/Src/W25QXX.c **** /**
 1011              		.loc 1 276 1 view .LVU264
 1012 0058 40F6B833 		movw	r3, #3000
 270:FML/Src/W25QXX.c ****     {        
 1013              		.loc 1 270 23 view .LVU265
 1014 005c 401B     		subs	r0, r0, r5
 276:FML/Src/W25QXX.c **** /**
 1015              		.loc 1 276 1 view .LVU266
 1016 005e 9842     		cmp	r0, r3
 1017 0060 8CBF     		ite	hi
 1018 0062 0320     		movhi	r0, #3
 1019 0064 0020     		movls	r0, #0
 1020 0066 03B0     		add	sp, sp, #12
 1021              	.LCFI22:
 1022              		.cfi_def_cfa_offset 12
 1023              		@ sp needed
 1024 0068 30BD     		pop	{r4, r5, pc}
 1025              	.LVL87:
 1026              	.L56:
 276:FML/Src/W25QXX.c **** /**
 1027              		.loc 1 276 1 view .LVU267
 1028 006a 00BF     		.align	2
 1029              	.L55:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 28


 1030 006c 00000000 		.word	hspi3
 1031              		.cfi_endproc
 1032              	.LFE296:
 1034              		.section	.text.BSP_W25Qx_Erase_Block,"ax",%progbits
 1035              		.align	1
 1036              		.global	BSP_W25Qx_Erase_Block
 1037              		.syntax unified
 1038              		.thumb
 1039              		.thumb_func
 1041              	BSP_W25Qx_Erase_Block:
 1042              	.LVL88:
 1043              	.LFB297:
 283:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 1044              		.loc 1 283 1 is_stmt 1 view -0
 1045              		.cfi_startproc
 1046              		@ args = 0, pretend = 0, frame = 8
 1047              		@ frame_needed = 0, uses_anonymous_args = 0
 284:FML/Src/W25QXX.c **** 	uint32_t tickstart = HAL_GetTick();
 1048              		.loc 1 284 2 view .LVU269
 285:FML/Src/W25QXX.c **** 	cmd[0] = SECTOR_ERASE_CMD;
 1049              		.loc 1 285 2 view .LVU270
 283:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 1050              		.loc 1 283 1 is_stmt 0 view .LVU271
 1051 0000 37B5     		push	{r0, r1, r2, r4, r5, lr}
 1052              	.LCFI23:
 1053              		.cfi_def_cfa_offset 24
 1054              		.cfi_offset 4, -12
 1055              		.cfi_offset 5, -8
 1056              		.cfi_offset 14, -4
 283:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 1057              		.loc 1 283 1 view .LVU272
 1058 0002 0446     		mov	r4, r0
 285:FML/Src/W25QXX.c **** 	cmd[0] = SECTOR_ERASE_CMD;
 1059              		.loc 1 285 23 view .LVU273
 1060 0004 FFF7FEFF 		bl	HAL_GetTick
 1061              	.LVL89:
 286:FML/Src/W25QXX.c **** 	cmd[1] = (uint8_t)(Address >> 16);
 1062              		.loc 1 286 9 view .LVU274
 1063 0008 2023     		movs	r3, #32
 1064 000a 8DF80430 		strb	r3, [sp, #4]
 287:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(Address >> 8);
 1065              		.loc 1 287 29 view .LVU275
 1066 000e 230C     		lsrs	r3, r4, #16
 287:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(Address >> 8);
 1067              		.loc 1 287 11 view .LVU276
 1068 0010 8DF80530 		strb	r3, [sp, #5]
 288:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(Address);
 1069              		.loc 1 288 29 view .LVU277
 1070 0014 230A     		lsrs	r3, r4, #8
 288:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(Address);
 1071              		.loc 1 288 11 view .LVU278
 1072 0016 8DF80630 		strb	r3, [sp, #6]
 285:FML/Src/W25QXX.c **** 	cmd[0] = SECTOR_ERASE_CMD;
 1073              		.loc 1 285 23 view .LVU279
 1074 001a 0546     		mov	r5, r0
 1075              	.LVL90:
 286:FML/Src/W25QXX.c **** 	cmd[1] = (uint8_t)(Address >> 16);
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 29


 1076              		.loc 1 286 2 is_stmt 1 view .LVU280
 287:FML/Src/W25QXX.c **** 	cmd[2] = (uint8_t)(Address >> 8);
 1077              		.loc 1 287 2 view .LVU281
 288:FML/Src/W25QXX.c **** 	cmd[3] = (uint8_t)(Address);
 1078              		.loc 1 288 2 view .LVU282
 289:FML/Src/W25QXX.c **** 	
 1079              		.loc 1 289 2 view .LVU283
 289:FML/Src/W25QXX.c **** 	
 1080              		.loc 1 289 11 is_stmt 0 view .LVU284
 1081 001c 8DF80740 		strb	r4, [sp, #7]
 292:FML/Src/W25QXX.c **** 	
 1082              		.loc 1 292 2 is_stmt 1 view .LVU285
 1083 0020 FFF7FEFF 		bl	BSP_W25Qx_WriteEnable
 1084              	.LVL91:
 295:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 1085              		.loc 1 295 2 view .LVU286
 1086 0024 0022     		movs	r2, #0
 1087 0026 1021     		movs	r1, #16
 1088 0028 4FF09040 		mov	r0, #1207959552
 1089 002c FFF7FEFF 		bl	HAL_GPIO_WritePin
 1090              	.LVL92:
 297:FML/Src/W25QXX.c **** 	/*Deselect the FLASH: Chip Select high */
 1091              		.loc 1 297 2 view .LVU287
 1092 0030 0422     		movs	r2, #4
 1093 0032 0DEB0201 		add	r1, sp, r2
 1094 0036 0D48     		ldr	r0, .L63
 1095 0038 4FF47A73 		mov	r3, #1000
 1096 003c FFF7FEFF 		bl	HAL_SPI_Transmit
 1097              	.LVL93:
 299:FML/Src/W25QXX.c **** 	
 1098              		.loc 1 299 2 view .LVU288
 1099 0040 0122     		movs	r2, #1
 1100 0042 1021     		movs	r1, #16
 1101 0044 4FF09040 		mov	r0, #1207959552
 1102 0048 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1103              	.LVL94:
 302:FML/Src/W25QXX.c **** 	{
 1104              		.loc 1 302 2 view .LVU289
 1105              	.L58:
 302:FML/Src/W25QXX.c **** 	{
 1106              		.loc 1 302 44 discriminator 1 view .LVU290
 302:FML/Src/W25QXX.c **** 	{
 1107              		.loc 1 302 7 discriminator 1 view .LVU291
 302:FML/Src/W25QXX.c **** 	{
 1108              		.loc 1 302 8 is_stmt 0 discriminator 1 view .LVU292
 1109 004c FFF7FEFF 		bl	BSP_W25Qx_GetStatus
 1110              	.LVL95:
 302:FML/Src/W25QXX.c **** 	{
 1111              		.loc 1 302 7 discriminator 1 view .LVU293
 1112 0050 0228     		cmp	r0, #2
 1113 0052 FBD0     		beq	.L58
 305:FML/Src/W25QXX.c ****     {        
 1114              		.loc 1 305 5 is_stmt 1 view .LVU294
 305:FML/Src/W25QXX.c ****     {        
 1115              		.loc 1 305 9 is_stmt 0 view .LVU295
 1116 0054 FFF7FEFF 		bl	HAL_GetTick
 1117              	.LVL96:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 30


 311:FML/Src/W25QXX.c **** 
 1118              		.loc 1 311 1 view .LVU296
 1119 0058 40F6B833 		movw	r3, #3000
 305:FML/Src/W25QXX.c ****     {        
 1120              		.loc 1 305 23 view .LVU297
 1121 005c 401B     		subs	r0, r0, r5
 311:FML/Src/W25QXX.c **** 
 1122              		.loc 1 311 1 view .LVU298
 1123 005e 9842     		cmp	r0, r3
 1124 0060 8CBF     		ite	hi
 1125 0062 0320     		movhi	r0, #3
 1126 0064 0020     		movls	r0, #0
 1127 0066 03B0     		add	sp, sp, #12
 1128              	.LCFI24:
 1129              		.cfi_def_cfa_offset 12
 1130              		@ sp needed
 1131 0068 30BD     		pop	{r4, r5, pc}
 1132              	.LVL97:
 1133              	.L64:
 311:FML/Src/W25QXX.c **** 
 1134              		.loc 1 311 1 view .LVU299
 1135 006a 00BF     		.align	2
 1136              	.L63:
 1137 006c 00000000 		.word	hspi3
 1138              		.cfi_endproc
 1139              	.LFE297:
 1141              		.section	.text.BSP_W25Qx_Erase_Chip,"ax",%progbits
 1142              		.align	1
 1143              		.global	BSP_W25Qx_Erase_Chip
 1144              		.syntax unified
 1145              		.thumb
 1146              		.thumb_func
 1148              	BSP_W25Qx_Erase_Chip:
 1149              	.LFB298:
 318:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 1150              		.loc 1 318 1 is_stmt 1 view -0
 1151              		.cfi_startproc
 1152              		@ args = 0, pretend = 0, frame = 8
 1153              		@ frame_needed = 0, uses_anonymous_args = 0
 319:FML/Src/W25QXX.c **** 	uint32_t tickstart = HAL_GetTick();
 1154              		.loc 1 319 2 view .LVU301
 320:FML/Src/W25QXX.c **** 	cmd[0] = SECTOR_ERASE_CMD;
 1155              		.loc 1 320 2 view .LVU302
 318:FML/Src/W25QXX.c **** 	uint8_t cmd[4];
 1156              		.loc 1 318 1 is_stmt 0 view .LVU303
 1157 0000 13B5     		push	{r0, r1, r4, lr}
 1158              	.LCFI25:
 1159              		.cfi_def_cfa_offset 16
 1160              		.cfi_offset 4, -8
 1161              		.cfi_offset 14, -4
 320:FML/Src/W25QXX.c **** 	cmd[0] = SECTOR_ERASE_CMD;
 1162              		.loc 1 320 23 view .LVU304
 1163 0002 FFF7FEFF 		bl	HAL_GetTick
 1164              	.LVL98:
 321:FML/Src/W25QXX.c **** 	
 1165              		.loc 1 321 9 view .LVU305
 1166 0006 2023     		movs	r3, #32
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 31


 1167 0008 8DF80430 		strb	r3, [sp, #4]
 320:FML/Src/W25QXX.c **** 	cmd[0] = SECTOR_ERASE_CMD;
 1168              		.loc 1 320 23 view .LVU306
 1169 000c 0446     		mov	r4, r0
 1170              	.LVL99:
 321:FML/Src/W25QXX.c **** 	
 1171              		.loc 1 321 2 is_stmt 1 view .LVU307
 324:FML/Src/W25QXX.c **** 	
 1172              		.loc 1 324 2 view .LVU308
 1173 000e FFF7FEFF 		bl	BSP_W25Qx_WriteEnable
 1174              	.LVL100:
 327:FML/Src/W25QXX.c **** 	/* Send the read ID command */
 1175              		.loc 1 327 2 view .LVU309
 1176 0012 0022     		movs	r2, #0
 1177 0014 1021     		movs	r1, #16
 1178 0016 4FF09040 		mov	r0, #1207959552
 1179 001a FFF7FEFF 		bl	HAL_GPIO_WritePin
 1180              	.LVL101:
 329:FML/Src/W25QXX.c **** 	/*Deselect the FLASH: Chip Select high */
 1181              		.loc 1 329 2 view .LVU310
 1182 001e 0122     		movs	r2, #1
 1183 0020 01A9     		add	r1, sp, #4
 1184 0022 0C48     		ldr	r0, .L70
 1185 0024 4FF47A73 		mov	r3, #1000
 1186 0028 FFF7FEFF 		bl	HAL_SPI_Transmit
 1187              	.LVL102:
 331:FML/Src/W25QXX.c **** 	
 1188              		.loc 1 331 2 view .LVU311
 1189 002c 0122     		movs	r2, #1
 1190 002e 1021     		movs	r1, #16
 1191 0030 4FF09040 		mov	r0, #1207959552
 1192 0034 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1193              	.LVL103:
 334:FML/Src/W25QXX.c **** 	{
 1194              		.loc 1 334 2 view .LVU312
 1195              	.L66:
 334:FML/Src/W25QXX.c **** 	{
 1196              		.loc 1 334 44 discriminator 1 view .LVU313
 334:FML/Src/W25QXX.c **** 	{
 1197              		.loc 1 334 7 discriminator 1 view .LVU314
 334:FML/Src/W25QXX.c **** 	{
 1198              		.loc 1 334 8 is_stmt 0 discriminator 1 view .LVU315
 1199 0038 FFF7FEFF 		bl	BSP_W25Qx_GetStatus
 1200              	.LVL104:
 334:FML/Src/W25QXX.c **** 	{
 1201              		.loc 1 334 7 discriminator 1 view .LVU316
 1202 003c 0228     		cmp	r0, #2
 1203 003e FBD1     		bne	.L66
 337:FML/Src/W25QXX.c ****     {        
 1204              		.loc 1 337 5 is_stmt 1 view .LVU317
 337:FML/Src/W25QXX.c ****     {        
 1205              		.loc 1 337 9 is_stmt 0 view .LVU318
 1206 0040 FFF7FEFF 		bl	HAL_GetTick
 1207              	.LVL105:
 343:FML/Src/W25QXX.c **** 
 1208              		.loc 1 343 1 view .LVU319
 1209 0044 044B     		ldr	r3, .L70+4
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 32


 337:FML/Src/W25QXX.c ****     {        
 1210              		.loc 1 337 23 view .LVU320
 1211 0046 001B     		subs	r0, r0, r4
 343:FML/Src/W25QXX.c **** 
 1212              		.loc 1 343 1 view .LVU321
 1213 0048 9842     		cmp	r0, r3
 1214 004a 8CBF     		ite	hi
 1215 004c 0320     		movhi	r0, #3
 1216 004e 0020     		movls	r0, #0
 1217 0050 02B0     		add	sp, sp, #8
 1218              	.LCFI26:
 1219              		.cfi_def_cfa_offset 8
 1220              		@ sp needed
 1221 0052 10BD     		pop	{r4, pc}
 1222              	.LVL106:
 1223              	.L71:
 343:FML/Src/W25QXX.c **** 
 1224              		.loc 1 343 1 view .LVU322
 1225              		.align	2
 1226              	.L70:
 1227 0054 00000000 		.word	hspi3
 1228 0058 90D00300 		.word	250000
 1229              		.cfi_endproc
 1230              	.LFE298:
 1232              		.global	shellCommandflash_test
 1233              		.global	shellDescflash_test
 1234              		.global	shellCmdflash_test
 1235              		.section	.rodata
 1236              		.set	.LANCHOR0,. + 0
 1237              	.LC0:
 1238 0000 0000     		.ascii	"\000\000"
 1239 0002 00       		.space	1
 1240              		.section	.rodata.shellCmdflash_test,"a"
 1243              	shellCmdflash_test:
 1244 0000 666C6173 		.ascii	"flash_test\000"
 1244      685F7465 
 1244      737400
 1245              		.section	.rodata.shellDescflash_test,"a"
 1248              	shellDescflash_test:
 1249 0000 72656164 		.ascii	"read flash info and w/r test\000"
 1249      20666C61 
 1249      73682069 
 1249      6E666F20 
 1249      616E6420 
 1250              		.section	shellCommand,"a"
 1253              	shellCommandflash_test:
 1254 0000 00210000 		.4byte	8448
 1255 0004 00000000 		.4byte	shellCmdflash_test
 1256 0008 00000000 		.4byte	Flash_Test
 1257 000c 00000000 		.4byte	shellDescflash_test
 1258              		.text
 1259              	.Letext0:
 1260              		.file 2 "e:\\gcc-arm-none-eabi-10.3-2021.10-win32\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\
 1261              		.file 3 "e:\\gcc-arm-none-eabi-10.3-2021.10-win32\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\
 1262              		.file 4 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/stm32l431xx.h"
 1263              		.file 5 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_def.h"
 1264              		.file 6 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_gpio.h"
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 33


 1265              		.file 7 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_dma.h"
 1266              		.file 8 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_spi.h"
 1267              		.file 9 "ThirdParty/Letter-shell/Inc/shell.h"
 1268              		.file 10 "HAL/Inc/spi.h"
 1269              		.file 11 "ThirdParty/Letter-shell/Inc/shell_port.h"
 1270              		.file 12 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal.h"
 1271              		.file 13 "e:\\gcc-arm-none-eabi-10.3-2021.10-win32\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\
 1272              		.file 14 "<built-in>"
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s 			page 34


DEFINED SYMBOLS
                            *ABS*:00000000 W25QXX.c
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:20     .text.BSP_W25Qx_GetStatus:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:25     .text.BSP_W25Qx_GetStatus:00000000 BSP_W25Qx_GetStatus
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:85     .text.BSP_W25Qx_GetStatus:00000050 $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:90     .text.BSP_W25Qx_Init:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:96     .text.BSP_W25Qx_Init:00000000 BSP_W25Qx_Init
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:159    .text.BSP_W25Qx_Init:0000003c $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:164    .text.BSP_W25Qx_WriteEnable:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:170    .text.BSP_W25Qx_WriteEnable:00000000 BSP_W25Qx_WriteEnable
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:247    .text.BSP_W25Qx_WriteEnable:00000050 $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:252    .text.BSP_W25Qx_Read_ID:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:258    .text.BSP_W25Qx_Read_ID:00000000 BSP_W25Qx_Read_ID
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:321    .text.BSP_W25Qx_Read_ID:00000044 $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:326    .text.BSP_W25Qx_Read_JEDEC_ID:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:332    .text.BSP_W25Qx_Read_JEDEC_ID:00000000 BSP_W25Qx_Read_JEDEC_ID
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:394    .text.BSP_W25Qx_Read_JEDEC_ID:00000044 $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:399    .text.BSP_W25Qx_Read:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:405    .text.BSP_W25Qx_Read:00000000 BSP_W25Qx_Read
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:498    .text.BSP_W25Qx_Read:00000060 $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:503    .text.BSP_W25Qx_Write:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:509    .text.BSP_W25Qx_Write:00000000 BSP_W25Qx_Write
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:693    .text.BSP_W25Qx_Write:000000bc $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:712    .text.Flash_Test:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:718    .text.Flash_Test:00000000 Flash_Test
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:912    .text.Flash_Test:00000108 $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:928    .text.BSP_W25Qx_Erase_Page:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:934    .text.BSP_W25Qx_Erase_Page:00000000 BSP_W25Qx_Erase_Page
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1030   .text.BSP_W25Qx_Erase_Page:0000006c $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1035   .text.BSP_W25Qx_Erase_Block:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1041   .text.BSP_W25Qx_Erase_Block:00000000 BSP_W25Qx_Erase_Block
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1137   .text.BSP_W25Qx_Erase_Block:0000006c $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1142   .text.BSP_W25Qx_Erase_Chip:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1148   .text.BSP_W25Qx_Erase_Chip:00000000 BSP_W25Qx_Erase_Chip
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1227   .text.BSP_W25Qx_Erase_Chip:00000054 $d
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1253   shellCommand:00000000 shellCommandflash_test
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1248   .rodata.shellDescflash_test:00000000 shellDescflash_test
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1243   .rodata.shellCmdflash_test:00000000 shellCmdflash_test
C:\Users\CL\AppData\Local\Temp\ccTMeLY1.s:1239   .rodata:00000002 $d

UNDEFINED SYMBOLS
HAL_GPIO_WritePin
HAL_SPI_Transmit
HAL_SPI_Receive
hspi3
HAL_GetTick
__aeabi_i2d
__aeabi_dmul
__aeabi_d2uiz
pow
shellPrint
Delay_ms
strcmp
shell
test_ok_cnt
test_error_cnt
