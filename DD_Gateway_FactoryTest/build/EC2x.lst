ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"EC2x.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.ec2x_io_init,"ax",%progbits
  20              		.align	1
  21              		.global	ec2x_io_init
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	ec2x_io_init:
  27              	.LVL0:
  28              	.LFB291:
  29              		.file 1 "FML/Src/EC2x.c"
   1:FML/Src/EC2x.c **** /**
   2:FML/Src/EC2x.c ****  ******************************************************************************
   3:FML/Src/EC2x.c **** *
   4:FML/Src/EC2x.c **** * @file   
   5:FML/Src/EC2x.c **** *
   6:FML/Src/EC2x.c **** * @brief   
   7:FML/Src/EC2x.c **** *
   8:FML/Src/EC2x.c **** * @attention
   9:FML/Src/EC2x.c **** *
  10:FML/Src/EC2x.c **** *Copyright (c) 2023 STMicroelectronics.
  11:FML/Src/EC2x.c **** *
  12:FML/Src/EC2x.c **** *All rights reserved.
  13:FML/Src/EC2x.c ****  ******************************************************************************
  14:FML/Src/EC2x.c **** */
  15:FML/Src/EC2x.c **** 
  16:FML/Src/EC2x.c **** 
  17:FML/Src/EC2x.c **** /*----------------------------------include-----------------------------------*/
  18:FML/Src/EC2x.c **** #include "EC2x.h"
  19:FML/Src/EC2x.c **** #include "usart.h"
  20:FML/Src/EC2x.c **** #include "timer.h"
  21:FML/Src/EC2x.c **** #include "shell_port.h"
  22:FML/Src/EC2x.c **** #include <stdio.h>
  23:FML/Src/EC2x.c **** #include <string.h>
  24:FML/Src/EC2x.c **** #include <stdlib.h>
  25:FML/Src/EC2x.c **** #include "fsm.h"
  26:FML/Src/EC2x.c **** #include "queue.h"
  27:FML/Src/EC2x.c **** /*-----------------------------------macro------------------------------------*/
  28:FML/Src/EC2x.c **** #define BUFF_LEN 200
  29:FML/Src/EC2x.c **** /*----------------------------------typedef-----------------------------------*/
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 2


  30:FML/Src/EC2x.c **** 
  31:FML/Src/EC2x.c **** 
  32:FML/Src/EC2x.c **** /*----------------------------------variable----------------------------------*/
  33:FML/Src/EC2x.c **** uint8_t ec2x_buff[BUFF_LEN]={0xff,};
  34:FML/Src/EC2x.c **** 
  35:FML/Src/EC2x.c **** //定义tcp连接字符串
  36:FML/Src/EC2x.c **** uint8_t tcp_connect[]="AT+QIOPEN=1,0,\"TCP\",\"115.236.153.170\",52894,0,2";
  37:FML/Src/EC2x.c **** 
  38:FML/Src/EC2x.c **** //定义tcp连接指令队列
  39:FML/Src/EC2x.c **** uint8_t tcpconnct_step = 0;
  40:FML/Src/EC2x.c **** ATMsg_TypeDef connectmsg_queue[] = {
  41:FML/Src/EC2x.c ****     {"AT\r\n","OK",500,5},
  42:FML/Src/EC2x.c ****     {"AT+CPIN?\r\n","READY",500,5},
  43:FML/Src/EC2x.c ****     {"AT+CREG?\r\n","+CREG: 0,1", 500, 2},
  44:FML/Src/EC2x.c ****     {"AT+CGREG?\r\n","+CGREG: 0,1", 500, 2},
  45:FML/Src/EC2x.c ****     {"AT+QICSGP=1,1,\"CMNET\",\"\",\"\",1\r\n","OK", 500, 3},
  46:FML/Src/EC2x.c ****     {"AT+QIDEACT=1\r\n", "OK", 40, 1},
  47:FML/Src/EC2x.c ****     {"AT+QIACT=1\r\n", "OK", 150, 1},
  48:FML/Src/EC2x.c ****     {tcp_connect, "+QIOPEN:", 150, 5},
  49:FML/Src/EC2x.c **** };
  50:FML/Src/EC2x.c **** 
  51:FML/Src/EC2x.c **** 
  52:FML/Src/EC2x.c **** /*----------------------------------typedef-----------------------------------*/
  53:FML/Src/EC2x.c **** 
  54:FML/Src/EC2x.c **** EC2x_HandleTypeDef ec2x_dev[]=
  55:FML/Src/EC2x.c **** {
  56:FML/Src/EC2x.c ****     {
  57:FML/Src/EC2x.c ****         "uart1/ec200s",
  58:FML/Src/EC2x.c ****         &huart1,
  59:FML/Src/EC2x.c ****         GPIOA,
  60:FML/Src/EC2x.c ****         GPIO_PIN_12,
  61:FML/Src/EC2x.c ****         GPIOA,
  62:FML/Src/EC2x.c ****         GPIO_PIN_8,
  63:FML/Src/EC2x.c ****         GPIOA,
  64:FML/Src/EC2x.c ****         GPIO_PIN_11,
  65:FML/Src/EC2x.c ****         {
  66:FML/Src/EC2x.c ****             0,
  67:FML/Src/EC2x.c ****            ec2x_buff,
  68:FML/Src/EC2x.c ****             0,
  69:FML/Src/EC2x.c ****             0,
  70:FML/Src/EC2x.c ****             0,
  71:FML/Src/EC2x.c ****             BUFF_LEN 
  72:FML/Src/EC2x.c ****         }
  73:FML/Src/EC2x.c ****     }
  74:FML/Src/EC2x.c **** };
  75:FML/Src/EC2x.c **** /*-------------------------------------os-------------------------------------*/
  76:FML/Src/EC2x.c **** 
  77:FML/Src/EC2x.c **** /*----------------------------------function----------------------------------*/
  78:FML/Src/EC2x.c **** 
  79:FML/Src/EC2x.c **** /**
  80:FML/Src/EC2x.c ****  * @brief 设备初始化函数
  81:FML/Src/EC2x.c ****  * 
  82:FML/Src/EC2x.c ****  */
  83:FML/Src/EC2x.c **** void ec2x_io_init(EC2x_HandleTypeDef *device)
  84:FML/Src/EC2x.c **** {
  30              		.loc 1 84 1 view -0
  31              		.cfi_startproc
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 3


  32              		@ args = 0, pretend = 0, frame = 24
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 84 1 is_stmt 0 view .LVU1
  35 0000 70B5     		push	{r4, r5, r6, lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 16
  38              		.cfi_offset 4, -16
  39              		.cfi_offset 5, -12
  40              		.cfi_offset 6, -8
  41              		.cfi_offset 14, -4
  42 0002 86B0     		sub	sp, sp, #24
  43              	.LCFI1:
  44              		.cfi_def_cfa_offset 40
  45 0004 0446     		mov	r4, r0
  85:FML/Src/EC2x.c ****      GPIO_InitTypeDef GPIO_InitStruct = {0};
  46              		.loc 1 85 6 is_stmt 1 view .LVU2
  47              		.loc 1 85 23 is_stmt 0 view .LVU3
  48 0006 0025     		movs	r5, #0
  49 0008 0195     		str	r5, [sp, #4]
  50 000a 0295     		str	r5, [sp, #8]
  51 000c 0395     		str	r5, [sp, #12]
  52 000e 0495     		str	r5, [sp, #16]
  53 0010 0595     		str	r5, [sp, #20]
  86:FML/Src/EC2x.c ****     
  87:FML/Src/EC2x.c ****     // 使能UART和GPIO时钟
  88:FML/Src/EC2x.c ****     //__HAL_RCC_UARTX_CLK_ENABLE(); // 替换为实际的UART时钟
  89:FML/Src/EC2x.c ****     __HAL_RCC_GPIOA_CLK_ENABLE(); // 替换为实际的GPIO时钟
  54              		.loc 1 89 5 is_stmt 1 view .LVU4
  55              	.LBB2:
  56              		.loc 1 89 5 view .LVU5
  57              		.loc 1 89 5 view .LVU6
  58 0012 1F4B     		ldr	r3, .L3
  59 0014 DA6C     		ldr	r2, [r3, #76]
  60 0016 42F00102 		orr	r2, r2, #1
  61 001a DA64     		str	r2, [r3, #76]
  62              		.loc 1 89 5 view .LVU7
  63 001c DB6C     		ldr	r3, [r3, #76]
  64 001e 03F00103 		and	r3, r3, #1
  65 0022 0093     		str	r3, [sp]
  66              		.loc 1 89 5 view .LVU8
  67 0024 009B     		ldr	r3, [sp]
  68              	.LBE2:
  69              		.loc 1 89 5 view .LVU9
  90:FML/Src/EC2x.c ****     
  91:FML/Src/EC2x.c ****     // 配置GPIO引脚
  92:FML/Src/EC2x.c ****     GPIO_InitStruct.Pin = device->reset_pin;
  70              		.loc 1 92 5 view .LVU10
  71              		.loc 1 92 33 is_stmt 0 view .LVU11
  72 0026 038C     		ldrh	r3, [r0, #32]
  73              		.loc 1 92 25 view .LVU12
  74 0028 0193     		str	r3, [sp, #4]
  93:FML/Src/EC2x.c ****     GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  75              		.loc 1 93 5 is_stmt 1 view .LVU13
  76              		.loc 1 93 26 is_stmt 0 view .LVU14
  77 002a 0126     		movs	r6, #1
  78 002c 0296     		str	r6, [sp, #8]
  94:FML/Src/EC2x.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 4


  79              		.loc 1 94 5 is_stmt 1 view .LVU15
  95:FML/Src/EC2x.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  80              		.loc 1 95 5 view .LVU16
  96:FML/Src/EC2x.c ****     HAL_GPIO_Init(device->reset_port, &GPIO_InitStruct);
  81              		.loc 1 96 5 view .LVU17
  82 002e 01A9     		add	r1, sp, #4
  83 0030 C069     		ldr	r0, [r0, #28]
  84              	.LVL1:
  85              		.loc 1 96 5 is_stmt 0 view .LVU18
  86 0032 FFF7FEFF 		bl	HAL_GPIO_Init
  87              	.LVL2:
  97:FML/Src/EC2x.c **** 
  98:FML/Src/EC2x.c ****     GPIO_InitStruct.Pin = device->wake_pin;
  88              		.loc 1 98 5 is_stmt 1 view .LVU19
  89              		.loc 1 98 33 is_stmt 0 view .LVU20
  90 0036 238D     		ldrh	r3, [r4, #40]
  91              		.loc 1 98 25 view .LVU21
  92 0038 0193     		str	r3, [sp, #4]
  99:FML/Src/EC2x.c ****     GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  93              		.loc 1 99 5 is_stmt 1 view .LVU22
  94              		.loc 1 99 26 is_stmt 0 view .LVU23
  95 003a 0296     		str	r6, [sp, #8]
 100:FML/Src/EC2x.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
  96              		.loc 1 100 5 is_stmt 1 view .LVU24
  97              		.loc 1 100 26 is_stmt 0 view .LVU25
  98 003c 0395     		str	r5, [sp, #12]
 101:FML/Src/EC2x.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  99              		.loc 1 101 5 is_stmt 1 view .LVU26
 100              		.loc 1 101 27 is_stmt 0 view .LVU27
 101 003e 0495     		str	r5, [sp, #16]
 102:FML/Src/EC2x.c ****     HAL_GPIO_Init(device->wake_port, &GPIO_InitStruct);
 102              		.loc 1 102 5 is_stmt 1 view .LVU28
 103 0040 01A9     		add	r1, sp, #4
 104 0042 606A     		ldr	r0, [r4, #36]
 105 0044 FFF7FEFF 		bl	HAL_GPIO_Init
 106              	.LVL3:
 103:FML/Src/EC2x.c **** 
 104:FML/Src/EC2x.c ****     GPIO_InitStruct.Pin = device->pwren_pin;
 107              		.loc 1 104 5 view .LVU29
 108              		.loc 1 104 33 is_stmt 0 view .LVU30
 109 0048 238B     		ldrh	r3, [r4, #24]
 110              		.loc 1 104 25 view .LVU31
 111 004a 0193     		str	r3, [sp, #4]
 105:FML/Src/EC2x.c ****     GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
 112              		.loc 1 105 5 is_stmt 1 view .LVU32
 113              		.loc 1 105 26 is_stmt 0 view .LVU33
 114 004c 0296     		str	r6, [sp, #8]
 106:FML/Src/EC2x.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 115              		.loc 1 106 5 is_stmt 1 view .LVU34
 116              		.loc 1 106 26 is_stmt 0 view .LVU35
 117 004e 0395     		str	r5, [sp, #12]
 107:FML/Src/EC2x.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
 118              		.loc 1 107 5 is_stmt 1 view .LVU36
 119              		.loc 1 107 27 is_stmt 0 view .LVU37
 120 0050 0495     		str	r5, [sp, #16]
 108:FML/Src/EC2x.c ****     HAL_GPIO_Init(device->pwren_port, &GPIO_InitStruct);
 121              		.loc 1 108 5 is_stmt 1 view .LVU38
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 5


 122 0052 01A9     		add	r1, sp, #4
 123 0054 6069     		ldr	r0, [r4, #20]
 124 0056 FFF7FEFF 		bl	HAL_GPIO_Init
 125              	.LVL4:
 109:FML/Src/EC2x.c ****     
 110:FML/Src/EC2x.c ****     
 111:FML/Src/EC2x.c ****     // 初始化复位引脚为高电平
 112:FML/Src/EC2x.c ****     HAL_GPIO_WritePin(device->reset_port, device->reset_pin, GPIO_PIN_SET);
 126              		.loc 1 112 5 view .LVU39
 127 005a 3246     		mov	r2, r6
 128 005c 218C     		ldrh	r1, [r4, #32]
 129 005e E069     		ldr	r0, [r4, #28]
 130 0060 FFF7FEFF 		bl	HAL_GPIO_WritePin
 131              	.LVL5:
 113:FML/Src/EC2x.c ****     HAL_GPIO_WritePin(device->wake_port, device->wake_pin, GPIO_PIN_SET);
 132              		.loc 1 113 5 view .LVU40
 133 0064 3246     		mov	r2, r6
 134 0066 218D     		ldrh	r1, [r4, #40]
 135 0068 606A     		ldr	r0, [r4, #36]
 136 006a FFF7FEFF 		bl	HAL_GPIO_WritePin
 137              	.LVL6:
 114:FML/Src/EC2x.c ****     HAL_GPIO_WritePin(device->pwren_port, device->pwren_pin, GPIO_PIN_SET);
 138              		.loc 1 114 5 view .LVU41
 139 006e 3246     		mov	r2, r6
 140 0070 218B     		ldrh	r1, [r4, #24]
 141 0072 6069     		ldr	r0, [r4, #20]
 142 0074 FFF7FEFF 		bl	HAL_GPIO_WritePin
 143              	.LVL7:
 115:FML/Src/EC2x.c ****     Delay_ms(1000);
 144              		.loc 1 115 5 view .LVU42
 145 0078 4FF47A70 		mov	r0, #1000
 146 007c FFF7FEFF 		bl	Delay_ms
 147              	.LVL8:
 116:FML/Src/EC2x.c ****     HAL_GPIO_WritePin(device->pwren_port, device->pwren_pin, GPIO_PIN_RESET);
 148              		.loc 1 116 5 view .LVU43
 149 0080 2A46     		mov	r2, r5
 150 0082 218B     		ldrh	r1, [r4, #24]
 151 0084 6069     		ldr	r0, [r4, #20]
 152 0086 FFF7FEFF 		bl	HAL_GPIO_WritePin
 153              	.LVL9:
 117:FML/Src/EC2x.c **** }
 154              		.loc 1 117 1 is_stmt 0 view .LVU44
 155 008a 06B0     		add	sp, sp, #24
 156              	.LCFI2:
 157              		.cfi_def_cfa_offset 16
 158              		@ sp needed
 159 008c 70BD     		pop	{r4, r5, r6, pc}
 160              	.LVL10:
 161              	.L4:
 162              		.loc 1 117 1 view .LVU45
 163 008e 00BF     		.align	2
 164              	.L3:
 165 0090 00100240 		.word	1073876992
 166              		.cfi_endproc
 167              	.LFE291:
 169              		.section	.text.ec2x_open,"ax",%progbits
 170              		.align	1
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 6


 171              		.global	ec2x_open
 172              		.syntax unified
 173              		.thumb
 174              		.thumb_func
 176              	ec2x_open:
 177              	.LVL11:
 178              	.LFB293:
 118:FML/Src/EC2x.c **** /**
 119:FML/Src/EC2x.c ****  * @brief 通过POWEREN引脚，对模块进行掉电复位
 120:FML/Src/EC2x.c ****  * 
 121:FML/Src/EC2x.c ****  * @param fd 
 122:FML/Src/EC2x.c ****  * @return int 
 123:FML/Src/EC2x.c ****  */
 124:FML/Src/EC2x.c **** int ec2x_reset(int fd){
 125:FML/Src/EC2x.c ****     fd = 0;
 126:FML/Src/EC2x.c ****     int err_code = 0;
 127:FML/Src/EC2x.c ****     if(fd >= sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef))
 128:FML/Src/EC2x.c ****         return (err_code = -1);
 129:FML/Src/EC2x.c ****     else{
 130:FML/Src/EC2x.c ****         EC2x_HandleTypeDef *device = &ec2x_dev[fd];
 131:FML/Src/EC2x.c ****         HAL_GPIO_WritePin(device->pwren_port, device->pwren_pin, GPIO_PIN_SET);
 132:FML/Src/EC2x.c ****         Delay_ms(500);
 133:FML/Src/EC2x.c ****         HAL_GPIO_WritePin(device->pwren_port, device->pwren_pin, GPIO_PIN_RESET);
 134:FML/Src/EC2x.c ****     }
 135:FML/Src/EC2x.c ****     return(ec2x_cmd_send(fd,NULL,0,"RDY/r/n",10000));
 136:FML/Src/EC2x.c **** }
 137:FML/Src/EC2x.c **** 
 138:FML/Src/EC2x.c **** /**
 139:FML/Src/EC2x.c ****  * @brief 设备文件open函数
 140:FML/Src/EC2x.c ****  * 
 141:FML/Src/EC2x.c ****  * @param dev_name 
 142:FML/Src/EC2x.c ****  * @return int 
 143:FML/Src/EC2x.c ****  *         返回设备文件索引，未查找到则返回-1
 144:FML/Src/EC2x.c ****  */
 145:FML/Src/EC2x.c **** int ec2x_open(char *dev_name)
 146:FML/Src/EC2x.c **** {
 179              		.loc 1 146 1 is_stmt 1 view -0
 180              		.cfi_startproc
 181              		@ args = 0, pretend = 0, frame = 0
 182              		@ frame_needed = 0, uses_anonymous_args = 0
 183              		.loc 1 146 1 is_stmt 0 view .LVU47
 184 0000 70B5     		push	{r4, r5, r6, lr}
 185              	.LCFI3:
 186              		.cfi_def_cfa_offset 16
 187              		.cfi_offset 4, -16
 188              		.cfi_offset 5, -12
 189              		.cfi_offset 6, -8
 190              		.cfi_offset 14, -4
 191 0002 0546     		mov	r5, r0
 147:FML/Src/EC2x.c ****     uint8_t i = 0;
 192              		.loc 1 147 5 is_stmt 1 view .LVU48
 193              	.LVL12:
 148:FML/Src/EC2x.c ****     for(i = 0;i < sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef);i++)
 194              		.loc 1 148 5 view .LVU49
 195              		.loc 1 148 11 is_stmt 0 view .LVU50
 196 0004 0024     		movs	r4, #0
 197              	.LVL13:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 7


 198              	.L6:
 199              		.loc 1 148 15 is_stmt 1 discriminator 1 view .LVU51
 200              		.loc 1 148 5 is_stmt 0 discriminator 1 view .LVU52
 201 0006 1CB1     		cbz	r4, .L9
 149:FML/Src/EC2x.c ****     {
 150:FML/Src/EC2x.c ****         if(strcmp(dev_name,ec2x_dev[i].dev_name) == 0)
 151:FML/Src/EC2x.c ****         {
 152:FML/Src/EC2x.c ****             ec2x_io_init(&ec2x_dev[i]);
 153:FML/Src/EC2x.c ****             return i;
 154:FML/Src/EC2x.c ****         }
 155:FML/Src/EC2x.c ****     }
 156:FML/Src/EC2x.c ****     return -1;
 202              		.loc 1 156 12 view .LVU53
 203 0008 4FF0FF36 		mov	r6, #-1
 204              	.L5:
 157:FML/Src/EC2x.c **** };
 205              		.loc 1 157 1 view .LVU54
 206 000c 3046     		mov	r0, r6
 207 000e 70BD     		pop	{r4, r5, r6, pc}
 208              	.LVL14:
 209              	.L9:
 150:FML/Src/EC2x.c ****         {
 210              		.loc 1 150 9 is_stmt 1 view .LVU55
 150:FML/Src/EC2x.c ****         {
 211              		.loc 1 150 39 is_stmt 0 view .LVU56
 212 0010 2646     		mov	r6, r4
 213 0012 C4EB0413 		rsb	r3, r4, r4, lsl #4
 150:FML/Src/EC2x.c ****         {
 214              		.loc 1 150 12 view .LVU57
 215 0016 0949     		ldr	r1, .L12
 216 0018 01EB8301 		add	r1, r1, r3, lsl #2
 217 001c 2846     		mov	r0, r5
 218 001e FFF7FEFF 		bl	strcmp
 219              	.LVL15:
 150:FML/Src/EC2x.c ****         {
 220              		.loc 1 150 11 view .LVU58
 221 0022 10B1     		cbz	r0, .L11
 148:FML/Src/EC2x.c ****     {
 222              		.loc 1 148 64 is_stmt 1 discriminator 2 view .LVU59
 148:FML/Src/EC2x.c ****     {
 223              		.loc 1 148 65 is_stmt 0 discriminator 2 view .LVU60
 224 0024 0134     		adds	r4, r4, #1
 225              	.LVL16:
 148:FML/Src/EC2x.c ****     {
 226              		.loc 1 148 65 discriminator 2 view .LVU61
 227 0026 E4B2     		uxtb	r4, r4
 228              	.LVL17:
 148:FML/Src/EC2x.c ****     {
 229              		.loc 1 148 65 discriminator 2 view .LVU62
 230 0028 EDE7     		b	.L6
 231              	.L11:
 152:FML/Src/EC2x.c ****             return i;
 232              		.loc 1 152 13 is_stmt 1 view .LVU63
 233 002a C4EB0413 		rsb	r3, r4, r4, lsl #4
 234 002e 0348     		ldr	r0, .L12
 235 0030 00EB8300 		add	r0, r0, r3, lsl #2
 236 0034 FFF7FEFF 		bl	ec2x_io_init
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 8


 237              	.LVL18:
 153:FML/Src/EC2x.c ****         }
 238              		.loc 1 153 13 view .LVU64
 153:FML/Src/EC2x.c ****         }
 239              		.loc 1 153 20 is_stmt 0 view .LVU65
 240 0038 E8E7     		b	.L5
 241              	.L13:
 242 003a 00BF     		.align	2
 243              	.L12:
 244 003c 00000000 		.word	.LANCHOR0
 245              		.cfi_endproc
 246              	.LFE293:
 248              		.section	.text.ec2x_write,"ax",%progbits
 249              		.align	1
 250              		.global	ec2x_write
 251              		.syntax unified
 252              		.thumb
 253              		.thumb_func
 255              	ec2x_write:
 256              	.LVL19:
 257              	.LFB294:
 158:FML/Src/EC2x.c **** 
 159:FML/Src/EC2x.c **** /**
 160:FML/Src/EC2x.c ****  * @brief 设备文件close函数
 161:FML/Src/EC2x.c ****  * 
 162:FML/Src/EC2x.c ****  * @param fd 
 163:FML/Src/EC2x.c ****  * @return int 
 164:FML/Src/EC2x.c ****  */
 165:FML/Src/EC2x.c **** int ec2x_close(int fd);
 166:FML/Src/EC2x.c **** 
 167:FML/Src/EC2x.c **** /**
 168:FML/Src/EC2x.c ****  * @brief 设备文件写入函数
 169:FML/Src/EC2x.c ****  * 
 170:FML/Src/EC2x.c ****  * @param fd 
 171:FML/Src/EC2x.c ****  * @param tx_buff 
 172:FML/Src/EC2x.c ****  * @param len 
 173:FML/Src/EC2x.c ****  * @return int 
 174:FML/Src/EC2x.c ****  *         设备号无效返回-1
 175:FML/Src/EC2x.c ****  *         写入失败返回 0
 176:FML/Src/EC2x.c ****  *          写入成功返回1
 177:FML/Src/EC2x.c ****  *         
 178:FML/Src/EC2x.c ****  */
 179:FML/Src/EC2x.c **** int ec2x_write(int fd,uint8_t *tx_buff,uint16_t len){
 258              		.loc 1 179 53 is_stmt 1 view -0
 259              		.cfi_startproc
 260              		@ args = 0, pretend = 0, frame = 0
 261              		@ frame_needed = 0, uses_anonymous_args = 0
 180:FML/Src/EC2x.c ****     int err_code = 0;
 262              		.loc 1 180 5 view .LVU67
 181:FML/Src/EC2x.c ****     if(fd >= sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef))
 263              		.loc 1 181 5 view .LVU68
 264              		.loc 1 181 7 is_stmt 0 view .LVU69
 265 0000 10B1     		cbz	r0, .L22
 182:FML/Src/EC2x.c ****         return (err_code = -1);
 266              		.loc 1 182 26 view .LVU70
 267 0002 4FF0FF30 		mov	r0, #-1
 268              	.LVL20:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 9


 183:FML/Src/EC2x.c ****     else{
 184:FML/Src/EC2x.c ****         err_code =  HAL_UART_Transmit_IT(ec2x_dev[fd].huart, tx_buff,len);
 185:FML/Src/EC2x.c ****         while(__HAL_UART_GET_FLAG(ec2x_dev[fd].huart,UART_FLAG_TC) != SET);
 186:FML/Src/EC2x.c ****         return(!err_code);
 187:FML/Src/EC2x.c ****     }
 188:FML/Src/EC2x.c **** };
 269              		.loc 1 188 1 view .LVU71
 270 0006 7047     		bx	lr
 271              	.LVL21:
 272              	.L22:
 179:FML/Src/EC2x.c ****     int err_code = 0;
 273              		.loc 1 179 53 view .LVU72
 274 0008 10B5     		push	{r4, lr}
 275              	.LCFI4:
 276              		.cfi_def_cfa_offset 8
 277              		.cfi_offset 4, -8
 278              		.cfi_offset 14, -4
 279 000a 0446     		mov	r4, r0
 184:FML/Src/EC2x.c ****         while(__HAL_UART_GET_FLAG(ec2x_dev[fd].huart,UART_FLAG_TC) != SET);
 280              		.loc 1 184 9 is_stmt 1 view .LVU73
 184:FML/Src/EC2x.c ****         while(__HAL_UART_GET_FLAG(ec2x_dev[fd].huart,UART_FLAG_TC) != SET);
 281              		.loc 1 184 21 is_stmt 0 view .LVU74
 282 000c C0EB0013 		rsb	r3, r0, r0, lsl #4
 283 0010 0A48     		ldr	r0, .L23
 284              	.LVL22:
 184:FML/Src/EC2x.c ****         while(__HAL_UART_GET_FLAG(ec2x_dev[fd].huart,UART_FLAG_TC) != SET);
 285              		.loc 1 184 21 view .LVU75
 286 0012 00EB8303 		add	r3, r0, r3, lsl #2
 287 0016 1869     		ldr	r0, [r3, #16]
 288 0018 FFF7FEFF 		bl	HAL_UART_Transmit_IT
 289              	.LVL23:
 185:FML/Src/EC2x.c ****         return(!err_code);
 290              		.loc 1 185 9 is_stmt 1 view .LVU76
 291              	.L16:
 185:FML/Src/EC2x.c ****         return(!err_code);
 292              		.loc 1 185 75 discriminator 1 view .LVU77
 185:FML/Src/EC2x.c ****         return(!err_code);
 293              		.loc 1 185 14 discriminator 1 view .LVU78
 185:FML/Src/EC2x.c ****         return(!err_code);
 294              		.loc 1 185 15 is_stmt 0 discriminator 1 view .LVU79
 295 001c C4EB0413 		rsb	r3, r4, r4, lsl #4
 296 0020 064A     		ldr	r2, .L23
 297 0022 02EB8303 		add	r3, r2, r3, lsl #2
 298 0026 1B69     		ldr	r3, [r3, #16]
 299 0028 1B68     		ldr	r3, [r3]
 300 002a DB69     		ldr	r3, [r3, #28]
 185:FML/Src/EC2x.c ****         return(!err_code);
 301              		.loc 1 185 14 discriminator 1 view .LVU80
 302 002c 13F0400F 		tst	r3, #64
 303 0030 F4D0     		beq	.L16
 186:FML/Src/EC2x.c ****     }
 304              		.loc 1 186 9 is_stmt 1 view .LVU81
 186:FML/Src/EC2x.c ****     }
 305              		.loc 1 186 16 is_stmt 0 view .LVU82
 306 0032 B0FA80F0 		clz	r0, r0
 307              	.LVL24:
 186:FML/Src/EC2x.c ****     }
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 10


 308              		.loc 1 186 16 view .LVU83
 309 0036 4009     		lsrs	r0, r0, #5
 310              		.loc 1 188 1 view .LVU84
 311 0038 10BD     		pop	{r4, pc}
 312              	.LVL25:
 313              	.L24:
 314              		.loc 1 188 1 view .LVU85
 315 003a 00BF     		.align	2
 316              	.L23:
 317 003c 00000000 		.word	.LANCHOR0
 318              		.cfi_endproc
 319              	.LFE294:
 321              		.section	.text.ec2x_read,"ax",%progbits
 322              		.align	1
 323              		.global	ec2x_read
 324              		.syntax unified
 325              		.thumb
 326              		.thumb_func
 328              	ec2x_read:
 329              	.LVL26:
 330              	.LFB295:
 189:FML/Src/EC2x.c **** /**
 190:FML/Src/EC2x.c ****  * @brief 设备文件读取函数
 191:FML/Src/EC2x.c ****  *        读取环形缓冲区指定长度数据
 192:FML/Src/EC2x.c ****  * 
 193:FML/Src/EC2x.c ****  * @param fd 
 194:FML/Src/EC2x.c ****  * @param rx_buff 
 195:FML/Src/EC2x.c ****  * @param len 
 196:FML/Src/EC2x.c ****  * @return int 
 197:FML/Src/EC2x.c ****  *         -1 接口错误
 198:FML/Src/EC2x.c ****  *          0 读取失败
 199:FML/Src/EC2x.c ****  *          n 读取成功字节数
 200:FML/Src/EC2x.c ****  */
 201:FML/Src/EC2x.c **** int ec2x_read(int fd,uint8_t *rx_buff,uint16_t len){
 331              		.loc 1 201 52 is_stmt 1 view -0
 332              		.cfi_startproc
 333              		@ args = 0, pretend = 0, frame = 0
 334              		@ frame_needed = 0, uses_anonymous_args = 0
 202:FML/Src/EC2x.c ****     uint8_t *dest = rx_buff;
 335              		.loc 1 202 5 view .LVU87
 203:FML/Src/EC2x.c ****     if(fd >= sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef))
 336              		.loc 1 203 5 view .LVU88
 337              		.loc 1 203 7 is_stmt 0 view .LVU89
 338 0000 0028     		cmp	r0, #0
 339 0002 4BD1     		bne	.L32
 201:FML/Src/EC2x.c ****     uint8_t *dest = rx_buff;
 340              		.loc 1 201 52 view .LVU90
 341 0004 38B5     		push	{r3, r4, r5, lr}
 342              	.LCFI5:
 343              		.cfi_def_cfa_offset 16
 344              		.cfi_offset 3, -16
 345              		.cfi_offset 4, -12
 346              		.cfi_offset 5, -8
 347              		.cfi_offset 14, -4
 348 0006 1546     		mov	r5, r2
 349 0008 0446     		mov	r4, r0
 350              	.LBB3:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 11


 204:FML/Src/EC2x.c ****         return -1;
 205:FML/Src/EC2x.c ****     else{
 206:FML/Src/EC2x.c ****         uint16_t j = 0;
 351              		.loc 1 206 9 is_stmt 1 view .LVU91
 352              	.LVL27:
 207:FML/Src/EC2x.c ****         
 208:FML/Src/EC2x.c ****         RingBuffer_TypeDef *src = &ec2x_dev[fd].msg;
 353              		.loc 1 208 9 view .LVU92
 209:FML/Src/EC2x.c ****         //如果队列被上锁了，则等待100ms
 210:FML/Src/EC2x.c ****         if(src->block == 1)
 354              		.loc 1 210 9 view .LVU93
 355              		.loc 1 210 15 is_stmt 0 view .LVU94
 356 000a C0EB0013 		rsb	r3, r0, r0, lsl #4
 357 000e 264A     		ldr	r2, .L39
 358              	.LVL28:
 359              		.loc 1 210 15 view .LVU95
 360 0010 02EB8303 		add	r3, r2, r3, lsl #2
 361 0014 93F82C30 		ldrb	r3, [r3, #44]	@ zero_extendqisi2
 362              		.loc 1 210 11 view .LVU96
 363 0018 73B9     		cbnz	r3, .L38
 211:FML/Src/EC2x.c ****         {
 212:FML/Src/EC2x.c ****             Delay_ms(100);
 213:FML/Src/EC2x.c ****             if(src->block == 1)
 214:FML/Src/EC2x.c ****                 return 0;
 215:FML/Src/EC2x.c ****         }
 216:FML/Src/EC2x.c ****         else{
 217:FML/Src/EC2x.c ****             src->block = 1;
 364              		.loc 1 217 13 is_stmt 1 view .LVU97
 365              		.loc 1 217 24 is_stmt 0 view .LVU98
 366 001a C0EB0013 		rsb	r3, r0, r0, lsl #4
 367 001e 224A     		ldr	r2, .L39
 368 0020 02EB8303 		add	r3, r2, r3, lsl #2
 369 0024 0122     		movs	r2, #1
 370 0026 83F82C20 		strb	r2, [r3, #44]
 218:FML/Src/EC2x.c ****             if(len > src->size)
 371              		.loc 1 218 13 is_stmt 1 view .LVU99
 372              		.loc 1 218 25 is_stmt 0 view .LVU100
 373 002a 188F     		ldrh	r0, [r3, #56]
 374              	.LVL29:
 375              		.loc 1 218 15 view .LVU101
 376 002c A842     		cmp	r0, r5
 377 002e 00D3     		bcc	.L29
 378 0030 2846     		mov	r0, r5
 379              	.L29:
 380              	.LVL30:
 219:FML/Src/EC2x.c ****                 len = src->size;
 220:FML/Src/EC2x.c ****             for(j = 0 ; j < len; j++){
 381              		.loc 1 220 13 is_stmt 1 view .LVU102
 382              		.loc 1 220 19 is_stmt 0 view .LVU103
 383 0032 4FF0000C 		mov	ip, #0
 384              		.loc 1 220 13 view .LVU104
 385 0036 26E0     		b	.L30
 386              	.LVL31:
 387              	.L38:
 212:FML/Src/EC2x.c ****             if(src->block == 1)
 388              		.loc 1 212 13 is_stmt 1 view .LVU105
 389 0038 6420     		movs	r0, #100
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 12


 390              	.LVL32:
 212:FML/Src/EC2x.c ****             if(src->block == 1)
 391              		.loc 1 212 13 is_stmt 0 view .LVU106
 392 003a FFF7FEFF 		bl	Delay_ms
 393              	.LVL33:
 213:FML/Src/EC2x.c ****                 return 0;
 394              		.loc 1 213 13 is_stmt 1 view .LVU107
 213:FML/Src/EC2x.c ****                 return 0;
 395              		.loc 1 213 19 is_stmt 0 view .LVU108
 396 003e C4EB0413 		rsb	r3, r4, r4, lsl #4
 397 0042 194A     		ldr	r2, .L39
 398 0044 02EB8303 		add	r3, r2, r3, lsl #2
 399 0048 93F82C30 		ldrb	r3, [r3, #44]	@ zero_extendqisi2
 213:FML/Src/EC2x.c ****                 return 0;
 400              		.loc 1 213 15 view .LVU109
 401 004c 4BBB     		cbnz	r3, .L33
 402 004e 2846     		mov	r0, r5
 403 0050 23E0     		b	.L25
 404              	.LVL34:
 405              	.L31:
 221:FML/Src/EC2x.c ****                 dest[j] = src->data[src->head];
 406              		.loc 1 221 17 is_stmt 1 discriminator 3 view .LVU110
 407              		.loc 1 221 30 is_stmt 0 discriminator 3 view .LVU111
 408 0052 C4EB0413 		rsb	r3, r4, r4, lsl #4
 409 0056 144A     		ldr	r2, .L39
 410 0058 02EB8303 		add	r3, r2, r3, lsl #2
 411 005c 1D6B     		ldr	r5, [r3, #48]
 412              		.loc 1 221 40 discriminator 3 view .LVU112
 413 005e 9A8E     		ldrh	r2, [r3, #52]
 414              		.loc 1 221 36 discriminator 3 view .LVU113
 415 0060 AA5C     		ldrb	r2, [r5, r2]	@ zero_extendqisi2
 416              		.loc 1 221 25 discriminator 3 view .LVU114
 417 0062 01F80C20 		strb	r2, [r1, ip]
 222:FML/Src/EC2x.c ****                 src->head = (src->head + 1) % src->capacity;
 418              		.loc 1 222 17 is_stmt 1 discriminator 3 view .LVU115
 419              		.loc 1 222 33 is_stmt 0 discriminator 3 view .LVU116
 420 0066 9A8E     		ldrh	r2, [r3, #52]
 421              		.loc 1 222 40 discriminator 3 view .LVU117
 422 0068 0132     		adds	r2, r2, #1
 423              		.loc 1 222 50 discriminator 3 view .LVU118
 424 006a B3F83AE0 		ldrh	lr, [r3, #58]
 425              		.loc 1 222 45 discriminator 3 view .LVU119
 426 006e 92FBFEF5 		sdiv	r5, r2, lr
 427 0072 0EFB1522 		mls	r2, lr, r5, r2
 428              		.loc 1 222 27 discriminator 3 view .LVU120
 429 0076 9A86     		strh	r2, [r3, #52]	@ movhi
 223:FML/Src/EC2x.c ****                 src->size--;
 430              		.loc 1 223 17 is_stmt 1 discriminator 3 view .LVU121
 431              		.loc 1 223 20 is_stmt 0 discriminator 3 view .LVU122
 432 0078 1A8F     		ldrh	r2, [r3, #56]
 433              		.loc 1 223 26 discriminator 3 view .LVU123
 434 007a 013A     		subs	r2, r2, #1
 435 007c 1A87     		strh	r2, [r3, #56]	@ movhi
 220:FML/Src/EC2x.c ****                 dest[j] = src->data[src->head];
 436              		.loc 1 220 34 is_stmt 1 discriminator 3 view .LVU124
 220:FML/Src/EC2x.c ****                 dest[j] = src->data[src->head];
 437              		.loc 1 220 35 is_stmt 0 discriminator 3 view .LVU125
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 13


 438 007e 0CF1010C 		add	ip, ip, #1
 439              	.LVL35:
 220:FML/Src/EC2x.c ****                 dest[j] = src->data[src->head];
 440              		.loc 1 220 35 discriminator 3 view .LVU126
 441 0082 1FFA8CFC 		uxth	ip, ip
 442              	.LVL36:
 443              	.L30:
 220:FML/Src/EC2x.c ****                 dest[j] = src->data[src->head];
 444              		.loc 1 220 25 is_stmt 1 discriminator 1 view .LVU127
 220:FML/Src/EC2x.c ****                 dest[j] = src->data[src->head];
 445              		.loc 1 220 13 is_stmt 0 discriminator 1 view .LVU128
 446 0086 6045     		cmp	r0, ip
 447 0088 E3D8     		bhi	.L31
 224:FML/Src/EC2x.c ****             }
 225:FML/Src/EC2x.c ****             src->block = 0;
 448              		.loc 1 225 13 is_stmt 1 view .LVU129
 449              		.loc 1 225 24 is_stmt 0 view .LVU130
 450 008a C4EB0414 		rsb	r4, r4, r4, lsl #4
 451              	.LVL37:
 452              		.loc 1 225 24 view .LVU131
 453 008e 064B     		ldr	r3, .L39
 454 0090 03EB8404 		add	r4, r3, r4, lsl #2
 455 0094 0023     		movs	r3, #0
 456 0096 84F82C30 		strb	r3, [r4, #44]
 226:FML/Src/EC2x.c ****         }
 227:FML/Src/EC2x.c ****         return len;
 457              		.loc 1 227 9 is_stmt 1 view .LVU132
 458              	.LVL38:
 459              	.L25:
 460              		.loc 1 227 9 is_stmt 0 view .LVU133
 461              	.LBE3:
 228:FML/Src/EC2x.c ****     }
 229:FML/Src/EC2x.c **** };
 462              		.loc 1 229 1 view .LVU134
 463 009a 38BD     		pop	{r3, r4, r5, pc}
 464              	.LVL39:
 465              	.L32:
 466              	.LCFI6:
 467              		.cfi_def_cfa_offset 0
 468              		.cfi_restore 3
 469              		.cfi_restore 4
 470              		.cfi_restore 5
 471              		.cfi_restore 14
 204:FML/Src/EC2x.c ****     else{
 472              		.loc 1 204 16 view .LVU135
 473 009c 4FF0FF30 		mov	r0, #-1
 474              	.LVL40:
 475              		.loc 1 229 1 view .LVU136
 476 00a0 7047     		bx	lr
 477              	.LVL41:
 478              	.L33:
 479              	.LCFI7:
 480              		.cfi_def_cfa_offset 16
 481              		.cfi_offset 3, -16
 482              		.cfi_offset 4, -12
 483              		.cfi_offset 5, -8
 484              		.cfi_offset 14, -4
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 14


 485              	.LBB4:
 214:FML/Src/EC2x.c ****         }
 486              		.loc 1 214 24 view .LVU137
 487 00a2 2046     		mov	r0, r4
 488 00a4 F9E7     		b	.L25
 489              	.L40:
 490 00a6 00BF     		.align	2
 491              	.L39:
 492 00a8 00000000 		.word	.LANCHOR0
 493              	.LBE4:
 494              		.cfi_endproc
 495              	.LFE295:
 497              		.section	.rodata.ec2x_handler.str1.4,"aMS",%progbits,1
 498              		.align	2
 499              	.LC0:
 500 0000 257300   		.ascii	"%s\000"
 501              		.section	.text.ec2x_handler,"ax",%progbits
 502              		.align	1
 503              		.global	ec2x_handler
 504              		.syntax unified
 505              		.thumb
 506              		.thumb_func
 508              	ec2x_handler:
 509              	.LVL42:
 510              	.LFB296:
 230:FML/Src/EC2x.c **** int ec2x_ioctl(int fd);
 231:FML/Src/EC2x.c **** 
 232:FML/Src/EC2x.c **** /**
 233:FML/Src/EC2x.c ****  * @brief 将串口接收数据copy到环形缓冲区，并更新缓冲区状态
 234:FML/Src/EC2x.c ****  * 
 235:FML/Src/EC2x.c ****  * @param huart 
 236:FML/Src/EC2x.c ****  * @param data 
 237:FML/Src/EC2x.c ****  * @param len 
 238:FML/Src/EC2x.c ****  */
 239:FML/Src/EC2x.c **** void ec2x_handler(UART_HandleTypeDef *huart,uint8_t *data,uint16_t len)
 240:FML/Src/EC2x.c **** {
 511              		.loc 1 240 1 is_stmt 1 view -0
 512              		.cfi_startproc
 513              		@ args = 0, pretend = 0, frame = 0
 514              		@ frame_needed = 0, uses_anonymous_args = 0
 515              		.loc 1 240 1 is_stmt 0 view .LVU139
 516 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 517              	.LCFI8:
 518              		.cfi_def_cfa_offset 24
 519              		.cfi_offset 3, -24
 520              		.cfi_offset 4, -20
 521              		.cfi_offset 5, -16
 522              		.cfi_offset 6, -12
 523              		.cfi_offset 7, -8
 524              		.cfi_offset 14, -4
 525 0002 0546     		mov	r5, r0
 526 0004 0C46     		mov	r4, r1
 527 0006 1646     		mov	r6, r2
 241:FML/Src/EC2x.c ****     uint8_t i = 0,j = 0;
 528              		.loc 1 241 5 is_stmt 1 view .LVU140
 529              	.LVL43:
 242:FML/Src/EC2x.c ****     shellPrint(&shell,"%s",data);
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 15


 530              		.loc 1 242 5 view .LVU141
 531 0008 0A46     		mov	r2, r1
 532              	.LVL44:
 533              		.loc 1 242 5 is_stmt 0 view .LVU142
 534 000a 3549     		ldr	r1, .L51
 535              	.LVL45:
 536              		.loc 1 242 5 view .LVU143
 537 000c 3548     		ldr	r0, .L51+4
 538              	.LVL46:
 539              		.loc 1 242 5 view .LVU144
 540 000e FFF7FEFF 		bl	shellPrint
 541              	.LVL47:
 243:FML/Src/EC2x.c ****     for(i = 0;i < sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef);i++)
 542              		.loc 1 243 5 is_stmt 1 view .LVU145
 543              		.loc 1 243 11 is_stmt 0 view .LVU146
 544 0012 0023     		movs	r3, #0
 545              	.LVL48:
 546              	.L42:
 547              		.loc 1 243 15 is_stmt 1 discriminator 1 view .LVU147
 548              		.loc 1 243 5 is_stmt 0 discriminator 1 view .LVU148
 549 0014 03B1     		cbz	r3, .L47
 244:FML/Src/EC2x.c ****     {
 245:FML/Src/EC2x.c ****         if(huart == ec2x_dev[i].huart)
 246:FML/Src/EC2x.c ****         {
 247:FML/Src/EC2x.c ****             RingBuffer_TypeDef *dest = &ec2x_dev[i].msg;
 248:FML/Src/EC2x.c ****             if(dest->block  == 0){
 249:FML/Src/EC2x.c ****                 dest->block = 1;
 250:FML/Src/EC2x.c ****                 for(j = 0 ; j < len; j++){
 251:FML/Src/EC2x.c ****                    
 252:FML/Src/EC2x.c ****                     dest->data[dest->tail] = data[j];
 253:FML/Src/EC2x.c ****                     dest->tail = (dest->tail +1) % dest->capacity;
 254:FML/Src/EC2x.c ****                     dest->size++;
 255:FML/Src/EC2x.c ****                     dest->size = dest->size > dest->capacity ? dest->capacity : dest->size;
 256:FML/Src/EC2x.c ****                 }
 257:FML/Src/EC2x.c ****                 if((dest->tail > dest->head)&&(dest->size == dest->capacity))
 258:FML/Src/EC2x.c ****                     dest->head = dest->tail;
 259:FML/Src/EC2x.c ****                 dest->block = 0;
 260:FML/Src/EC2x.c ****             }
 261:FML/Src/EC2x.c ****         }
 262:FML/Src/EC2x.c ****     }
 263:FML/Src/EC2x.c **** }
 550              		.loc 1 263 1 view .LVU149
 551 0016 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 552              	.LVL49:
 553              	.L47:
 245:FML/Src/EC2x.c ****         {
 554              		.loc 1 245 9 is_stmt 1 view .LVU150
 245:FML/Src/EC2x.c ****         {
 555              		.loc 1 245 32 is_stmt 0 view .LVU151
 556 0018 9E46     		mov	lr, r3
 557 001a C3EB0312 		rsb	r2, r3, r3, lsl #4
 558 001e 3249     		ldr	r1, .L51+8
 559 0020 01EB8202 		add	r2, r1, r2, lsl #2
 560 0024 1269     		ldr	r2, [r2, #16]
 245:FML/Src/EC2x.c ****         {
 561              		.loc 1 245 11 view .LVU152
 562 0026 AA42     		cmp	r2, r5
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 16


 563 0028 02D0     		beq	.L49
 564              	.L43:
 243:FML/Src/EC2x.c ****     for(i = 0;i < sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef);i++)
 565              		.loc 1 243 64 is_stmt 1 discriminator 2 view .LVU153
 243:FML/Src/EC2x.c ****     for(i = 0;i < sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef);i++)
 566              		.loc 1 243 65 is_stmt 0 discriminator 2 view .LVU154
 567 002a 0133     		adds	r3, r3, #1
 568              	.LVL50:
 243:FML/Src/EC2x.c ****     for(i = 0;i < sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef);i++)
 569              		.loc 1 243 65 discriminator 2 view .LVU155
 570 002c DBB2     		uxtb	r3, r3
 571              	.LVL51:
 243:FML/Src/EC2x.c ****     for(i = 0;i < sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef);i++)
 572              		.loc 1 243 65 discriminator 2 view .LVU156
 573 002e F1E7     		b	.L42
 574              	.L49:
 575              	.LBB5:
 247:FML/Src/EC2x.c ****             if(dest->block  == 0){
 576              		.loc 1 247 13 is_stmt 1 view .LVU157
 577              	.LVL52:
 248:FML/Src/EC2x.c ****                 dest->block = 1;
 578              		.loc 1 248 13 view .LVU158
 248:FML/Src/EC2x.c ****                 dest->block = 1;
 579              		.loc 1 248 20 is_stmt 0 view .LVU159
 580 0030 C3EB0312 		rsb	r2, r3, r3, lsl #4
 581 0034 01EB8202 		add	r2, r1, r2, lsl #2
 582 0038 92F82C20 		ldrb	r2, [r2, #44]	@ zero_extendqisi2
 248:FML/Src/EC2x.c ****                 dest->block = 1;
 583              		.loc 1 248 15 view .LVU160
 584 003c 002A     		cmp	r2, #0
 585 003e F4D1     		bne	.L43
 249:FML/Src/EC2x.c ****                 for(j = 0 ; j < len; j++){
 586              		.loc 1 249 17 is_stmt 1 view .LVU161
 249:FML/Src/EC2x.c ****                 for(j = 0 ; j < len; j++){
 587              		.loc 1 249 29 is_stmt 0 view .LVU162
 588 0040 C3EB0312 		rsb	r2, r3, r3, lsl #4
 589 0044 01EB8202 		add	r2, r1, r2, lsl #2
 590 0048 0121     		movs	r1, #1
 591 004a 82F82C10 		strb	r1, [r2, #44]
 250:FML/Src/EC2x.c ****                    
 592              		.loc 1 250 17 is_stmt 1 view .LVU163
 593              	.LVL53:
 250:FML/Src/EC2x.c ****                    
 594              		.loc 1 250 23 is_stmt 0 view .LVU164
 595 004e 1846     		mov	r0, r3
 250:FML/Src/EC2x.c ****                    
 596              		.loc 1 250 17 view .LVU165
 597 0050 22E0     		b	.L44
 598              	.LVL54:
 599              	.L45:
 252:FML/Src/EC2x.c ****                     dest->tail = (dest->tail +1) % dest->capacity;
 600              		.loc 1 252 21 is_stmt 1 discriminator 3 view .LVU166
 252:FML/Src/EC2x.c ****                     dest->tail = (dest->tail +1) % dest->capacity;
 601              		.loc 1 252 25 is_stmt 0 discriminator 3 view .LVU167
 602 0052 CEEB0E1C 		rsb	ip, lr, lr, lsl #4
 603 0056 244A     		ldr	r2, .L51+8
 604 0058 02EB8C0C 		add	ip, r2, ip, lsl #2
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 17


 605 005c DCF83020 		ldr	r2, [ip, #48]
 252:FML/Src/EC2x.c ****                     dest->tail = (dest->tail +1) % dest->capacity;
 606              		.loc 1 252 36 discriminator 3 view .LVU168
 607 0060 BCF83610 		ldrh	r1, [ip, #54]
 252:FML/Src/EC2x.c ****                     dest->tail = (dest->tail +1) % dest->capacity;
 608              		.loc 1 252 50 discriminator 3 view .LVU169
 609 0064 275C     		ldrb	r7, [r4, r0]	@ zero_extendqisi2
 252:FML/Src/EC2x.c ****                     dest->tail = (dest->tail +1) % dest->capacity;
 610              		.loc 1 252 44 discriminator 3 view .LVU170
 611 0066 5754     		strb	r7, [r2, r1]
 253:FML/Src/EC2x.c ****                     dest->size++;
 612              		.loc 1 253 21 is_stmt 1 discriminator 3 view .LVU171
 253:FML/Src/EC2x.c ****                     dest->size++;
 613              		.loc 1 253 39 is_stmt 0 discriminator 3 view .LVU172
 614 0068 BCF83620 		ldrh	r2, [ip, #54]
 253:FML/Src/EC2x.c ****                     dest->size++;
 615              		.loc 1 253 46 discriminator 3 view .LVU173
 616 006c 0132     		adds	r2, r2, #1
 253:FML/Src/EC2x.c ****                     dest->size++;
 617              		.loc 1 253 56 discriminator 3 view .LVU174
 618 006e BCF83A70 		ldrh	r7, [ip, #58]
 253:FML/Src/EC2x.c ****                     dest->size++;
 619              		.loc 1 253 50 discriminator 3 view .LVU175
 620 0072 92FBF7F1 		sdiv	r1, r2, r7
 621 0076 07FB1122 		mls	r2, r7, r1, r2
 253:FML/Src/EC2x.c ****                     dest->size++;
 622              		.loc 1 253 32 discriminator 3 view .LVU176
 623 007a ACF83620 		strh	r2, [ip, #54]	@ movhi
 254:FML/Src/EC2x.c ****                     dest->size = dest->size > dest->capacity ? dest->capacity : dest->size;
 624              		.loc 1 254 21 is_stmt 1 discriminator 3 view .LVU177
 254:FML/Src/EC2x.c ****                     dest->size = dest->size > dest->capacity ? dest->capacity : dest->size;
 625              		.loc 1 254 25 is_stmt 0 discriminator 3 view .LVU178
 626 007e BCF83810 		ldrh	r1, [ip, #56]
 254:FML/Src/EC2x.c ****                     dest->size = dest->size > dest->capacity ? dest->capacity : dest->size;
 627              		.loc 1 254 31 discriminator 3 view .LVU179
 628 0082 0131     		adds	r1, r1, #1
 629 0084 89B2     		uxth	r1, r1
 630 0086 ACF83810 		strh	r1, [ip, #56]	@ movhi
 255:FML/Src/EC2x.c ****                 }
 631              		.loc 1 255 21 is_stmt 1 discriminator 3 view .LVU180
 255:FML/Src/EC2x.c ****                 }
 632              		.loc 1 255 79 is_stmt 0 discriminator 3 view .LVU181
 633 008a B942     		cmp	r1, r7
 634 008c 28BF     		it	cs
 635 008e 3946     		movcs	r1, r7
 255:FML/Src/EC2x.c ****                 }
 636              		.loc 1 255 32 discriminator 3 view .LVU182
 637 0090 ACF83810 		strh	r1, [ip, #56]	@ movhi
 250:FML/Src/EC2x.c ****                    
 638              		.loc 1 250 38 is_stmt 1 discriminator 3 view .LVU183
 250:FML/Src/EC2x.c ****                    
 639              		.loc 1 250 39 is_stmt 0 discriminator 3 view .LVU184
 640 0094 0130     		adds	r0, r0, #1
 641              	.LVL55:
 250:FML/Src/EC2x.c ****                    
 642              		.loc 1 250 39 discriminator 3 view .LVU185
 643 0096 C0B2     		uxtb	r0, r0
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 18


 644              	.LVL56:
 645              	.L44:
 250:FML/Src/EC2x.c ****                    
 646              		.loc 1 250 29 is_stmt 1 discriminator 1 view .LVU186
 250:FML/Src/EC2x.c ****                    
 647              		.loc 1 250 31 is_stmt 0 discriminator 1 view .LVU187
 648 0098 82B2     		uxth	r2, r0
 250:FML/Src/EC2x.c ****                    
 649              		.loc 1 250 17 discriminator 1 view .LVU188
 650 009a B242     		cmp	r2, r6
 651 009c D9D3     		bcc	.L45
 257:FML/Src/EC2x.c ****                     dest->head = dest->tail;
 652              		.loc 1 257 17 is_stmt 1 view .LVU189
 257:FML/Src/EC2x.c ****                     dest->head = dest->tail;
 653              		.loc 1 257 25 is_stmt 0 view .LVU190
 654 009e CEEB0E12 		rsb	r2, lr, lr, lsl #4
 655 00a2 1149     		ldr	r1, .L51+8
 656 00a4 01EB8202 		add	r2, r1, r2, lsl #2
 657 00a8 D08E     		ldrh	r0, [r2, #54]
 658              	.LVL57:
 257:FML/Src/EC2x.c ****                     dest->head = dest->tail;
 659              		.loc 1 257 38 view .LVU191
 660 00aa 928E     		ldrh	r2, [r2, #52]
 257:FML/Src/EC2x.c ****                     dest->head = dest->tail;
 661              		.loc 1 257 19 view .LVU192
 662 00ac 9042     		cmp	r0, r2
 663 00ae 07D9     		bls	.L46
 257:FML/Src/EC2x.c ****                     dest->head = dest->tail;
 664              		.loc 1 257 52 discriminator 1 view .LVU193
 665 00b0 CEEB0E12 		rsb	r2, lr, lr, lsl #4
 666 00b4 01EB8202 		add	r2, r1, r2, lsl #2
 667 00b8 118F     		ldrh	r1, [r2, #56]
 257:FML/Src/EC2x.c ****                     dest->head = dest->tail;
 668              		.loc 1 257 66 discriminator 1 view .LVU194
 669 00ba 528F     		ldrh	r2, [r2, #58]
 257:FML/Src/EC2x.c ****                     dest->head = dest->tail;
 670              		.loc 1 257 45 discriminator 1 view .LVU195
 671 00bc 9142     		cmp	r1, r2
 672 00be 08D0     		beq	.L50
 673              	.L46:
 259:FML/Src/EC2x.c ****             }
 674              		.loc 1 259 17 is_stmt 1 view .LVU196
 259:FML/Src/EC2x.c ****             }
 675              		.loc 1 259 29 is_stmt 0 view .LVU197
 676 00c0 CEEB0E1E 		rsb	lr, lr, lr, lsl #4
 677 00c4 084A     		ldr	r2, .L51+8
 678 00c6 02EB8E0E 		add	lr, r2, lr, lsl #2
 679 00ca 0022     		movs	r2, #0
 680 00cc 8EF82C20 		strb	r2, [lr, #44]
 681 00d0 ABE7     		b	.L43
 682              	.L50:
 258:FML/Src/EC2x.c ****                 dest->block = 0;
 683              		.loc 1 258 21 is_stmt 1 view .LVU198
 258:FML/Src/EC2x.c ****                 dest->block = 0;
 684              		.loc 1 258 32 is_stmt 0 view .LVU199
 685 00d2 CEEB0E12 		rsb	r2, lr, lr, lsl #4
 686 00d6 0449     		ldr	r1, .L51+8
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 19


 687 00d8 01EB8202 		add	r2, r1, r2, lsl #2
 688 00dc 9086     		strh	r0, [r2, #52]	@ movhi
 689 00de EFE7     		b	.L46
 690              	.L52:
 691              		.align	2
 692              	.L51:
 693 00e0 00000000 		.word	.LC0
 694 00e4 00000000 		.word	shell
 695 00e8 00000000 		.word	.LANCHOR0
 696              	.LBE5:
 697              		.cfi_endproc
 698              	.LFE296:
 700              		.section	.text.ec2x_replymatch,"ax",%progbits
 701              		.align	1
 702              		.global	ec2x_replymatch
 703              		.syntax unified
 704              		.thumb
 705              		.thumb_func
 707              	ec2x_replymatch:
 708              	.LVL58:
 709              	.LFB297:
 264:FML/Src/EC2x.c **** 
 265:FML/Src/EC2x.c **** 
 266:FML/Src/EC2x.c **** /**
 267:FML/Src/EC2x.c ****  * @brief 回复匹配函数
 268:FML/Src/EC2x.c ****  *        1）匹配成功，则插入回复成功事件
 269:FML/Src/EC2x.c ****  *        2.1）匹配失败，超时次数-1
 270:FML/Src/EC2x.c ****  *        2.2）匹配失败，超时次数=0，插入超时事件消息
 271:FML/Src/EC2x.c ****  * 
 272:FML/Src/EC2x.c ****  * @param expect 
 273:FML/Src/EC2x.c ****  * @return int 
 274:FML/Src/EC2x.c ****  */
 275:FML/Src/EC2x.c **** int ec2x_replymatch(uint8_t* expect){
 710              		.loc 1 275 37 is_stmt 1 view -0
 711              		.cfi_startproc
 712              		@ args = 0, pretend = 0, frame = 200
 713              		@ frame_needed = 0, uses_anonymous_args = 0
 714              		.loc 1 275 37 is_stmt 0 view .LVU201
 715 0000 30B5     		push	{r4, r5, lr}
 716              	.LCFI9:
 717              		.cfi_def_cfa_offset 12
 718              		.cfi_offset 4, -12
 719              		.cfi_offset 5, -8
 720              		.cfi_offset 14, -4
 721 0002 B3B0     		sub	sp, sp, #204
 722              	.LCFI10:
 723              		.cfi_def_cfa_offset 216
 724 0004 0546     		mov	r5, r0
 276:FML/Src/EC2x.c ****     uint8_t rx_buff[200]  = {0x00};
 725              		.loc 1 276 5 is_stmt 1 view .LVU202
 726              		.loc 1 276 13 is_stmt 0 view .LVU203
 727 0006 0024     		movs	r4, #0
 728 0008 0094     		str	r4, [sp]
 729 000a C422     		movs	r2, #196
 730 000c 2146     		mov	r1, r4
 731 000e 01A8     		add	r0, sp, #4
 732              	.LVL59:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 20


 733              		.loc 1 276 13 view .LVU204
 734 0010 FFF7FEFF 		bl	memset
 735              	.LVL60:
 277:FML/Src/EC2x.c ****     int bytes_num = 0;
 736              		.loc 1 277 5 is_stmt 1 view .LVU205
 278:FML/Src/EC2x.c ****     bytes_num =  ec2x_read(0,rx_buff,200);
 737              		.loc 1 278 5 view .LVU206
 738              		.loc 1 278 18 is_stmt 0 view .LVU207
 739 0014 C822     		movs	r2, #200
 740 0016 6946     		mov	r1, sp
 741 0018 2046     		mov	r0, r4
 742 001a FFF7FEFF 		bl	ec2x_read
 743              	.LVL61:
 279:FML/Src/EC2x.c ****     if(bytes_num > 0)
 744              		.loc 1 279 5 is_stmt 1 view .LVU208
 745              		.loc 1 279 7 is_stmt 0 view .LVU209
 746 001e A042     		cmp	r0, r4
 747 0020 08DD     		ble	.L55
 280:FML/Src/EC2x.c ****     {
 281:FML/Src/EC2x.c ****         if(strstr((const char*)rx_buff,(const char*)expect) != NULL){
 748              		.loc 1 281 9 is_stmt 1 view .LVU210
 749              		.loc 1 281 12 is_stmt 0 view .LVU211
 750 0022 2946     		mov	r1, r5
 751 0024 6846     		mov	r0, sp
 752              	.LVL62:
 753              		.loc 1 281 12 view .LVU212
 754 0026 FFF7FEFF 		bl	strstr
 755              	.LVL63:
 756              		.loc 1 281 11 view .LVU213
 757 002a 08B1     		cbz	r0, .L58
 282:FML/Src/EC2x.c ****             return 1;
 758              		.loc 1 282 20 view .LVU214
 759 002c 0120     		movs	r0, #1
 760 002e 02E0     		b	.L53
 761              	.L58:
 283:FML/Src/EC2x.c ****         }
 284:FML/Src/EC2x.c ****     }
 285:FML/Src/EC2x.c ****     return 0;
 762              		.loc 1 285 12 view .LVU215
 763 0030 2046     		mov	r0, r4
 764 0032 00E0     		b	.L53
 765              	.LVL64:
 766              	.L55:
 767              		.loc 1 285 12 view .LVU216
 768 0034 0020     		movs	r0, #0
 769              	.LVL65:
 770              	.L53:
 286:FML/Src/EC2x.c **** }
 771              		.loc 1 286 1 view .LVU217
 772 0036 33B0     		add	sp, sp, #204
 773              	.LCFI11:
 774              		.cfi_def_cfa_offset 12
 775              		@ sp needed
 776 0038 30BD     		pop	{r4, r5, pc}
 777              		.loc 1 286 1 view .LVU218
 778              		.cfi_endproc
 779              	.LFE297:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 21


 781              		.section	.text.ec2x_cmd_send,"ax",%progbits
 782              		.align	1
 783              		.syntax unified
 784              		.thumb
 785              		.thumb_func
 787              	ec2x_cmd_send:
 788              	.LVL66:
 789              	.LFB298:
 287:FML/Src/EC2x.c **** 
 288:FML/Src/EC2x.c **** 
 289:FML/Src/EC2x.c **** /**
 290:FML/Src/EC2x.c ****  * @brief ec2x指令发送函数
 291:FML/Src/EC2x.c ****  *        1）发送指令
 292:FML/Src/EC2x.c ****  *        2）进入等待回复状态
 293:FML/Src/EC2x.c ****  * @param fd 
 294:FML/Src/EC2x.c ****  * @param tx_buff 
 295:FML/Src/EC2x.c ****  * @param len 
 296:FML/Src/EC2x.c ****  * @param expect_reply 
 297:FML/Src/EC2x.c ****  * @param timeout 
 298:FML/Src/EC2x.c ****  */
 299:FML/Src/EC2x.c **** int ec2x_cmd_send(int fd,uint8_t *tx_buff,uint16_t len,uint8_t *expect_reply,uint16_t timeout)
 300:FML/Src/EC2x.c **** {
 790              		.loc 1 300 1 is_stmt 1 view -0
 791              		.cfi_startproc
 792              		@ args = 4, pretend = 0, frame = 0
 793              		@ frame_needed = 0, uses_anonymous_args = 0
 794              		.loc 1 300 1 is_stmt 0 view .LVU220
 795 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 796              	.LCFI12:
 797              		.cfi_def_cfa_offset 32
 798              		.cfi_offset 3, -32
 799              		.cfi_offset 4, -28
 800              		.cfi_offset 5, -24
 801              		.cfi_offset 6, -20
 802              		.cfi_offset 7, -16
 803              		.cfi_offset 8, -12
 804              		.cfi_offset 9, -8
 805              		.cfi_offset 14, -4
 806 0004 1D46     		mov	r5, r3
 301:FML/Src/EC2x.c ****     if(tx_buff !=NULL){
 807              		.loc 1 301 5 is_stmt 1 view .LVU221
 808              		.loc 1 301 7 is_stmt 0 view .LVU222
 809 0006 D9B1     		cbz	r1, .L60
 810 0008 0646     		mov	r6, r0
 811 000a 9046     		mov	r8, r2
 812 000c 8946     		mov	r9, r1
 302:FML/Src/EC2x.c ****         ec2x_dev[fd].msg.block = 1;
 813              		.loc 1 302 9 is_stmt 1 view .LVU223
 814              		.loc 1 302 32 is_stmt 0 view .LVU224
 815 000e C0EB0013 		rsb	r3, r0, r0, lsl #4
 816              	.LVL67:
 817              		.loc 1 302 32 view .LVU225
 818 0012 184C     		ldr	r4, .L67
 819 0014 04EB8304 		add	r4, r4, r3, lsl #2
 820 0018 0123     		movs	r3, #1
 821 001a 84F82C30 		strb	r3, [r4, #44]
 303:FML/Src/EC2x.c ****         ec2x_dev[fd].msg.head = 0;
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 22


 822              		.loc 1 303 9 is_stmt 1 view .LVU226
 823              		.loc 1 303 31 is_stmt 0 view .LVU227
 824 001e 0027     		movs	r7, #0
 825 0020 A786     		strh	r7, [r4, #52]	@ movhi
 304:FML/Src/EC2x.c ****         ec2x_dev[fd].msg.tail = 0;
 826              		.loc 1 304 9 is_stmt 1 view .LVU228
 827              		.loc 1 304 31 is_stmt 0 view .LVU229
 828 0022 E786     		strh	r7, [r4, #54]	@ movhi
 305:FML/Src/EC2x.c ****         ec2x_dev[fd].msg.size = 0;
 829              		.loc 1 305 9 is_stmt 1 view .LVU230
 830              		.loc 1 305 31 is_stmt 0 view .LVU231
 831 0024 2787     		strh	r7, [r4, #56]	@ movhi
 306:FML/Src/EC2x.c ****         ec2x_dev[fd].msg.capacity = BUFF_LEN;
 832              		.loc 1 306 9 is_stmt 1 view .LVU232
 833              		.loc 1 306 35 is_stmt 0 view .LVU233
 834 0026 C822     		movs	r2, #200
 835              	.LVL68:
 836              		.loc 1 306 35 view .LVU234
 837 0028 6287     		strh	r2, [r4, #58]	@ movhi
 307:FML/Src/EC2x.c ****         memset(ec2x_dev[fd].msg.data,0x00,BUFF_LEN);
 838              		.loc 1 307 9 is_stmt 1 view .LVU235
 839 002a 3946     		mov	r1, r7
 840              	.LVL69:
 841              		.loc 1 307 9 is_stmt 0 view .LVU236
 842 002c 206B     		ldr	r0, [r4, #48]
 843              	.LVL70:
 844              		.loc 1 307 9 view .LVU237
 845 002e FFF7FEFF 		bl	memset
 846              	.LVL71:
 308:FML/Src/EC2x.c ****         ec2x_dev[fd].msg.block = 0;
 847              		.loc 1 308 9 is_stmt 1 view .LVU238
 848              		.loc 1 308 32 is_stmt 0 view .LVU239
 849 0032 84F82C70 		strb	r7, [r4, #44]
 309:FML/Src/EC2x.c ****         ec2x_write(fd,tx_buff,len);
 850              		.loc 1 309 9 is_stmt 1 view .LVU240
 851 0036 4246     		mov	r2, r8
 852 0038 4946     		mov	r1, r9
 853 003a 3046     		mov	r0, r6
 854 003c FFF7FEFF 		bl	ec2x_write
 855              	.LVL72:
 856              	.L60:
 310:FML/Src/EC2x.c ****     }
 311:FML/Src/EC2x.c ****     if(expect_reply != NULL){
 857              		.loc 1 311 5 view .LVU241
 858              		.loc 1 311 7 is_stmt 0 view .LVU242
 859 0040 ADB1     		cbz	r5, .L64
 860              	.LBB6:
 312:FML/Src/EC2x.c ****         uint16_t retry_times = timeout / 100;
 861              		.loc 1 312 9 is_stmt 1 view .LVU243
 862              		.loc 1 312 18 is_stmt 0 view .LVU244
 863 0042 BDF82040 		ldrh	r4, [sp, #32]
 864 0046 0C4B     		ldr	r3, .L67+4
 865 0048 A3FB0434 		umull	r3, r4, r3, r4
 866 004c 6409     		lsrs	r4, r4, #5
 867              	.LVL73:
 313:FML/Src/EC2x.c ****         while(retry_times--){
 868              		.loc 1 313 9 is_stmt 1 view .LVU245
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 23


 869              	.L62:
 870              		.loc 1 313 14 view .LVU246
 871 004e 2246     		mov	r2, r4
 872              		.loc 1 313 26 is_stmt 0 view .LVU247
 873 0050 013C     		subs	r4, r4, #1
 874              	.LVL74:
 875              		.loc 1 313 26 view .LVU248
 876 0052 A4B2     		uxth	r4, r4
 877              	.LVL75:
 878              		.loc 1 313 14 view .LVU249
 879 0054 42B1     		cbz	r2, .L66
 314:FML/Src/EC2x.c ****             Delay_ms(100);
 880              		.loc 1 314 13 is_stmt 1 view .LVU250
 881 0056 6420     		movs	r0, #100
 882 0058 FFF7FEFF 		bl	Delay_ms
 883              	.LVL76:
 315:FML/Src/EC2x.c ****             if(ec2x_replymatch(expect_reply) == 1)
 884              		.loc 1 315 13 view .LVU251
 885              		.loc 1 315 16 is_stmt 0 view .LVU252
 886 005c 2846     		mov	r0, r5
 887 005e FFF7FEFF 		bl	ec2x_replymatch
 888              	.LVL77:
 889              		.loc 1 315 15 view .LVU253
 890 0062 0128     		cmp	r0, #1
 891 0064 F3D1     		bne	.L62
 892 0066 00E0     		b	.L59
 893              	.L66:
 894              		.loc 1 315 15 view .LVU254
 895              	.LBE6:
 316:FML/Src/EC2x.c ****                 return  1;
 317:FML/Src/EC2x.c ****         }
 318:FML/Src/EC2x.c ****     }
 319:FML/Src/EC2x.c ****     return 0;
 896              		.loc 1 319 12 view .LVU255
 897 0068 0020     		movs	r0, #0
 898              	.LVL78:
 899              	.L59:
 320:FML/Src/EC2x.c **** }
 900              		.loc 1 320 1 view .LVU256
 901 006a BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 902              	.LVL79:
 903              	.L64:
 319:FML/Src/EC2x.c **** }
 904              		.loc 1 319 12 view .LVU257
 905 006e 0020     		movs	r0, #0
 906 0070 FBE7     		b	.L59
 907              	.L68:
 908 0072 00BF     		.align	2
 909              	.L67:
 910 0074 00000000 		.word	.LANCHOR0
 911 0078 1F85EB51 		.word	1374389535
 912              		.cfi_endproc
 913              	.LFE298:
 915              		.section	.rodata.ec2x_reset.str1.4,"aMS",%progbits,1
 916              		.align	2
 917              	.LC1:
 918 0000 5244592F 		.ascii	"RDY/r/n\000"
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 24


 918      722F6E00 
 919              		.section	.text.ec2x_reset,"ax",%progbits
 920              		.align	1
 921              		.syntax unified
 922              		.thumb
 923              		.thumb_func
 925              	ec2x_reset:
 926              	.LVL80:
 927              	.LFB292:
 124:FML/Src/EC2x.c ****     fd = 0;
 928              		.loc 1 124 23 is_stmt 1 view -0
 929              		.cfi_startproc
 930              		@ args = 0, pretend = 0, frame = 0
 931              		@ frame_needed = 0, uses_anonymous_args = 0
 124:FML/Src/EC2x.c ****     fd = 0;
 932              		.loc 1 124 23 is_stmt 0 view .LVU259
 933 0000 10B5     		push	{r4, lr}
 934              	.LCFI13:
 935              		.cfi_def_cfa_offset 8
 936              		.cfi_offset 4, -8
 937              		.cfi_offset 14, -4
 938 0002 82B0     		sub	sp, sp, #8
 939              	.LCFI14:
 940              		.cfi_def_cfa_offset 16
 125:FML/Src/EC2x.c ****     int err_code = 0;
 941              		.loc 1 125 5 is_stmt 1 view .LVU260
 942              	.LVL81:
 126:FML/Src/EC2x.c ****     if(fd >= sizeof(ec2x_dev)/ sizeof(EC2x_HandleTypeDef))
 943              		.loc 1 126 5 view .LVU261
 127:FML/Src/EC2x.c ****         return (err_code = -1);
 944              		.loc 1 127 5 view .LVU262
 945              	.LBB7:
 130:FML/Src/EC2x.c ****         HAL_GPIO_WritePin(device->pwren_port, device->pwren_pin, GPIO_PIN_SET);
 946              		.loc 1 130 9 view .LVU263
 131:FML/Src/EC2x.c ****         Delay_ms(500);
 947              		.loc 1 131 9 view .LVU264
 948 0004 0C4C     		ldr	r4, .L71
 949 0006 0122     		movs	r2, #1
 950 0008 218B     		ldrh	r1, [r4, #24]
 951 000a 6069     		ldr	r0, [r4, #20]
 952 000c FFF7FEFF 		bl	HAL_GPIO_WritePin
 953              	.LVL82:
 132:FML/Src/EC2x.c ****         HAL_GPIO_WritePin(device->pwren_port, device->pwren_pin, GPIO_PIN_RESET);
 954              		.loc 1 132 9 view .LVU265
 955 0010 4FF4FA70 		mov	r0, #500
 956 0014 FFF7FEFF 		bl	Delay_ms
 957              	.LVL83:
 133:FML/Src/EC2x.c ****     }
 958              		.loc 1 133 9 view .LVU266
 959 0018 0022     		movs	r2, #0
 960 001a 218B     		ldrh	r1, [r4, #24]
 961 001c 6069     		ldr	r0, [r4, #20]
 962 001e FFF7FEFF 		bl	HAL_GPIO_WritePin
 963              	.LVL84:
 964              	.LBE7:
 135:FML/Src/EC2x.c **** }
 965              		.loc 1 135 5 view .LVU267
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 25


 135:FML/Src/EC2x.c **** }
 966              		.loc 1 135 12 is_stmt 0 view .LVU268
 967 0022 42F21073 		movw	r3, #10000
 968 0026 0093     		str	r3, [sp]
 969 0028 044B     		ldr	r3, .L71+4
 970 002a 0022     		movs	r2, #0
 971 002c 1146     		mov	r1, r2
 972 002e 1046     		mov	r0, r2
 973 0030 FFF7FEFF 		bl	ec2x_cmd_send
 974              	.LVL85:
 136:FML/Src/EC2x.c **** 
 975              		.loc 1 136 1 view .LVU269
 976 0034 02B0     		add	sp, sp, #8
 977              	.LCFI15:
 978              		.cfi_def_cfa_offset 8
 979              		@ sp needed
 980 0036 10BD     		pop	{r4, pc}
 981              	.L72:
 982              		.align	2
 983              	.L71:
 984 0038 00000000 		.word	.LANCHOR0
 985 003c 00000000 		.word	.LC1
 986              		.cfi_endproc
 987              	.LFE292:
 989              		.section	.rodata.ec2x_tcp_connect.str1.4,"aMS",%progbits,1
 990              		.align	2
 991              	.LC2:
 992 0000 7463705F 		.ascii	"tcp_connect success\015\012\000"
 992      636F6E6E 
 992      65637420 
 992      73756363 
 992      6573730D 
 993              		.section	.text.ec2x_tcp_connect,"ax",%progbits
 994              		.align	1
 995              		.global	ec2x_tcp_connect
 996              		.syntax unified
 997              		.thumb
 998              		.thumb_func
 1000              	ec2x_tcp_connect:
 1001              	.LVL86:
 1002              	.LFB299:
 321:FML/Src/EC2x.c **** 
 322:FML/Src/EC2x.c **** /**
 323:FML/Src/EC2x.c ****  * @brief tcp 连接流程
 324:FML/Src/EC2x.c ****  * 
 325:FML/Src/EC2x.c ****  * @param fd 
 326:FML/Src/EC2x.c ****  * @return uint8_t 
 327:FML/Src/EC2x.c ****  */
 328:FML/Src/EC2x.c **** uint8_t ec2x_tcp_connect(int fd){
 1003              		.loc 1 328 33 is_stmt 1 view -0
 1004              		.cfi_startproc
 1005              		@ args = 0, pretend = 0, frame = 0
 1006              		@ frame_needed = 0, uses_anonymous_args = 0
 1007              		.loc 1 328 33 is_stmt 0 view .LVU271
 1008 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1009              	.LCFI16:
 1010              		.cfi_def_cfa_offset 24
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 26


 1011              		.cfi_offset 4, -24
 1012              		.cfi_offset 5, -20
 1013              		.cfi_offset 6, -16
 1014              		.cfi_offset 7, -12
 1015              		.cfi_offset 8, -8
 1016              		.cfi_offset 14, -4
 1017 0004 82B0     		sub	sp, sp, #8
 1018              	.LCFI17:
 1019              		.cfi_def_cfa_offset 32
 1020 0006 0546     		mov	r5, r0
 329:FML/Src/EC2x.c ****     static uint8_t step = 0;
 1021              		.loc 1 329 5 is_stmt 1 view .LVU272
 330:FML/Src/EC2x.c ****     while(step < 9){
 1022              		.loc 1 330 5 view .LVU273
 1023              		.loc 1 330 10 is_stmt 0 view .LVU274
 1024 0008 18E0     		b	.L75
 1025              	.LVL87:
 1026              	.L85:
 331:FML/Src/EC2x.c ****         switch (step)
 332:FML/Src/EC2x.c ****         {
 333:FML/Src/EC2x.c ****             case 0: 
 334:FML/Src/EC2x.c ****             {
 335:FML/Src/EC2x.c ****                 if(ec2x_cmd_send(fd,connectmsg_queue[step].txmsg,strlen(connectmsg_queue[step].txms
 1027              		.loc 1 335 17 is_stmt 1 view .LVU275
 1028              		.loc 1 335 20 is_stmt 0 view .LVU276
 1029 000a A54F     		ldr	r7, .L99
 1030 000c 6600     		lsls	r6, r4, #1
 1031 000e 04EB4403 		add	r3, r4, r4, lsl #1
 1032 0012 57F82380 		ldr	r8, [r7, r3, lsl #2]
 1033              		.loc 1 335 66 view .LVU277
 1034 0016 4046     		mov	r0, r8
 1035 0018 FFF7FEFF 		bl	strlen
 1036              	.LVL88:
 1037              		.loc 1 335 20 view .LVU278
 1038 001c 3444     		add	r4, r4, r6
 1039 001e 07EB8404 		add	r4, r7, r4, lsl #2
 1040 0022 3B89     		ldrh	r3, [r7, #8]
 1041 0024 0093     		str	r3, [sp]
 1042 0026 6368     		ldr	r3, [r4, #4]
 1043 0028 82B2     		uxth	r2, r0
 1044 002a 4146     		mov	r1, r8
 1045 002c 2846     		mov	r0, r5
 1046 002e FFF7FEFF 		bl	ec2x_cmd_send
 1047              	.LVL89:
 1048              		.loc 1 335 19 view .LVU279
 1049 0032 F8B1     		cbz	r0, .L86
 336:FML/Src/EC2x.c ****                     step++;
 1050              		.loc 1 336 21 is_stmt 1 view .LVU280
 1051              		.loc 1 336 25 is_stmt 0 view .LVU281
 1052 0034 9B4A     		ldr	r2, .L99+4
 1053 0036 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1054 0038 0133     		adds	r3, r3, #1
 1055 003a 1370     		strb	r3, [r2]
 1056              	.L75:
 330:FML/Src/EC2x.c ****     while(step < 9){
 1057              		.loc 1 330 10 is_stmt 1 view .LVU282
 330:FML/Src/EC2x.c ****     while(step < 9){
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 27


 1058              		.loc 1 330 16 is_stmt 0 view .LVU283
 1059 003c 994B     		ldr	r3, .L99+4
 1060 003e 1C78     		ldrb	r4, [r3]	@ zero_extendqisi2
 330:FML/Src/EC2x.c ****     while(step < 9){
 1061              		.loc 1 330 10 view .LVU284
 1062 0040 082C     		cmp	r4, #8
 1063 0042 00F22A81 		bhi	.L98
 331:FML/Src/EC2x.c ****         switch (step)
 1064              		.loc 1 331 9 is_stmt 1 view .LVU285
 1065 0046 082C     		cmp	r4, #8
 1066 0048 F8D8     		bhi	.L75
 1067 004a 01A3     		adr	r3, .L77
 1068 004c 53F824F0 		ldr	pc, [r3, r4, lsl #2]
 1069              		.p2align 2
 1070              	.L77:
 1071 0050 0B000000 		.word	.L85+1
 1072 0054 83000000 		.word	.L84+1
 1073 0058 C5000000 		.word	.L83+1
 1074 005c 07010000 		.word	.L82+1
 1075 0060 49010000 		.word	.L81+1
 1076 0064 8B010000 		.word	.L80+1
 1077 0068 CD010000 		.word	.L79+1
 1078 006c 0F020000 		.word	.L78+1
 1079 0070 51020000 		.word	.L76+1
 1080              		.p2align 1
 1081              	.L86:
 337:FML/Src/EC2x.c ****                 else
 338:FML/Src/EC2x.c ****                 {
 339:FML/Src/EC2x.c ****                     ec2x_reset(fd); 
 1082              		.loc 1 339 21 view .LVU286
 1083 0074 2846     		mov	r0, r5
 1084 0076 FFF7FEFF 		bl	ec2x_reset
 1085              	.LVL90:
 340:FML/Src/EC2x.c ****                     step = 0;
 1086              		.loc 1 340 21 view .LVU287
 1087              		.loc 1 340 26 is_stmt 0 view .LVU288
 1088 007a 8A4B     		ldr	r3, .L99+4
 1089 007c 0022     		movs	r2, #0
 1090 007e 1A70     		strb	r2, [r3]
 1091 0080 DCE7     		b	.L75
 1092              	.L84:
 341:FML/Src/EC2x.c ****                 }
 342:FML/Src/EC2x.c ****             }
 343:FML/Src/EC2x.c ****             break;
 344:FML/Src/EC2x.c ****             case 1:
 345:FML/Src/EC2x.c ****             {
 346:FML/Src/EC2x.c ****                 if(ec2x_cmd_send(fd,connectmsg_queue[step].txmsg,strlen(connectmsg_queue[step].txms
 1093              		.loc 1 346 17 is_stmt 1 view .LVU289
 1094              		.loc 1 346 20 is_stmt 0 view .LVU290
 1095 0082 874F     		ldr	r7, .L99
 1096 0084 6600     		lsls	r6, r4, #1
 1097 0086 04EB4403 		add	r3, r4, r4, lsl #1
 1098 008a 57F82380 		ldr	r8, [r7, r3, lsl #2]
 1099              		.loc 1 346 66 view .LVU291
 1100 008e 4046     		mov	r0, r8
 1101 0090 FFF7FEFF 		bl	strlen
 1102              	.LVL91:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 28


 1103              		.loc 1 346 20 view .LVU292
 1104 0094 3444     		add	r4, r4, r6
 1105 0096 07EB8404 		add	r4, r7, r4, lsl #2
 1106 009a 3B89     		ldrh	r3, [r7, #8]
 1107 009c 0093     		str	r3, [sp]
 1108 009e 6368     		ldr	r3, [r4, #4]
 1109 00a0 82B2     		uxth	r2, r0
 1110 00a2 4146     		mov	r1, r8
 1111 00a4 2846     		mov	r0, r5
 1112 00a6 FFF7FEFF 		bl	ec2x_cmd_send
 1113              	.LVL92:
 1114              		.loc 1 346 19 view .LVU293
 1115 00aa 20B1     		cbz	r0, .L88
 347:FML/Src/EC2x.c ****                     step++;
 1116              		.loc 1 347 21 is_stmt 1 view .LVU294
 1117              		.loc 1 347 25 is_stmt 0 view .LVU295
 1118 00ac 7D4A     		ldr	r2, .L99+4
 1119 00ae 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1120 00b0 0133     		adds	r3, r3, #1
 1121 00b2 1370     		strb	r3, [r2]
 1122 00b4 C2E7     		b	.L75
 1123              	.L88:
 348:FML/Src/EC2x.c ****                 else
 349:FML/Src/EC2x.c ****                 {
 350:FML/Src/EC2x.c ****                     ec2x_reset(fd); 
 1124              		.loc 1 350 21 is_stmt 1 view .LVU296
 1125 00b6 2846     		mov	r0, r5
 1126 00b8 FFF7FEFF 		bl	ec2x_reset
 1127              	.LVL93:
 351:FML/Src/EC2x.c ****                     step = 0;
 1128              		.loc 1 351 21 view .LVU297
 1129              		.loc 1 351 26 is_stmt 0 view .LVU298
 1130 00bc 794B     		ldr	r3, .L99+4
 1131 00be 0022     		movs	r2, #0
 1132 00c0 1A70     		strb	r2, [r3]
 1133 00c2 BBE7     		b	.L75
 1134              	.L83:
 352:FML/Src/EC2x.c ****                 }
 353:FML/Src/EC2x.c ****             }
 354:FML/Src/EC2x.c ****             break;
 355:FML/Src/EC2x.c ****             case 2:
 356:FML/Src/EC2x.c ****             {
 357:FML/Src/EC2x.c ****                 if(ec2x_cmd_send(fd,connectmsg_queue[step].txmsg,strlen(connectmsg_queue[step].txms
 1135              		.loc 1 357 17 is_stmt 1 view .LVU299
 1136              		.loc 1 357 20 is_stmt 0 view .LVU300
 1137 00c4 764F     		ldr	r7, .L99
 1138 00c6 6600     		lsls	r6, r4, #1
 1139 00c8 04EB4403 		add	r3, r4, r4, lsl #1
 1140 00cc 57F82380 		ldr	r8, [r7, r3, lsl #2]
 1141              		.loc 1 357 66 view .LVU301
 1142 00d0 4046     		mov	r0, r8
 1143 00d2 FFF7FEFF 		bl	strlen
 1144              	.LVL94:
 1145              		.loc 1 357 20 view .LVU302
 1146 00d6 3444     		add	r4, r4, r6
 1147 00d8 07EB8404 		add	r4, r7, r4, lsl #2
 1148 00dc 3B89     		ldrh	r3, [r7, #8]
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 29


 1149 00de 0093     		str	r3, [sp]
 1150 00e0 6368     		ldr	r3, [r4, #4]
 1151 00e2 82B2     		uxth	r2, r0
 1152 00e4 4146     		mov	r1, r8
 1153 00e6 2846     		mov	r0, r5
 1154 00e8 FFF7FEFF 		bl	ec2x_cmd_send
 1155              	.LVL95:
 1156              		.loc 1 357 19 view .LVU303
 1157 00ec 20B1     		cbz	r0, .L89
 358:FML/Src/EC2x.c ****                     step++;
 1158              		.loc 1 358 21 is_stmt 1 view .LVU304
 1159              		.loc 1 358 25 is_stmt 0 view .LVU305
 1160 00ee 6D4A     		ldr	r2, .L99+4
 1161 00f0 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1162 00f2 0133     		adds	r3, r3, #1
 1163 00f4 1370     		strb	r3, [r2]
 1164 00f6 A1E7     		b	.L75
 1165              	.L89:
 359:FML/Src/EC2x.c ****                 else
 360:FML/Src/EC2x.c ****                 {
 361:FML/Src/EC2x.c ****                     ec2x_reset(fd); 
 1166              		.loc 1 361 21 is_stmt 1 view .LVU306
 1167 00f8 2846     		mov	r0, r5
 1168 00fa FFF7FEFF 		bl	ec2x_reset
 1169              	.LVL96:
 362:FML/Src/EC2x.c ****                     step = 0;
 1170              		.loc 1 362 21 view .LVU307
 1171              		.loc 1 362 26 is_stmt 0 view .LVU308
 1172 00fe 694B     		ldr	r3, .L99+4
 1173 0100 0022     		movs	r2, #0
 1174 0102 1A70     		strb	r2, [r3]
 1175 0104 9AE7     		b	.L75
 1176              	.L82:
 363:FML/Src/EC2x.c ****                 }
 364:FML/Src/EC2x.c ****             }
 365:FML/Src/EC2x.c ****             break;
 366:FML/Src/EC2x.c ****             case 3:
 367:FML/Src/EC2x.c ****             {
 368:FML/Src/EC2x.c ****                 if(ec2x_cmd_send(fd,connectmsg_queue[step].txmsg,strlen(connectmsg_queue[step].txms
 1177              		.loc 1 368 17 is_stmt 1 view .LVU309
 1178              		.loc 1 368 20 is_stmt 0 view .LVU310
 1179 0106 664F     		ldr	r7, .L99
 1180 0108 6600     		lsls	r6, r4, #1
 1181 010a 04EB4403 		add	r3, r4, r4, lsl #1
 1182 010e 57F82380 		ldr	r8, [r7, r3, lsl #2]
 1183              		.loc 1 368 66 view .LVU311
 1184 0112 4046     		mov	r0, r8
 1185 0114 FFF7FEFF 		bl	strlen
 1186              	.LVL97:
 1187              		.loc 1 368 20 view .LVU312
 1188 0118 3444     		add	r4, r4, r6
 1189 011a 07EB8404 		add	r4, r7, r4, lsl #2
 1190 011e 3B89     		ldrh	r3, [r7, #8]
 1191 0120 0093     		str	r3, [sp]
 1192 0122 6368     		ldr	r3, [r4, #4]
 1193 0124 82B2     		uxth	r2, r0
 1194 0126 4146     		mov	r1, r8
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 30


 1195 0128 2846     		mov	r0, r5
 1196 012a FFF7FEFF 		bl	ec2x_cmd_send
 1197              	.LVL98:
 1198              		.loc 1 368 19 view .LVU313
 1199 012e 20B1     		cbz	r0, .L90
 369:FML/Src/EC2x.c ****                     step++;
 1200              		.loc 1 369 21 is_stmt 1 view .LVU314
 1201              		.loc 1 369 25 is_stmt 0 view .LVU315
 1202 0130 5C4A     		ldr	r2, .L99+4
 1203 0132 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1204 0134 0133     		adds	r3, r3, #1
 1205 0136 1370     		strb	r3, [r2]
 1206 0138 80E7     		b	.L75
 1207              	.L90:
 370:FML/Src/EC2x.c ****                 else
 371:FML/Src/EC2x.c ****                 {
 372:FML/Src/EC2x.c ****                     ec2x_reset(fd); 
 1208              		.loc 1 372 21 is_stmt 1 view .LVU316
 1209 013a 2846     		mov	r0, r5
 1210 013c FFF7FEFF 		bl	ec2x_reset
 1211              	.LVL99:
 373:FML/Src/EC2x.c ****                     step = 0;
 1212              		.loc 1 373 21 view .LVU317
 1213              		.loc 1 373 26 is_stmt 0 view .LVU318
 1214 0140 584B     		ldr	r3, .L99+4
 1215 0142 0022     		movs	r2, #0
 1216 0144 1A70     		strb	r2, [r3]
 1217 0146 79E7     		b	.L75
 1218              	.L81:
 374:FML/Src/EC2x.c ****                 }
 375:FML/Src/EC2x.c ****             }
 376:FML/Src/EC2x.c ****             break;
 377:FML/Src/EC2x.c ****             case 4:
 378:FML/Src/EC2x.c ****             {
 379:FML/Src/EC2x.c ****                 if(ec2x_cmd_send(fd,connectmsg_queue[step].txmsg,strlen(connectmsg_queue[step].txms
 1219              		.loc 1 379 17 is_stmt 1 view .LVU319
 1220              		.loc 1 379 20 is_stmt 0 view .LVU320
 1221 0148 554F     		ldr	r7, .L99
 1222 014a 6600     		lsls	r6, r4, #1
 1223 014c 04EB4403 		add	r3, r4, r4, lsl #1
 1224 0150 57F82380 		ldr	r8, [r7, r3, lsl #2]
 1225              		.loc 1 379 66 view .LVU321
 1226 0154 4046     		mov	r0, r8
 1227 0156 FFF7FEFF 		bl	strlen
 1228              	.LVL100:
 1229              		.loc 1 379 20 view .LVU322
 1230 015a 3444     		add	r4, r4, r6
 1231 015c 07EB8404 		add	r4, r7, r4, lsl #2
 1232 0160 3B89     		ldrh	r3, [r7, #8]
 1233 0162 0093     		str	r3, [sp]
 1234 0164 6368     		ldr	r3, [r4, #4]
 1235 0166 82B2     		uxth	r2, r0
 1236 0168 4146     		mov	r1, r8
 1237 016a 2846     		mov	r0, r5
 1238 016c FFF7FEFF 		bl	ec2x_cmd_send
 1239              	.LVL101:
 1240              		.loc 1 379 19 view .LVU323
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 31


 1241 0170 20B1     		cbz	r0, .L91
 380:FML/Src/EC2x.c ****                     step++;
 1242              		.loc 1 380 21 is_stmt 1 view .LVU324
 1243              		.loc 1 380 25 is_stmt 0 view .LVU325
 1244 0172 4C4A     		ldr	r2, .L99+4
 1245 0174 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1246 0176 0133     		adds	r3, r3, #1
 1247 0178 1370     		strb	r3, [r2]
 1248 017a 5FE7     		b	.L75
 1249              	.L91:
 381:FML/Src/EC2x.c ****                 else
 382:FML/Src/EC2x.c ****                 {
 383:FML/Src/EC2x.c ****                     ec2x_reset(fd); 
 1250              		.loc 1 383 21 is_stmt 1 view .LVU326
 1251 017c 2846     		mov	r0, r5
 1252 017e FFF7FEFF 		bl	ec2x_reset
 1253              	.LVL102:
 384:FML/Src/EC2x.c ****                     step = 0;
 1254              		.loc 1 384 21 view .LVU327
 1255              		.loc 1 384 26 is_stmt 0 view .LVU328
 1256 0182 484B     		ldr	r3, .L99+4
 1257 0184 0022     		movs	r2, #0
 1258 0186 1A70     		strb	r2, [r3]
 1259 0188 58E7     		b	.L75
 1260              	.L80:
 385:FML/Src/EC2x.c ****                 }
 386:FML/Src/EC2x.c ****             }
 387:FML/Src/EC2x.c ****             break;
 388:FML/Src/EC2x.c ****             case 5:
 389:FML/Src/EC2x.c ****             {
 390:FML/Src/EC2x.c ****                 if(ec2x_cmd_send(fd,connectmsg_queue[step].txmsg,strlen(connectmsg_queue[step].txms
 1261              		.loc 1 390 17 is_stmt 1 view .LVU329
 1262              		.loc 1 390 20 is_stmt 0 view .LVU330
 1263 018a 454F     		ldr	r7, .L99
 1264 018c 6600     		lsls	r6, r4, #1
 1265 018e 04EB4403 		add	r3, r4, r4, lsl #1
 1266 0192 57F82380 		ldr	r8, [r7, r3, lsl #2]
 1267              		.loc 1 390 66 view .LVU331
 1268 0196 4046     		mov	r0, r8
 1269 0198 FFF7FEFF 		bl	strlen
 1270              	.LVL103:
 1271              		.loc 1 390 20 view .LVU332
 1272 019c 3444     		add	r4, r4, r6
 1273 019e 07EB8404 		add	r4, r7, r4, lsl #2
 1274 01a2 3B89     		ldrh	r3, [r7, #8]
 1275 01a4 0093     		str	r3, [sp]
 1276 01a6 6368     		ldr	r3, [r4, #4]
 1277 01a8 82B2     		uxth	r2, r0
 1278 01aa 4146     		mov	r1, r8
 1279 01ac 2846     		mov	r0, r5
 1280 01ae FFF7FEFF 		bl	ec2x_cmd_send
 1281              	.LVL104:
 1282              		.loc 1 390 19 view .LVU333
 1283 01b2 20B1     		cbz	r0, .L92
 391:FML/Src/EC2x.c ****                     step++;
 1284              		.loc 1 391 21 is_stmt 1 view .LVU334
 1285              		.loc 1 391 25 is_stmt 0 view .LVU335
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 32


 1286 01b4 3B4A     		ldr	r2, .L99+4
 1287 01b6 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1288 01b8 0133     		adds	r3, r3, #1
 1289 01ba 1370     		strb	r3, [r2]
 1290 01bc 3EE7     		b	.L75
 1291              	.L92:
 392:FML/Src/EC2x.c ****                 else
 393:FML/Src/EC2x.c ****                 {
 394:FML/Src/EC2x.c ****                     ec2x_reset(fd); 
 1292              		.loc 1 394 21 is_stmt 1 view .LVU336
 1293 01be 2846     		mov	r0, r5
 1294 01c0 FFF7FEFF 		bl	ec2x_reset
 1295              	.LVL105:
 395:FML/Src/EC2x.c ****                     step = 0;
 1296              		.loc 1 395 21 view .LVU337
 1297              		.loc 1 395 26 is_stmt 0 view .LVU338
 1298 01c4 374B     		ldr	r3, .L99+4
 1299 01c6 0022     		movs	r2, #0
 1300 01c8 1A70     		strb	r2, [r3]
 1301 01ca 37E7     		b	.L75
 1302              	.L79:
 396:FML/Src/EC2x.c ****                 }
 397:FML/Src/EC2x.c ****             }
 398:FML/Src/EC2x.c ****             break; 
 399:FML/Src/EC2x.c ****             case 6:
 400:FML/Src/EC2x.c ****             {
 401:FML/Src/EC2x.c ****                 if(ec2x_cmd_send(fd,connectmsg_queue[step].txmsg,strlen(connectmsg_queue[step].txms
 1303              		.loc 1 401 17 is_stmt 1 view .LVU339
 1304              		.loc 1 401 20 is_stmt 0 view .LVU340
 1305 01cc 344F     		ldr	r7, .L99
 1306 01ce 6600     		lsls	r6, r4, #1
 1307 01d0 04EB4403 		add	r3, r4, r4, lsl #1
 1308 01d4 57F82380 		ldr	r8, [r7, r3, lsl #2]
 1309              		.loc 1 401 66 view .LVU341
 1310 01d8 4046     		mov	r0, r8
 1311 01da FFF7FEFF 		bl	strlen
 1312              	.LVL106:
 1313              		.loc 1 401 20 view .LVU342
 1314 01de 3444     		add	r4, r4, r6
 1315 01e0 07EB8404 		add	r4, r7, r4, lsl #2
 1316 01e4 3B89     		ldrh	r3, [r7, #8]
 1317 01e6 0093     		str	r3, [sp]
 1318 01e8 6368     		ldr	r3, [r4, #4]
 1319 01ea 82B2     		uxth	r2, r0
 1320 01ec 4146     		mov	r1, r8
 1321 01ee 2846     		mov	r0, r5
 1322 01f0 FFF7FEFF 		bl	ec2x_cmd_send
 1323              	.LVL107:
 1324              		.loc 1 401 19 view .LVU343
 1325 01f4 20B1     		cbz	r0, .L93
 402:FML/Src/EC2x.c ****                     step++;
 1326              		.loc 1 402 21 is_stmt 1 view .LVU344
 1327              		.loc 1 402 25 is_stmt 0 view .LVU345
 1328 01f6 2B4A     		ldr	r2, .L99+4
 1329 01f8 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1330 01fa 0133     		adds	r3, r3, #1
 1331 01fc 1370     		strb	r3, [r2]
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 33


 1332 01fe 1DE7     		b	.L75
 1333              	.L93:
 403:FML/Src/EC2x.c ****                 else
 404:FML/Src/EC2x.c ****                 {
 405:FML/Src/EC2x.c ****                     ec2x_reset(fd); 
 1334              		.loc 1 405 21 is_stmt 1 view .LVU346
 1335 0200 2846     		mov	r0, r5
 1336 0202 FFF7FEFF 		bl	ec2x_reset
 1337              	.LVL108:
 406:FML/Src/EC2x.c ****                     step = 0;
 1338              		.loc 1 406 21 view .LVU347
 1339              		.loc 1 406 26 is_stmt 0 view .LVU348
 1340 0206 274B     		ldr	r3, .L99+4
 1341 0208 0022     		movs	r2, #0
 1342 020a 1A70     		strb	r2, [r3]
 1343 020c 16E7     		b	.L75
 1344              	.L78:
 407:FML/Src/EC2x.c ****                 }
 408:FML/Src/EC2x.c ****             }
 409:FML/Src/EC2x.c ****             break; 
 410:FML/Src/EC2x.c ****             case 7:
 411:FML/Src/EC2x.c ****             {
 412:FML/Src/EC2x.c ****                 if(ec2x_cmd_send(fd,connectmsg_queue[step].txmsg,strlen(connectmsg_queue[step].txms
 1345              		.loc 1 412 17 is_stmt 1 view .LVU349
 1346              		.loc 1 412 20 is_stmt 0 view .LVU350
 1347 020e 244F     		ldr	r7, .L99
 1348 0210 6600     		lsls	r6, r4, #1
 1349 0212 04EB4403 		add	r3, r4, r4, lsl #1
 1350 0216 57F82380 		ldr	r8, [r7, r3, lsl #2]
 1351              		.loc 1 412 66 view .LVU351
 1352 021a 4046     		mov	r0, r8
 1353 021c FFF7FEFF 		bl	strlen
 1354              	.LVL109:
 1355              		.loc 1 412 20 view .LVU352
 1356 0220 3444     		add	r4, r4, r6
 1357 0222 07EB8404 		add	r4, r7, r4, lsl #2
 1358 0226 3B89     		ldrh	r3, [r7, #8]
 1359 0228 0093     		str	r3, [sp]
 1360 022a 6368     		ldr	r3, [r4, #4]
 1361 022c 82B2     		uxth	r2, r0
 1362 022e 4146     		mov	r1, r8
 1363 0230 2846     		mov	r0, r5
 1364 0232 FFF7FEFF 		bl	ec2x_cmd_send
 1365              	.LVL110:
 1366              		.loc 1 412 19 view .LVU353
 1367 0236 20B1     		cbz	r0, .L94
 413:FML/Src/EC2x.c ****                     step++;
 1368              		.loc 1 413 21 is_stmt 1 view .LVU354
 1369              		.loc 1 413 25 is_stmt 0 view .LVU355
 1370 0238 1A4A     		ldr	r2, .L99+4
 1371 023a 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1372 023c 0133     		adds	r3, r3, #1
 1373 023e 1370     		strb	r3, [r2]
 1374 0240 FCE6     		b	.L75
 1375              	.L94:
 414:FML/Src/EC2x.c ****                 else
 415:FML/Src/EC2x.c ****                 {
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 34


 416:FML/Src/EC2x.c ****                     ec2x_reset(fd); 
 1376              		.loc 1 416 21 is_stmt 1 view .LVU356
 1377 0242 2846     		mov	r0, r5
 1378 0244 FFF7FEFF 		bl	ec2x_reset
 1379              	.LVL111:
 417:FML/Src/EC2x.c ****                     step = 0;
 1380              		.loc 1 417 21 view .LVU357
 1381              		.loc 1 417 26 is_stmt 0 view .LVU358
 1382 0248 164B     		ldr	r3, .L99+4
 1383 024a 0022     		movs	r2, #0
 1384 024c 1A70     		strb	r2, [r3]
 1385 024e F5E6     		b	.L75
 1386              	.L76:
 418:FML/Src/EC2x.c ****                 }
 419:FML/Src/EC2x.c ****             }
 420:FML/Src/EC2x.c ****             break;  
 421:FML/Src/EC2x.c ****             case 8:
 422:FML/Src/EC2x.c ****             {
 423:FML/Src/EC2x.c ****                 if(ec2x_cmd_send(fd,connectmsg_queue[step].txmsg,strlen(connectmsg_queue[step].txms
 1387              		.loc 1 423 17 is_stmt 1 view .LVU359
 1388              		.loc 1 423 20 is_stmt 0 view .LVU360
 1389 0250 134F     		ldr	r7, .L99
 1390 0252 6600     		lsls	r6, r4, #1
 1391 0254 04EB4403 		add	r3, r4, r4, lsl #1
 1392 0258 57F82380 		ldr	r8, [r7, r3, lsl #2]
 1393              		.loc 1 423 66 view .LVU361
 1394 025c 4046     		mov	r0, r8
 1395 025e FFF7FEFF 		bl	strlen
 1396              	.LVL112:
 1397              		.loc 1 423 20 view .LVU362
 1398 0262 3444     		add	r4, r4, r6
 1399 0264 07EB8404 		add	r4, r7, r4, lsl #2
 1400 0268 3B89     		ldrh	r3, [r7, #8]
 1401 026a 0093     		str	r3, [sp]
 1402 026c 6368     		ldr	r3, [r4, #4]
 1403 026e 82B2     		uxth	r2, r0
 1404 0270 4146     		mov	r1, r8
 1405 0272 2846     		mov	r0, r5
 1406 0274 FFF7FEFF 		bl	ec2x_cmd_send
 1407              	.LVL113:
 1408              		.loc 1 423 19 view .LVU363
 1409 0278 40B1     		cbz	r0, .L95
 424:FML/Src/EC2x.c ****                     step++;
 1410              		.loc 1 424 21 is_stmt 1 view .LVU364
 1411              		.loc 1 424 25 is_stmt 0 view .LVU365
 1412 027a 0A4A     		ldr	r2, .L99+4
 1413 027c 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1414 027e 0133     		adds	r3, r3, #1
 1415 0280 1370     		strb	r3, [r2]
 425:FML/Src/EC2x.c ****                     shellPrint(&shell,"tcp_connect success\r\n");
 1416              		.loc 1 425 21 is_stmt 1 view .LVU366
 1417 0282 0949     		ldr	r1, .L99+8
 1418 0284 0948     		ldr	r0, .L99+12
 1419 0286 FFF7FEFF 		bl	shellPrint
 1420              	.LVL114:
 1421 028a D7E6     		b	.L75
 1422              	.L95:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 35


 426:FML/Src/EC2x.c ****                 }
 427:FML/Src/EC2x.c ****                 else
 428:FML/Src/EC2x.c ****                 {
 429:FML/Src/EC2x.c ****                     ec2x_reset(fd); 
 1423              		.loc 1 429 21 view .LVU367
 1424 028c 2846     		mov	r0, r5
 1425 028e FFF7FEFF 		bl	ec2x_reset
 1426              	.LVL115:
 430:FML/Src/EC2x.c ****                     step = 0;
 1427              		.loc 1 430 21 view .LVU368
 1428              		.loc 1 430 26 is_stmt 0 view .LVU369
 1429 0292 044B     		ldr	r3, .L99+4
 1430 0294 0022     		movs	r2, #0
 1431 0296 1A70     		strb	r2, [r3]
 1432 0298 D0E6     		b	.L75
 1433              	.L98:
 431:FML/Src/EC2x.c ****                 }
 432:FML/Src/EC2x.c ****             }
 433:FML/Src/EC2x.c ****             break; 
 434:FML/Src/EC2x.c ****             default:
 435:FML/Src/EC2x.c ****                 break;
 436:FML/Src/EC2x.c ****         }
 437:FML/Src/EC2x.c ****     }
 438:FML/Src/EC2x.c **** }
 1434              		.loc 1 438 1 view .LVU370
 1435 029a 02B0     		add	sp, sp, #8
 1436              	.LCFI18:
 1437              		.cfi_def_cfa_offset 24
 1438              		@ sp needed
 1439 029c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1440              	.LVL116:
 1441              	.L100:
 1442              		.loc 1 438 1 view .LVU371
 1443              		.align	2
 1444              	.L99:
 1445 02a0 00000000 		.word	.LANCHOR1
 1446 02a4 00000000 		.word	.LANCHOR2
 1447 02a8 00000000 		.word	.LC2
 1448 02ac 00000000 		.word	shell
 1449              		.cfi_endproc
 1450              	.LFE299:
 1452              		.section	.rodata.EC2x_Test.str1.4,"aMS",%progbits,1
 1453              		.align	2
 1454              	.LC3:
 1455 0000 7463705F 		.ascii	"tcp_connect\000"
 1455      636F6E6E 
 1455      65637400 
 1456              		.align	2
 1457              	.LC4:
 1458 000c 73756363 		.ascii	"success\015\012\000"
 1458      6573730D 
 1458      0A00
 1459 0016 0000     		.align	2
 1460              	.LC5:
 1461 0018 6661696C 		.ascii	"failed\015\012\000"
 1461      65640D0A 
 1461      00
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 36


 1462              		.section	.text.EC2x_Test,"ax",%progbits
 1463              		.align	1
 1464              		.global	EC2x_Test
 1465              		.syntax unified
 1466              		.thumb
 1467              		.thumb_func
 1469              	EC2x_Test:
 1470              	.LVL117:
 1471              	.LFB300:
 439:FML/Src/EC2x.c **** /*------------------------------------test------------------------------------*/
 440:FML/Src/EC2x.c **** 
 441:FML/Src/EC2x.c **** /**
 442:FML/Src/EC2x.c ****  * @brief 
 443:FML/Src/EC2x.c ****  * 
 444:FML/Src/EC2x.c ****  * @param fd 
 445:FML/Src/EC2x.c ****  * @param tx_buff 
 446:FML/Src/EC2x.c ****  * @param expect_reply 
 447:FML/Src/EC2x.c ****  * @param timeout 
 448:FML/Src/EC2x.c ****  */
 449:FML/Src/EC2x.c **** void EC2x_Test(int fd,char *tx_buff,char *expect_reply,uint16_t timeout)
 450:FML/Src/EC2x.c **** {
 1472              		.loc 1 450 1 is_stmt 1 view -0
 1473              		.cfi_startproc
 1474              		@ args = 0, pretend = 0, frame = 40
 1475              		@ frame_needed = 0, uses_anonymous_args = 0
 1476              		.loc 1 450 1 is_stmt 0 view .LVU373
 1477 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 1478              	.LCFI19:
 1479              		.cfi_def_cfa_offset 32
 1480              		.cfi_offset 4, -32
 1481              		.cfi_offset 5, -28
 1482              		.cfi_offset 6, -24
 1483              		.cfi_offset 7, -20
 1484              		.cfi_offset 8, -16
 1485              		.cfi_offset 9, -12
 1486              		.cfi_offset 10, -8
 1487              		.cfi_offset 14, -4
 1488 0004 8CB0     		sub	sp, sp, #48
 1489              	.LCFI20:
 1490              		.cfi_def_cfa_offset 80
 1491 0006 0746     		mov	r7, r0
 1492 0008 0D46     		mov	r5, r1
 1493 000a 1646     		mov	r6, r2
 1494 000c 9946     		mov	r9, r3
 451:FML/Src/EC2x.c ****     uint8_t tx_data[20] = {0xff,};
 1495              		.loc 1 451 5 is_stmt 1 view .LVU374
 1496              		.loc 1 451 13 is_stmt 0 view .LVU375
 1497 000e FF23     		movs	r3, #255
 1498              	.LVL118:
 1499              		.loc 1 451 13 view .LVU376
 1500 0010 0793     		str	r3, [sp, #28]
 1501 0012 0024     		movs	r4, #0
 1502 0014 0894     		str	r4, [sp, #32]
 1503 0016 0994     		str	r4, [sp, #36]
 1504 0018 0A94     		str	r4, [sp, #40]
 1505 001a 0B94     		str	r4, [sp, #44]
 452:FML/Src/EC2x.c ****     uint8_t reply_data[20] = {0xff,};
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 37


 1506              		.loc 1 452 5 is_stmt 1 view .LVU377
 1507              		.loc 1 452 13 is_stmt 0 view .LVU378
 1508 001c 0293     		str	r3, [sp, #8]
 1509 001e 0394     		str	r4, [sp, #12]
 1510 0020 0494     		str	r4, [sp, #16]
 1511 0022 0594     		str	r4, [sp, #20]
 1512 0024 0694     		str	r4, [sp, #24]
 453:FML/Src/EC2x.c ****     uint8_t tx_len = 0,reply_len = 0;
 1513              		.loc 1 453 5 is_stmt 1 view .LVU379
 1514              	.LVL119:
 454:FML/Src/EC2x.c ****     tx_len = strlen(tx_buff);
 1515              		.loc 1 454 5 view .LVU380
 1516              		.loc 1 454 14 is_stmt 0 view .LVU381
 1517 0026 0846     		mov	r0, r1
 1518              	.LVL120:
 1519              		.loc 1 454 14 view .LVU382
 1520 0028 FFF7FEFF 		bl	strlen
 1521              	.LVL121:
 1522              		.loc 1 454 14 view .LVU383
 1523 002c 0446     		mov	r4, r0
 1524              		.loc 1 454 12 view .LVU384
 1525 002e 5FFA80F8 		uxtb	r8, r0
 1526              	.LVL122:
 455:FML/Src/EC2x.c ****     reply_len = strlen(expect_reply);
 1527              		.loc 1 455 5 is_stmt 1 view .LVU385
 1528              		.loc 1 455 17 is_stmt 0 view .LVU386
 1529 0032 3046     		mov	r0, r6
 1530 0034 FFF7FEFF 		bl	strlen
 1531              	.LVL123:
 1532 0038 8246     		mov	r10, r0
 1533              	.LVL124:
 456:FML/Src/EC2x.c ****     if(strcmp(tx_buff,"tcp_connect")==0){
 1534              		.loc 1 456 5 is_stmt 1 view .LVU387
 1535              		.loc 1 456 8 is_stmt 0 view .LVU388
 1536 003a 1D49     		ldr	r1, .L106
 1537 003c 2846     		mov	r0, r5
 1538 003e FFF7FEFF 		bl	strcmp
 1539              	.LVL125:
 1540              		.loc 1 456 7 view .LVU389
 1541 0042 28B9     		cbnz	r0, .L102
 457:FML/Src/EC2x.c ****         ec2x_tcp_connect(fd);
 1542              		.loc 1 457 9 is_stmt 1 view .LVU390
 1543 0044 3846     		mov	r0, r7
 1544 0046 FFF7FEFF 		bl	ec2x_tcp_connect
 1545              	.LVL126:
 1546              	.L101:
 458:FML/Src/EC2x.c ****     }
 459:FML/Src/EC2x.c ****     else{
 460:FML/Src/EC2x.c ****         memcpy(tx_data,tx_buff,tx_len);
 461:FML/Src/EC2x.c ****         tx_data[tx_len] = 0x0D;
 462:FML/Src/EC2x.c ****         tx_data[tx_len+1] = 0x0A;
 463:FML/Src/EC2x.c ****         tx_len += 2;
 464:FML/Src/EC2x.c ****         memcpy(reply_data,expect_reply,reply_len);
 465:FML/Src/EC2x.c **** 
 466:FML/Src/EC2x.c ****         if(ec2x_cmd_send(fd,tx_data,tx_len,reply_data,timeout))
 467:FML/Src/EC2x.c ****             shellPrint(&shell,"success\r\n");
 468:FML/Src/EC2x.c ****         else
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 38


 469:FML/Src/EC2x.c ****             shellPrint(&shell,"failed\r\n");
 470:FML/Src/EC2x.c ****     }
 471:FML/Src/EC2x.c **** }
 1547              		.loc 1 471 1 is_stmt 0 view .LVU391
 1548 004a 0CB0     		add	sp, sp, #48
 1549              	.LCFI21:
 1550              		.cfi_remember_state
 1551              		.cfi_def_cfa_offset 32
 1552              		@ sp needed
 1553 004c BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1554              	.LVL127:
 1555              	.L102:
 1556              	.LCFI22:
 1557              		.cfi_restore_state
 460:FML/Src/EC2x.c ****         tx_data[tx_len] = 0x0D;
 1558              		.loc 1 460 9 is_stmt 1 view .LVU392
 1559 0050 E4B2     		uxtb	r4, r4
 1560 0052 2246     		mov	r2, r4
 1561 0054 2946     		mov	r1, r5
 1562 0056 07A8     		add	r0, sp, #28
 1563 0058 FFF7FEFF 		bl	memcpy
 1564              	.LVL128:
 461:FML/Src/EC2x.c ****         tx_data[tx_len+1] = 0x0A;
 1565              		.loc 1 461 9 view .LVU393
 461:FML/Src/EC2x.c ****         tx_data[tx_len+1] = 0x0A;
 1566              		.loc 1 461 25 is_stmt 0 view .LVU394
 1567 005c 04F13003 		add	r3, r4, #48
 1568 0060 6B44     		add	r3, sp, r3
 1569 0062 0D22     		movs	r2, #13
 1570 0064 03F8142C 		strb	r2, [r3, #-20]
 462:FML/Src/EC2x.c ****         tx_len += 2;
 1571              		.loc 1 462 9 is_stmt 1 view .LVU395
 462:FML/Src/EC2x.c ****         tx_len += 2;
 1572              		.loc 1 462 27 is_stmt 0 view .LVU396
 1573 0068 04F13103 		add	r3, r4, #49
 1574 006c 0DEB0304 		add	r4, sp, r3
 1575 0070 0A23     		movs	r3, #10
 1576 0072 04F8143C 		strb	r3, [r4, #-20]
 463:FML/Src/EC2x.c ****         memcpy(reply_data,expect_reply,reply_len);
 1577              		.loc 1 463 9 is_stmt 1 view .LVU397
 463:FML/Src/EC2x.c ****         memcpy(reply_data,expect_reply,reply_len);
 1578              		.loc 1 463 16 is_stmt 0 view .LVU398
 1579 0076 08F10208 		add	r8, r8, #2
 1580              	.LVL129:
 463:FML/Src/EC2x.c ****         memcpy(reply_data,expect_reply,reply_len);
 1581              		.loc 1 463 16 view .LVU399
 1582 007a 5FFA88F8 		uxtb	r8, r8
 1583              	.LVL130:
 464:FML/Src/EC2x.c **** 
 1584              		.loc 1 464 9 is_stmt 1 view .LVU400
 1585 007e 5FFA8AF2 		uxtb	r2, r10
 1586 0082 3146     		mov	r1, r6
 1587 0084 02A8     		add	r0, sp, #8
 1588 0086 FFF7FEFF 		bl	memcpy
 1589              	.LVL131:
 466:FML/Src/EC2x.c ****             shellPrint(&shell,"success\r\n");
 1590              		.loc 1 466 9 view .LVU401
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 39


 466:FML/Src/EC2x.c ****             shellPrint(&shell,"success\r\n");
 1591              		.loc 1 466 12 is_stmt 0 view .LVU402
 1592 008a CDF80090 		str	r9, [sp]
 1593 008e 02AB     		add	r3, sp, #8
 1594 0090 4246     		mov	r2, r8
 1595 0092 07A9     		add	r1, sp, #28
 1596 0094 3846     		mov	r0, r7
 1597 0096 FFF7FEFF 		bl	ec2x_cmd_send
 1598              	.LVL132:
 466:FML/Src/EC2x.c ****             shellPrint(&shell,"success\r\n");
 1599              		.loc 1 466 11 view .LVU403
 1600 009a 20B1     		cbz	r0, .L104
 467:FML/Src/EC2x.c ****         else
 1601              		.loc 1 467 13 is_stmt 1 view .LVU404
 1602 009c 0549     		ldr	r1, .L106+4
 1603 009e 0648     		ldr	r0, .L106+8
 1604 00a0 FFF7FEFF 		bl	shellPrint
 1605              	.LVL133:
 1606 00a4 D1E7     		b	.L101
 1607              	.L104:
 469:FML/Src/EC2x.c ****     }
 1608              		.loc 1 469 13 view .LVU405
 1609 00a6 0549     		ldr	r1, .L106+12
 1610 00a8 0348     		ldr	r0, .L106+8
 1611 00aa FFF7FEFF 		bl	shellPrint
 1612              	.LVL134:
 1613              		.loc 1 471 1 is_stmt 0 view .LVU406
 1614 00ae CCE7     		b	.L101
 1615              	.L107:
 1616              		.align	2
 1617              	.L106:
 1618 00b0 00000000 		.word	.LC3
 1619 00b4 0C000000 		.word	.LC4
 1620 00b8 00000000 		.word	shell
 1621 00bc 18000000 		.word	.LC5
 1622              		.cfi_endproc
 1623              	.LFE300:
 1625              		.global	shellCommandec2x_send
 1626              		.global	shellDescec2x_send
 1627              		.global	shellCmdec2x_send
 1628              		.global	ec2x_dev
 1629              		.global	connectmsg_queue
 1630              		.section	.rodata.str1.4,"aMS",%progbits,1
 1631              		.align	2
 1632              	.LC6:
 1633 0000 41540D0A 		.ascii	"AT\015\012\000"
 1633      00
 1634 0005 000000   		.align	2
 1635              	.LC7:
 1636 0008 4F4B00   		.ascii	"OK\000"
 1637 000b 00       		.align	2
 1638              	.LC8:
 1639 000c 41542B43 		.ascii	"AT+CPIN?\015\012\000"
 1639      50494E3F 
 1639      0D0A00
 1640 0017 00       		.align	2
 1641              	.LC9:
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 40


 1642 0018 52454144 		.ascii	"READY\000"
 1642      5900
 1643 001e 0000     		.align	2
 1644              	.LC10:
 1645 0020 41542B43 		.ascii	"AT+CREG?\015\012\000"
 1645      5245473F 
 1645      0D0A00
 1646 002b 00       		.align	2
 1647              	.LC11:
 1648 002c 2B435245 		.ascii	"+CREG: 0,1\000"
 1648      473A2030 
 1648      2C3100
 1649 0037 00       		.align	2
 1650              	.LC12:
 1651 0038 41542B43 		.ascii	"AT+CGREG?\015\012\000"
 1651      47524547 
 1651      3F0D0A00 
 1652              		.align	2
 1653              	.LC13:
 1654 0044 2B434752 		.ascii	"+CGREG: 0,1\000"
 1654      45473A20 
 1654      302C3100 
 1655              		.align	2
 1656              	.LC14:
 1657 0050 41542B51 		.ascii	"AT+QICSGP=1,1,\"CMNET\",\"\",\"\",1\015\012\000"
 1657      49435347 
 1657      503D312C 
 1657      312C2243 
 1657      4D4E4554 
 1658              		.align	2
 1659              	.LC15:
 1660 0070 41542B51 		.ascii	"AT+QIDEACT=1\015\012\000"
 1660      49444541 
 1660      43543D31 
 1660      0D0A00
 1661 007f 00       		.align	2
 1662              	.LC16:
 1663 0080 41542B51 		.ascii	"AT+QIACT=1\015\012\000"
 1663      49414354 
 1663      3D310D0A 
 1663      00
 1664 008d 000000   		.align	2
 1665              	.LC17:
 1666 0090 2B51494F 		.ascii	"+QIOPEN:\000"
 1666      50454E3A 
 1666      00
 1667              		.global	tcpconnct_step
 1668              		.global	tcp_connect
 1669              		.global	ec2x_buff
 1670              		.section	.bss.step.0,"aw",%nobits
 1671              		.set	.LANCHOR2,. + 0
 1674              	step.0:
 1675 0000 00       		.space	1
 1676              		.section	.bss.tcpconnct_step,"aw",%nobits
 1679              	tcpconnct_step:
 1680 0000 00       		.space	1
 1681              		.section	.data.connectmsg_queue,"aw"
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 41


 1682              		.align	2
 1683              		.set	.LANCHOR1,. + 0
 1686              	connectmsg_queue:
 1687 0000 00000000 		.word	.LC6
 1688 0004 08000000 		.word	.LC7
 1689 0008 F401     		.short	500
 1690 000a 05       		.byte	5
 1691 000b 00       		.space	1
 1692 000c 0C000000 		.word	.LC8
 1693 0010 18000000 		.word	.LC9
 1694 0014 F401     		.short	500
 1695 0016 05       		.byte	5
 1696 0017 00       		.space	1
 1697 0018 20000000 		.word	.LC10
 1698 001c 2C000000 		.word	.LC11
 1699 0020 F401     		.short	500
 1700 0022 02       		.byte	2
 1701 0023 00       		.space	1
 1702 0024 38000000 		.word	.LC12
 1703 0028 44000000 		.word	.LC13
 1704 002c F401     		.short	500
 1705 002e 02       		.byte	2
 1706 002f 00       		.space	1
 1707 0030 50000000 		.word	.LC14
 1708 0034 08000000 		.word	.LC7
 1709 0038 F401     		.short	500
 1710 003a 03       		.byte	3
 1711 003b 00       		.space	1
 1712 003c 70000000 		.word	.LC15
 1713 0040 08000000 		.word	.LC7
 1714 0044 2800     		.short	40
 1715 0046 01       		.byte	1
 1716 0047 00       		.space	1
 1717 0048 80000000 		.word	.LC16
 1718 004c 08000000 		.word	.LC7
 1719 0050 9600     		.short	150
 1720 0052 01       		.byte	1
 1721 0053 00       		.space	1
 1722 0054 00000000 		.word	tcp_connect
 1723 0058 90000000 		.word	.LC17
 1724 005c 9600     		.short	150
 1725 005e 05       		.byte	5
 1726 005f 00       		.space	1
 1727              		.section	.data.ec2x_buff,"aw"
 1728              		.align	2
 1731              	ec2x_buff:
 1732 0000 FF00     		.ascii	"\377\000"
 1733 0002 00000000 		.space	198
 1733      00000000 
 1733      00000000 
 1733      00000000 
 1733      00000000 
 1734              		.section	.data.ec2x_dev,"aw"
 1735              		.align	2
 1736              		.set	.LANCHOR0,. + 0
 1739              	ec2x_dev:
 1740 0000 75617274 		.ascii	"uart1/ec200s\000"
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 42


 1740      312F6563 
 1740      32303073 
 1740      00
 1741 000d 0000     		.space	2
 1742 000f 00       		.space	1
 1743 0010 00000000 		.word	huart1
 1744 0014 00000048 		.word	1207959552
 1745 0018 0010     		.short	4096
 1746 001a 0000     		.space	2
 1747 001c 00000048 		.word	1207959552
 1748 0020 0001     		.short	256
 1749 0022 0000     		.space	2
 1750 0024 00000048 		.word	1207959552
 1751 0028 0008     		.short	2048
 1752 002a 0000     		.space	2
 1753 002c 00       		.byte	0
 1754 002d 000000   		.space	3
 1755 0030 00000000 		.word	ec2x_buff
 1756 0034 0000     		.short	0
 1757 0036 0000     		.short	0
 1758 0038 0000     		.short	0
 1759 003a C800     		.short	200
 1760              		.section	.data.tcp_connect,"aw"
 1761              		.align	2
 1764              	tcp_connect:
 1765 0000 41542B51 		.ascii	"AT+QIOPEN=1,0,\"TCP\",\"115.236.153.170\",52894,0,2"
 1765      494F5045 
 1765      4E3D312C 
 1765      302C2254 
 1765      4350222C 
 1766 002f 00       		.ascii	"\000"
 1767              		.section	.rodata.shellCmdec2x_send,"a"
 1768              		.align	2
 1771              	shellCmdec2x_send:
 1772 0000 65633278 		.ascii	"ec2x_send\000"
 1772      5F73656E 
 1772      6400
 1773              		.section	.rodata.shellDescec2x_send,"a"
 1774              		.align	2
 1777              	shellDescec2x_send:
 1778 0000 65633278 		.ascii	"ec2x test\000"
 1778      20746573 
 1778      7400
 1779              		.section	shellCommand,"a"
 1782              	shellCommandec2x_send:
 1783 0000 00210000 		.4byte	8448
 1784 0004 00000000 		.4byte	shellCmdec2x_send
 1785 0008 00000000 		.4byte	EC2x_Test
 1786 000c 00000000 		.4byte	shellDescec2x_send
 1787              		.text
 1788              	.Letext0:
 1789              		.file 2 "e:\\gcc-arm-none-eabi-10.3-2021.10-win32\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\
 1790              		.file 3 "e:\\gcc-arm-none-eabi-10.3-2021.10-win32\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\
 1791              		.file 4 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/stm32l431xx.h"
 1792              		.file 5 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/stm32l4xx.h"
 1793              		.file 6 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_def.h"
 1794              		.file 7 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_gpio.h"
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 43


 1795              		.file 8 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_dma.h"
 1796              		.file 9 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_uart.h"
 1797              		.file 10 "FML/Inc/EC2x.h"
 1798              		.file 11 "ThirdParty/Letter-shell/Inc/shell.h"
 1799              		.file 12 "HAL/Inc/usart.h"
 1800              		.file 13 "ThirdParty/Letter-shell/Inc/shell_port.h"
 1801              		.file 14 "e:\\gcc-arm-none-eabi-10.3-2021.10-win32\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\
 1802              		.file 15 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal.h"
 1803              		.file 16 "<built-in>"
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 44


DEFINED SYMBOLS
                            *ABS*:00000000 EC2x.c
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:20     .text.ec2x_io_init:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:26     .text.ec2x_io_init:00000000 ec2x_io_init
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:165    .text.ec2x_io_init:00000090 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:170    .text.ec2x_open:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:176    .text.ec2x_open:00000000 ec2x_open
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:244    .text.ec2x_open:0000003c $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:249    .text.ec2x_write:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:255    .text.ec2x_write:00000000 ec2x_write
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:317    .text.ec2x_write:0000003c $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:322    .text.ec2x_read:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:328    .text.ec2x_read:00000000 ec2x_read
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:492    .text.ec2x_read:000000a8 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:498    .rodata.ec2x_handler.str1.4:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:502    .text.ec2x_handler:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:508    .text.ec2x_handler:00000000 ec2x_handler
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:693    .text.ec2x_handler:000000e0 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:701    .text.ec2x_replymatch:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:707    .text.ec2x_replymatch:00000000 ec2x_replymatch
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:782    .text.ec2x_cmd_send:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:787    .text.ec2x_cmd_send:00000000 ec2x_cmd_send
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:910    .text.ec2x_cmd_send:00000074 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:916    .rodata.ec2x_reset.str1.4:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:920    .text.ec2x_reset:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:925    .text.ec2x_reset:00000000 ec2x_reset
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:984    .text.ec2x_reset:00000038 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:990    .rodata.ec2x_tcp_connect.str1.4:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:994    .text.ec2x_tcp_connect:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1000   .text.ec2x_tcp_connect:00000000 ec2x_tcp_connect
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1071   .text.ec2x_tcp_connect:00000050 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1080   .text.ec2x_tcp_connect:00000074 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1445   .text.ec2x_tcp_connect:000002a0 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1453   .rodata.EC2x_Test.str1.4:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1463   .text.EC2x_Test:00000000 $t
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1469   .text.EC2x_Test:00000000 EC2x_Test
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1618   .text.EC2x_Test:000000b0 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1782   shellCommand:00000000 shellCommandec2x_send
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1777   .rodata.shellDescec2x_send:00000000 shellDescec2x_send
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1771   .rodata.shellCmdec2x_send:00000000 shellCmdec2x_send
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1739   .data.ec2x_dev:00000000 ec2x_dev
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1686   .data.connectmsg_queue:00000000 connectmsg_queue
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1631   .rodata.str1.4:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1679   .bss.tcpconnct_step:00000000 tcpconnct_step
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1764   .data.tcp_connect:00000000 tcp_connect
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1731   .data.ec2x_buff:00000000 ec2x_buff
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1674   .bss.step.0:00000000 step.0
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1675   .bss.step.0:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1680   .bss.tcpconnct_step:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1682   .data.connectmsg_queue:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1728   .data.ec2x_buff:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1735   .data.ec2x_dev:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1761   .data.tcp_connect:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1768   .rodata.shellCmdec2x_send:00000000 $d
C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s:1774   .rodata.shellDescec2x_send:00000000 $d

UNDEFINED SYMBOLS
ARM GAS  C:\Users\CL\AppData\Local\Temp\ccQ0kiNh.s 			page 45


HAL_GPIO_Init
HAL_GPIO_WritePin
Delay_ms
strcmp
HAL_UART_Transmit_IT
shellPrint
shell
memset
strstr
strlen
memcpy
huart1
